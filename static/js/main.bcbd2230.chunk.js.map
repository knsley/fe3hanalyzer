{"version":3,"sources":["data/CharacterName.ts","model/Util.ts","sim/StatArray.ts","data/CharacterClass.ts","data/class_bonus_stats.csv","data/class_min_stats.csv","data/class_growth_rates.csv","data/class_requirements.csv","data/FetchProvider.ts","data/ClassData.ts","data/CharacterTraits.ts","data/CharacterGrowths.ts","data/CharacterMaxStats.ts","data/CharacterPresets.ts","data/character_traits.csv","data/character_growth_rates.csv","data/character_max_stats.csv","data/character_presets.csv","data/CharacterData.ts","storage/NestedStorageProvider.ts","ui/ChartColorScheme.tsx","model/Defaults.ts","model/PageManager.ts","model/AppContext.ts","model/AnalysisResultCache.ts","lib/EncodingHelper.ts","model/CharacterProfile.ts","sim/AdjustedGrowthRate.ts","sim/ProbabilityArray.ts","sim/StatGrowthTotalCalculator.ts","sim/GrowthResultAccumulator.ts","ui/ClassSelector.tsx","ui/LevelSelector.tsx","ui/ClassAndLevelSelector.tsx","ui/ClassChangeSingleLevel.tsx","ui/ClassChangeList.tsx","ui/ClassChangeEditor.tsx","ui/CharacterSelector.tsx","data/CharacterPresetLoader.ts","ui/InitialStatPresetDialog.tsx","ui/InitialStatsEditor.tsx","ui/MaxStatLimitModEditor.tsx","images/bylethmale_1.png","images/bylethmale_2.png","images/bylethfemale_1.png","images/bylethfemale_2.png","images/edelgard_1.png","images/edelgard_2.png","images/hubert_1.png","images/hubert_2.png","images/dorothea_1.png","images/dorothea_2.png","images/ferdinand_1.png","images/ferdinand_2.png","images/bernadetta_1.png","images/bernadetta_2.png","images/caspar_1.png","images/caspar_2.png","images/petra_1.png","images/petra_2.png","images/linhardt_1.png","images/linhardt_2.png","images/dimitri_1.png","images/dimitri_2.png","images/dedue_1.png","images/dedue_2.png","images/felix_1.png","images/felix_2.png","images/mercedes_1.png","images/mercedes_2.png","images/ashe_1.png","images/ashe_2.png","images/annette_1.png","images/annette_2.png","images/sylvain_1.png","images/sylvain_2.png","images/ingrid_1.png","images/ingrid_2.png","images/claude_1.png","images/claude_2.png","images/lorenz_1.png","images/lorenz_2.png","images/hilda_1.png","images/hilda_2.png","images/raphael_1.png","images/raphael_2.png","images/lysithea_1.png","images/lysithea_2.png","images/ignatz_1.png","images/ignatz_2.png","images/marianne_1.png","images/marianne_2.png","images/leonie_1.png","images/leonie_2.png","images/manuela_1.png","images/hanneman_1.png","images/seteth_1.png","images/flayn_1.png","images/cyril_1.png","images/cyril_2.png","images/catherine_1.png","images/alois_1.png","images/gilbert_1.png","images/shamir_1.png","images/yuri_1.png","images/yuri_2.png","images/balthus_1.png","images/balthus_2.png","images/constance_1.png","images/constance_2.png","images/hapi_1.png","images/hapi_2.png","images/jeritza_1.png","images/anna_1.png","data/CharacterThumbnails.ts","ui/CharacterThumbnail.tsx","ui/ExportProfileDialog.tsx","ui/ImportProfileDialog.tsx","ui/CharacterProfileBuilder.tsx","sim/GrowthProfile.ts","ui/RechartProbabilityDisplay.tsx","ui/AnalysisSingleStatDisplay.tsx","ui/AnalysisReportDisplay.tsx","ui/LuckAnalysisReport.tsx","model/AnalysisReportExport.ts","ui/ExportDataDialog.tsx","ui/AnalysisPage.tsx","../../docs/about.md","../../docs/docs.md","../../docs/faq.md","ui/HeaderAndDocumentation.tsx","images/GitHub-Mark-32px.png","App.tsx","index.tsx"],"names":["CharacterName","_ToCharacterDisplayName","c","BylethFemale","BylethMale","CharacterFaction","_enumToDisplay","Map","_displayToEnum","getCharacterDisplayName","r","get","undefined","RangeError","getCharacterFromDisplayName","name","i","End","valueOf","enumValue","stringValue","set","_factionNames","getFactionDisplayName","faction","displayName","Player","BlackEagles","BlueLions","GoldenDeer","ChurchOfSeiros","AshenWolves","Other","listingOrderComparer","a","b","_byFaction","sort","Edelgard","Hubert","Dorothea","Ferdinand","Bernadetta","Caspar","Petra","Linhardt","Dimitri","Dedue","Felix","Mercedes","Ashe","Annette","Sylvain","Ingrid","Claude","Lorenz","Hilda","Raphael","Lysithea","Ignatz","Marianne","Leonie","Manuela","Hanneman","Seteth","Flayn","Cyril","Catherine","Alois","Gilbert","Shamir","Yuri","Balthus","Constance","Hapi","Jeritza","Anna","clamp","value","lowerBound","upperBound","iTOTAL","CanonicalStatNamesByIndex","CanonicalStatIndicesByName","getCanonicalStatNameByIndex","statIndex","Array","from","entries","forEach","entry","forEachStat","stat","callback","outputs","forEachStatIndex","output","push","statTotal","stats","reduce","p","initStats","n","zeroStats","_StatIndexes","_statApply","s1","s2","op","vectorOut","map","addStats","addProbabilities","areEqualStats","every","statToString","s","segments","join","CharacterClass","CharacterClassGroup","ClassNameToEnum","ClassEnumToName","getClassDisplayName","result","getClassFromDisplayName","getCharacterClassGroupDisplayName","HouseLeader","iterEnd","friendlyName","replace","_byCategory","Unique","Commoner","Noble","Dancer","Beginner","Myrmidon","Soldier","Fighter","Monk","Intermediate","Lord","Mercenary","Thief","ArmoredKnight","Cavalier","Brigand","Archer","Brawler","Mage","DarkMage","Priest","PegasusKnight","Advanced","Hero","Swordmaster","Assassin","FortressKnight","Paladin","WyvernRider","Warrior","Sniper","Grappler","Warlock","DarkBishop","Bishop","Special","Trickster","WarMonk","WarCleric","DarkFlier","Valkyrie","Master","FalconKnight","WyvernLord","MortalSavant","GreatKnight","BowKnight","DarkKnight","HolyKnight","WarMaster","Gremory","EnlightenedOne","ArmoredLord","HighLord","WyvernMaster","Emperor","GreatLord","Barbarossa","DeathKnight","fetchImpl","fetch","location","text","then","response","failure","Error","getFetchProvider","NobleBackgrounds","Set","CommonerBackgrounds","LordBackgrounds","ProtagonistBackgrounds","CharacterGroups","ClassRequirementsMap","getClassGeneralData","characterClass","data","hasClassGeneralData","has","prob","growths","x","ClassGrowths","getClassGrowthRateMod","getRequirementForCharacterAndClass","character","specificCharacterRequirements","requirements","filter","req","matchOnGender","gender","getCharacterTraits","matchOnSpecificCharacter","characters","length","y","level","getEligibleClasses","eligibleClasses","add","zeroOrNumber","numberAsString","Number","parseInt","StandardParseConfig","delimiter","newline","quoteChar","escapeChar","header","dynamicTyping","worker","comments","skipEmptyLines","loadClassBonusStats","dataFile","fetchFunc","replaceAll","bonusStats","parseResult","Papa","parse","row","className","console","log","statBonuses","loadClassMinStats","minStats","statLine","loadClassGrowthRates","growthRates","parseGenderRequirement","genderInTable","startsWith","parseCharacterRequirement","charactersString","characterGroupLookup","specificCharacterLookup","loadClassRequirements","requirementsMap","ClassBonusStatsFile","bonusStatMap","ClassMinStatsFile","minStatMap","ClassGrowthRatesFile","growthRateMap","ClassRequirementsFile","baseStats","CharacterTraits","loadCharacterTraitsFromDataFile","parseConfig","characterName","isStudent","GrowthRates","loadCharacterGrowthsFromDataFile","CharacterMaxStats","loadCharacterMaxStatsFromDataFile","statMaxes","CharacterPresets","loadCharacterPresetsFromDataFile","title","class","traits","getCharacterMaxBaseStats","mods","maybeMaxStats","maxStats","StrAndSpdUp","LckAndChaUp","MagAndDexUp","DefAndResUp","getCharacterInitialPresets","getBaseStatsFromClassStats","boost","getCharactersWithDefinedData","charactersWithData","CharacterTraitsFile","CharacterGrowthsFile","CharacterMaxStatsFile","CharacterPresetsFile","NestedStorageProvider","key","rootStorageProvider","subKey","rootProvider","obj","this","fromStore","getItem","JSON","item","setItem","stringify","SERIES_COLOR_SCHEMES","baseColor","baseHighlightColor","medianValueColor","medianValueHighlightColor","referenceValueColor","referenceValueHighlightColor","NoValidDefaultClassError","getCharacterDefaultGenericClass","size","starterClasses","baseClasses","classList","aReq","bReq","createDefaultEmptyCharacterProfile","Math","random","initialData","presets","presetsCopy","getDefaultCharacterInitialData","endLevel","max","maxStatMods","startLevel","startClass","startStats","changes","MaxCharacterProfileCountError","message","PageManager","pageListChangeCallback","storageProvider","pages","listeners","listenerCounter","keys","page","profiles","referenceStats","report","delete","pageData","newPageData","onPageUpdate","index","newProfileList","splice","profile","pageListeners","newHandle","getNewPageListenerHandle","handle","handleValue","values","listener","AppContext","modCount","pageManager","analysisResultCache","contextInstance","_currentValue","valueCallback","createPageManager","pageListUpdated","React","createContext","getDefaultContextValue","modCounter","analysisCache","v","updateValueAndNotify","appContextInstance","getAppContext","window","sessionStorage","stringToUTF16","buf","ArrayBuffer","bufView","Uint16Array","len","charCodeAt","toBase64","asByteArray","Uint8Array","str","String","fromCharCode","btoa","getNormalizedGrowthProfileString","normalizedClassChangeString","changeStrings","toString","getNormalizedClassChangeString","getNormalizedStatLimitsString","getCharacterProfileHash","normalizedProfile","normalizedStatLimits","dataString","crypto","subtle","digest","serializeCharacterProfileToJson","isBoundedInteger","minBoundInclusive","maxBoundExclusive","isInteger","isClassChangeEquivalent","areValidClassChanges","classChanges","isCharacterEligibleForClass","deserializeCharacterProfileFromJson","json","parsed","error","check","isArray","field","isMaxStatModEquivalent","fieldDefinition","asCharacterProfileSchema","startingStats","asArray","isValidStartingStats","guaranteedLowStatUpStats","getAdjustedGrowthRates","rawGrowthRate","pZeroOtherwise","oneMinus","computeZeroOtherwiseProbabilities","pZeroOrOneTotal","computeZeroOrOneStatUpProbability","isAlmostZero","abs","ProbabilityArray","minValue","maxValue","offset","width","probability","setProbability","shift","e","sum","scale","clampIndex","clone","clampedProbability","remainder","pStatUp","cap","min","addProbability","pNotChanged","thisProb","indexLower","indexUpper","recursivePermutation","priorProbability","currentSum","statUpProbabilities","cumulative","thisLevelupProbability","computeStatGrowthTotalProbabilities","levelups","probabilities","normalize","clampProbability","computeDistributionMedianForSingleStat","distribution","singleStatDistribution","getDistributionByStatIndex","pTarget","cumulativeProbability","buckets","after","median","pLower","pHigher","pMedian","hp","mag","dex","spd","lck","def","res","cha","levelupTotal","logGrowthRates","rawGrowths","adjustedGrowths","info","precomputeClassGrowthRates","baseLevelups","getCharacterBaseGrowths","cache","startClassGrowthMod","startClassRawGrowth","startClassAdjustedGrowths","normal","adjusted","change","growthMod","applyClassChanges","distributions","newDistributions","classBaseStats","applyLevelup","growthRate","caps","stepProbability","GrowthResultAccumulator","perLevel","cachedLevels","cachedGrowthRates","statMaximums","levelupMap","classChange","computedChanges","precomputeClassChanges","baseStartStats","startStat","startDistribution","classBasedLevelupDistributions","cachedGrowths","calculateLevelupDistributions","firstLevelClassChanges","levelFinalClass","firstLevelupDistribution","recordLevelResults","levelSpread","levelIndex","actualLevel","levelupDistribution","statDistribution","growthDistribution","normalized","export","exportStatDistributions","CharacterNameList","ClassSelector","props","characterEntries","disabled","f","group","entriesInGroup","category","getCharacterClassesByCategory","label","handler","event","child","selected","target","onSelected","FormControl","InputLabel","htmlFor","Select","native","onChange","id","style","minWidth","LevelSelector","minLevel","maxLevel","customText","labelStyle","FormControlLabel","control","marginLeft","labelPlacement","ClassAndLevelSelector","classRequirement","selectedClass","effectiveMinLevel","effectiveMaxLevel","containerStyle","containerProps","newClassRequirement","effectiveNewMinLevel","selectedLevel","onChanged","classSelectorProps","l","levelSelectorProps","getClassChipStyle","isDragging","draggableStyle","marginRight","userSelect","ClassChip","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","Chip","icon","onDelete","color","clickable","cursor","getClassChip","isDisabled","DropContainerStyle","backgroundColor","display","flexDirection","flexShrink","flexGrow","flexWrap","paddingTop","paddingBottom","paddingLeft","paddingRight","minHeight","DragOverStyle","borderTop","borderBottom","dropContainerStyle","isDraggingOver","ClassChangeSingleLevel","onDeleteHandler","newClassList","classes","onDeleted","draggableItems","ind","draggableId","onDragEnd","destination","newList","srcIndex","source","destIndex","elem","onReordered","droppableId","direction","Tooltip","droppableProps","placeholder","CONTAINER_STYLE","flexBasis","justifyContent","alignItems","ROW_STYLE","ROW_ELEMENT_STYLE","padding","textAlign","alignContent","ClassChangeList","elements","levelsInOrder","list","fixedLevel","FormLabel","reorderedHandler","deletedHandler","margin","ClassAddWidgetContainerStyle","marginTop","ClassAndLevelSelectorStyle","alignSelf","AddButtonStyle","ClassAddWidget","onSelectionChanged","Button","variant","onClick","onAddButtonClicked","ClassChangeEditorContainerStyle","ClassChangeEditor","useState","defaultClassChoice","defaultClassRequirement","addWidgetClass","addWidgetLevel","getClassChangeEditorDefaultState","state","setState","immediateStateUpdateNeeded","effectiveClass","effectiveLevel","requiredLevelForEffectiveClass","addWidgetChangeHandler","addWidgetConfirmHandler","appendedMap","classChangeList","onClassChangeListChange","classChangeListReorderedHandler","CharacterSelector","entriesInFaction","getCharactersByFaction","availableCharacters","getPresetDisplayName","bundleInstance","PresetsBundleImpl","presetLookup","presetMap","computePresets","loadInitialStatsPresets","PresetSelector","presetEntries","availablePresets","preset","marginBottom","selectedIndex","PresetDisplayRowStyle","PresetDisplayElementStyle","PresetDisplayLabelStyle","PresetDisplayValueStyle","fontWeight","opacity","PresetDisplay","Typography","statDisplayName","InitialStatPresetDialog","selectedCharacter","defaultCharacter","selectedPresetIndex","prevProps","prevState","AvailablePresets","presetsForSelectedCharacter","getPresetsForCharacter","selectedPreset","getStatBundle","presetSelectionDisplay","newIndexSelection","selectableCharacters","getCharacterList","Dialog","open","onClose","onCancelled","DialogTitle","DialogContent","newCharacterSelection","DialogActions","STAT_NAME_LIST","StatArraySelector","forEachStatV","savedIndex","elementStyle","Input","type","inputProps","minimums","maximums","newStats","inputChanged","reconcile","statMaxMods","reconciled","validClasses","specificRequirement","characterMaxStats","statsMin","OUTER_LAYOUT","FORM_CONTAINER_LAYOUT","INNER_ROW_STYLE","CHARACTER_IDENTITY_LAYOUT","CHARACTER_SELECTOR_STYLE","CLASS_AND_LEVEL_SELECTOR_STYLE","PRESET_BUTTON_STYLE","STAT_ARRAY_SELECTOR_STYLE","STAT_ARRAY_ELEMENT_STYLE","InitialStatsEditor","presetDialogOpen","setPresetDialogOpen","statMinumums","classData","dialog","statBundle","FormGroup","MaxStatLimitModEditor","_stats_changed","strAndSpd","lckAndCha","magAndDex","defAndRes","newStatuses","status","Checkbox","checked","CharacterToThumbnailMap","CharacterThumbnail","path","height","fontSize","toFixed","lineHeight","verticalAlign","objectFit","timeskip","src","postSkip","preSkip","alt","BylethMale_Pre","BylethMale_Post","BylethFemale_Pre","BylethFemale_Post","Edelgard_Pre","Edelgard_Post","Hubert_Pre","Hubert_Post","Dorothea_Pre","Dorothea_Post","Ferdinand_Pre","Ferdinand_Post","Bernadetta_Pre","Bernadetta_Post","Caspar_Pre","Caspar_Post","Petra_Pre","Petra_Post","Linhardt_Pre","Linhardt_Post","Dimitri_Pre","Dimitri_Post","Dedue_Pre","Dedue_Post","Felix_Pre","Felix_Post","Mercedes_Pre","Mercedes_Post","Ashe_Pre","Ashe_Post","Annette_Pre","Annette_Post","Sylvain_Pre","Sylvain_Post","Ingrid_Pre","Ingrid_Post","Claude_Pre","Claude_Post","Lorenz_Pre","Lorenz_Post","Hilda_Pre","Hilda_Post","Raphael_Pre","Raphael_Post","Lysithea_Pre","Lysithea_Post","Ignatz_Pre","Ignatz_Post","Marianne_Pre","Marianne_Post","Leonie_Pre","Leonie_Post","Cyril_Pre","Cyril_Post","Yuri_Pre","Yuri_Post","Balthus_Pre","Balthus_Post","Constance_Pre","Constance_Post","Hapi_Pre","Hapi_Post","ExportProfileDialog","showCopiedMessage","setShowCopiedMessage","profileJson","copyHandler","navigator","clipboard","writeText","closeHandler","TextField","multiline","rowsMax","ImportProfileDialog","importString","setImportString","importHandler","onProfileLoaded","trim","helperText","removeUnusedClassChanges","getGrowthProfileFromCharacterProfile","filteredClassChanges","growthProfile","validateClassProfile","CharacterCardStyle","overflow","ContainerStyle","RemoveProfileButtonStyle","CharacterStatsContainer","CharacterThumbnailLayout","OtherSettingsContainerStyle","OtherSettingsControlRow","ThumbnailColumnStyle","CharacterImportExportButtonsStyle","classChangeListToMap","changesForLevel","getReconciledEndLevel","initialStats","candidate","CharacterProfileBuilder","exportDialogOpen","setExportDialogOpen","importDialogOpen","setImportDialogOpen","maybeRemoveButton","showDeleteButton","disableElevation","onDeleteClicked","useTimeskipThumbnail","Card","CardContent","onProfileChange","newInitialStats","reconciledClassChangeList","getReconciledClassChanges","reconciledEndLevel","newEndLevel","newClassChangeList","flattenedClassChanges","levels","flattenClassChanges","newMods","EmptyDataSeriesError","minReducer","maxReducer","reduceKeys","m","reducer","probabilityValueFormatter","decimalDigits","RechartProbabilityDisplay","containerRef","createRef","dataSeries","some","d","probabilityValues","dataPoints","seriesNames","leftLimit","minBin","rightLimit","maxBin","point","bin","series","maybeBinValue","computeChartData","chartData","seriesKeys","averageLines","avgValue","averageValue","avgXCoord","round","ReferenceLine","stroke","areaGraphs","seriesKey","Area","dataKey","fillOpacity","fill","current","getBoundingClientRect","ResponsiveContainer","AreaChart","top","right","left","bottom","CartesianGrid","strokeDasharray","XAxis","YAxis","domain","tickFormatter","parseFloat","formatter","labelFormatter","prefix","statLabel","number","Legend","Component","OuterLayoutStyle","justifyItems","ChartTitleStyle","textTransform","ChartBodyStyle","AnalysisSingleStatDisplay","averages","averageValues","single","position","caption","maxProbability","toLocaleUpperCase","getReportMaxLevel","components","StatDescriptionsByIndex","getStatDescriptionByIndex","getKeyBounds","floorWithPrecision","digits","pow","floor","ceilWithPrecision","ceil","getSingleStatDisplayProps","seriesLevelToUse","analysisComponent","levelToUse","medianDetails","computeDistributionMedian","AnalysisReportDisplay","nextProps","cacheToken","statDistributions","hpLowerBound","hpUpperBound","totalLowerBound","totalUpperBound","restLowerBound","restUpperBound","highestBinProbabilitiesByStat","getStatBounds","minHpValue","maxHpValue","minRestValue","maxRestValue","highestProbability","maxProbabilty","MuiTooltip","_MuiTooltip","ReferenceStatContainerStyle","ReferenceStatElementStyle","RngRatingExplanation","computePercentileRankForDistribution","splits","mapStatArray","referenceStat","below","same","above","bucket","computeStatSplit","computeLuckMetric","ranks","weights","weightedSum","rank","element","biasForExtremeValues","normalizedSum","tanh","SingleReportContainerStyle","ProfileHeadingContainerStyle","ProfileNameSegmentStyle","LuckQuotientHighlight","SingleProfileReport","areaFill","profileIndex","areaOutline","statName","medianData","serializedDistribution","Object","fromEntries","medianDisplayPercentile","reference","RadarChart","outerRadius","PolarGrid","PolarAngleAxis","PolarRadiusAxis","Radar","toUpperCase","computeMedianStatsFromReport","newReferenceStats","referenceDistributions","referenceSourceLevel","referenceDistribution","LuckAnalysisReport","nextState","reportIterationCounter","reportBlocks","component","useLevel","distributionsByStat","candidateClassChanges","highestCandidateLevel","getFinalClassAtLevelForProfile","positions","singleReportComponent","computePercentileRanks","luckQuotient","luckQuotientText","isNaN","characterTextColor","ordinalNumberCompare","toCsvRow","componentIndex","lvl","exportAnalysisReportToCsv","lines","flatMap","classesByLevel","levelCounter","currentClass","reverse","pop","computeClassNamesByLevel","rows","iStat","dist","line","totalLevelupDistribution","totalLevelupBuckets","allData","Blob","ExportDataDialog","dataBlobUrl","clearDataBlob","URL","createObjectURL","aElem","document","createElement","href","download","click","revokeObjectURL","profileStrings","endClass","downloadDataBlob","reportGenerationCounter","AddProfileButtonContainerStyle","AddProfileButtonStyle","AnalysisPage","listenerHandle","resultsComputed","results","profileBlockExpansion","selectedReportLevel","exportDataDialogOpen","context","attachListener","pageId","detachListener","reconcilePageState","pageDataRef","getPageData","maybeAddProfileButton","onAddProfileClicked","computeReportButtonColor","computeReportButton","onGenerateReportClicked","profileBlock","characterProfile","renderProfile","rnjesusDisplay","Accordion","AccordionSummary","expandIcon","AccordionDetails","Container","reportBlock","float","levelSelector","newSelectedLevel","maxWidth","accum","compute","getDistributions","updateAnalysis","newProfile","deleteProfile","updateProfile","profileChanged","onRemoveProfileClicked","addPageListener","pageNumber","onPageUpdated","removePageListener","forceUpdate","newBlockExpansion","tailLength","concat","slice","profilesMatched","oldProfile","contextType","Context","LinksTrayStyle","MenuIconStyle","GithubPagesRegex","HeaderAndDocumentation","segmentsMatch","hostname","match","urlPrefix","repoUrl","gitUser","FaqUrl","FaqAssetUrl","DocumentationUrl","DocumentationAssetUrl","AboutDocsUrl","AboutDocsAssetUrl","rel","Link","underline","App","loaded","loadCharacterData","loadClassData","appContext","currentValue","hasPage","createNewPage","theme","createMuiTheme","typography","AppContextObject","Provider","ThemeProvider","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.bcbd2230.chunk.js","sourcesContent":["/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport enum CharacterName\n{\n    BylethMale = 0,\n    BylethFemale,\n    \n    // Black Eagles\n    Edelgard,\n    Hubert,\n    Dorothea,\n    Ferdinand,\n    Bernadetta,\n    Caspar,\n    Petra,\n    Linhardt,\n\n    // Blue Lions\n    Dimitri,\n    Dedue,\n    Felix,\n    Mercedes,\n    Ashe,\n    Annette,\n    Sylvain,\n    Ingrid,\n\n    // Golden Deer\n    Claude,\n    Lorenz,\n    Hilda,\n    Raphael,\n    Lysithea,\n    Ignatz,\n    Marianne,\n    Leonie,\n\n    // Church\n    Manuela,\n    Hanneman,\n    Seteth,\n    Flayn,\n    Cyril,\n    Catherine,\n    Alois,\n    Gilbert,\n    Shamir,\n\n    // DLC\n    Yuri,\n    Balthus,\n    Constance,\n    Hapi,\n    Jeritza,\n    Anna,\n    \n    // For indexing\n    End\n}\n\n// Byleth gets special handling because male/female Byleth\n// have access to different classes.\nfunction _ToCharacterDisplayName(c : CharacterName)\n{\n    switch(c)\n    {\n        case CharacterName.BylethFemale:\n            return \"Byleth (Female)\";\n        case CharacterName.BylethMale:\n            return \"Byleth (Male)\";\n        default:\n            return CharacterName[c];\n    }\n}\n\n// Precache the mapping.\nconst _enumToDisplay = new Map<CharacterName, string>();\nconst _displayToEnum = new Map<string, CharacterName>();\n(() => {\n    for (let i = 0; i < CharacterName.End.valueOf(); i++)\n    {\n        const enumValue : CharacterName = i as CharacterName;\n        const stringValue = _ToCharacterDisplayName(enumValue);\n        _enumToDisplay.set(enumValue, stringValue);\n        _displayToEnum.set(stringValue, enumValue);\n    }\n})();\n\nexport function getCharacterDisplayName(c : CharacterName)\n{\n    const r = _enumToDisplay.get(c);\n    \n    if (r !== undefined)\n    {\n        return r;\n    }\n    else\n    {\n        throw new RangeError(\"Not a valid CharacterName enum value\");\n    }\n}\n\nexport function getCharacterFromDisplayName(name : string)\n{\n    const r = _displayToEnum.get(name);\n    \n    if (r !== undefined)\n    {\n        return r;\n    }\n    else\n    {\n        throw new RangeError(\"Not a valid display name for a character.\");\n    }\n}\n\nexport enum CharacterFaction\n{\n    Player = 0,\n    BlackEagles,\n    BlueLions,\n    GoldenDeer,\n    ChurchOfSeiros,\n    AshenWolves,\n    Other,\n    End\n};\n\nconst _factionNames = new Map<CharacterFaction,string>();\n_factionNames.set(CharacterFaction.Player, \"Player\");\n_factionNames.set(CharacterFaction.BlackEagles, \"Black Eagles\");\n_factionNames.set(CharacterFaction.BlueLions, \"Blue Lions\");\n_factionNames.set(CharacterFaction.GoldenDeer, \"Golden Deer\");\n_factionNames.set(CharacterFaction.ChurchOfSeiros, \"Church of Seiros\");\n_factionNames.set(CharacterFaction.AshenWolves, \"Ashen Wolves\");\n_factionNames.set(CharacterFaction.Other, \"Other\");\n\nexport function getCharacterFactions() : Iterable<CharacterFaction>\n{\n    return _factionNames.keys();\n}\n\nexport function getFactionDisplayName(faction : CharacterFaction) : string\n{\n    const displayName = _factionNames.get(faction);\n    if (displayName === undefined)\n    {\n        throw new RangeError(\"faction value is not recognized as valid faction.\");\n    }\n    else\n    {\n        return displayName;\n    }\n}\n\nconst listingOrderComparer = (a : CharacterName, b : CharacterName) => {\n    // Just reuse explicit list order.\n    return a - b;\n};\n\nconst _byFaction = new Map<CharacterFaction,Array<CharacterName>>();\n_byFaction.set(CharacterFaction.Player, [\n    CharacterName.BylethMale,\n    CharacterName.BylethFemale\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.BlackEagles, [\n    CharacterName.Edelgard,\n    CharacterName.Hubert,\n    CharacterName.Dorothea,\n    CharacterName.Ferdinand,\n    CharacterName.Bernadetta,\n    CharacterName.Caspar,\n    CharacterName.Petra,\n    CharacterName.Linhardt\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.BlueLions, [\n    CharacterName.Dimitri,\n    CharacterName.Dedue,\n    CharacterName.Felix,\n    CharacterName.Mercedes,\n    CharacterName.Ashe,\n    CharacterName.Annette,\n    CharacterName.Sylvain,\n    CharacterName.Ingrid,\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.GoldenDeer, [\n    CharacterName.Claude,\n    CharacterName.Lorenz,\n    CharacterName.Hilda,\n    CharacterName.Raphael,\n    CharacterName.Lysithea,\n    CharacterName.Ignatz,\n    CharacterName.Marianne,\n    CharacterName.Leonie,\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.ChurchOfSeiros, [\n    CharacterName.Manuela,\n    CharacterName.Hanneman,\n    CharacterName.Seteth,\n    CharacterName.Flayn,\n    CharacterName.Cyril,\n    CharacterName.Catherine,\n    CharacterName.Alois,\n    CharacterName.Gilbert,\n    CharacterName.Shamir,\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.AshenWolves, [\n    CharacterName.Yuri,\n    CharacterName.Balthus,\n    CharacterName.Constance,\n    CharacterName.Hapi,\n].sort(listingOrderComparer));\n_byFaction.set(CharacterFaction.Other, [\n    CharacterName.Jeritza,\n    CharacterName.Anna\n].sort(listingOrderComparer));\n\nexport function getCharactersByFaction(faction : CharacterFaction) : CharacterName[]\n{\n    const characters = _byFaction.get(faction);\n    if (characters === undefined)\n    {\n        throw new RangeError(`No character mappings for faction ${CharacterFaction[faction]}`)\n    }\n    return characters;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport function clamp(value : number, lowerBound : number, upperBound : number) : number\n{\n    if (value < lowerBound)\n    {\n        return lowerBound;\n    }\n    else if (value > upperBound)\n    {\n        return upperBound;\n    }\n    else\n    {\n        return value;\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { clamp } from \"../model/Util\";\n\n// Indexes for semantically meaningful reference\nexport const iHP =  0;\nexport const iSTR = 1;\nexport const iMAG = 2;\nexport const iDEX = 3;\nexport const iSPD = 4;\nexport const iLCK = 5;\nexport const iDEF = 6;\nexport const iRES = 7;\nexport const iCHA = 8;\n// Use invalid index to avoid indexing past array end.\nexport const iTOTAL = -1;\n\nconst CanonicalStatNamesByIndex : Map<number,string> = new Map<number,string>();\nCanonicalStatNamesByIndex.set(iHP, \"hp\");\nCanonicalStatNamesByIndex.set(iSTR, \"str\");\nCanonicalStatNamesByIndex.set(iMAG, \"mag\");\nCanonicalStatNamesByIndex.set(iDEX, \"dex\");\nCanonicalStatNamesByIndex.set(iSPD, \"spd\");\nCanonicalStatNamesByIndex.set(iLCK, \"lck\");\nCanonicalStatNamesByIndex.set(iDEF, \"def\");\nCanonicalStatNamesByIndex.set(iRES, \"res\");\nCanonicalStatNamesByIndex.set(iCHA, \"cha\");\nCanonicalStatNamesByIndex.set(iTOTAL, \"stat+1\");\n\nconst CanonicalStatIndicesByName : Map<string,number> = new Map<string,number>();\nArray.from(CanonicalStatNamesByIndex.entries()).forEach(entry => CanonicalStatIndicesByName.set(entry[1], entry[0]));\n\nexport function getCanonicalStatNameByIndex(statIndex : number) : string\n{\n    const r = CanonicalStatNamesByIndex.get(statIndex);\n    if (r === undefined)\n    {\n        throw new RangeError(`Unknown StatArray index ${statIndex}`);\n    }\n    else\n    {\n        return r;\n    }\n}\n\nexport function getCanonicalStatIndexByName(statName : string) : number\n{\n    const r = CanonicalStatIndicesByName.get(statName);\n    if (r === undefined)\n    {\n        throw new RangeError(`Unknown canonical stat name ${statName}`);\n    }\n    else\n    {\n        return r;\n    }\n}\n\n// Should all be integers.\nexport type StatArray = [\n    hp: number,\n    str: number,\n    mag: number,\n    dex: number,\n    spd: number,\n    lck: number,\n    def: number,\n    res: number,\n    cha: number,\n];\n\n// Should all be range [0,1] for probabilities of stat up at level up.\nexport type StatUpProbabilities = [\n    hp: number,\n    str: number,\n    mag: number,\n    dex: number,\n    spd: number,\n    lck: number,\n    def: number,\n    res: number,\n    cha: number,\n];\n\nexport const STAT_COUNT = 9;\nexport function forEachStat<T extends StatArray | StatUpProbabilities>(stat : T, callback : (stat : number, index : number) => number) : T\n{\n    let outputs = new Array<number>(9);\n\n    const statCount = STAT_COUNT;\n    for (let i = 0; i < statCount; i++)\n    {\n        outputs[i] = callback(stat[i], i);\n    }\n\n    return outputs as T;\n}\n\nexport function forEachStatV<T extends StatArray | StatUpProbabilities>(stat : T, callback : (stat : number, index : number) => void) : void\n{\n    const statCount = STAT_COUNT;\n    for (let i = 0; i < statCount; i++)\n    {\n        callback(stat[i], i);\n    }\n}\n\nexport function forEachStatIndex<T>(callback : (index : number) => T) : T[]\n{\n    const statCount = STAT_COUNT;\n    const output = new Array<T>(0);\n\n    for (let i = 0; i < statCount; i++)\n    {\n        output.push(callback(i));\n    }\n\n    return output;\n}\n\nexport function forAllStatIndices(callback : (index : number) => boolean) : boolean\n{\n    const statCount = STAT_COUNT;\n\n    for (let i = 0; i < statCount; i++)\n    {\n        if (!callback(i))\n        {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nexport function mapStatArray<T extends StatArray | StatUpProbabilities, U>(stat : T, callback : (stat : number, index : number) => U) : U[]\n{\n    let outputs = new Array<U>(9);\n\n    const statCount = STAT_COUNT;\n    for (let i = 0; i < statCount; i++)\n    {\n        outputs[i] = callback(stat[i], i);\n    }\n\n    return outputs;\n}\n\n// Integers\nexport type StartingStats = StatArray;\n\n// Should be 0 or 1\nexport type LevelUpGrowth = StatArray;\n\n// Integers\nexport type ClassBaseStats = StatArray;\n\n// Integers\nexport type ClassBonusStats = StatArray;\n\n// Helper\nexport function statTotal(stats : StatArray)\n{\n    return stats.reduce((p, c) => p + c);\n}\n\nexport function initStats(n : number) : StatArray\n{\n    return [n,n,n,n,n,n,n,n,n];\n}\n\nexport function zeroStats() : StatArray\n{\n    return initStats(0);\n}\n\ntype _StatApplyOp = (a : number, b : number) => number;\nconst _StatIndexes = [0,1,2,3,4,5,6,7,8]\n\n// \"extends StatArray\" elides the fact that both StatArray and StatUpProbabilities are tuples of 9 numbers.\nfunction _statApply<T extends StatArray>(s1 : T, s2 : T, op : _StatApplyOp) : T\n{\n    const vectorOut = _StatIndexes.map(i => op(s1[i], s2[i]));\n    return [...vectorOut] as T;\n}\n\nexport function addStats(s1 : StatArray, s2 : StatArray)\n{\n    return _statApply(s1, s2, (a, b) => a + b);\n}\n\nexport function addProbabilities(s1 : StatUpProbabilities, s2 : StatUpProbabilities)\n{\n    return _statApply(s1, s2, (a, b) => clamp(a + b, 0.0, 1.0));\n}\n\nexport function subtractStats(s1 : StatArray, s2 : StatArray)\n{\n    return _statApply(s1, s2, (a, b) => a - b);\n}\n\nexport function areEqualStats(s1 : StatArray, s2 : StatArray)\n{\n    return s1.every((n, i) => n === s2[i]);\n}\n\nexport function statsMin(s1 : StatArray, s2 : StatArray)\n{\n    return _statApply(s1, s2, (a, b) => Math.min(a, b));\n}\n\nexport function statsMax(s1 : StatArray, s2 : StatArray)\n{\n    return _statApply(s1, s2, (a, b) => Math.max(a, b));\n}\n\nexport function statToString(s : StatArray)\n{\n    const segments : string[] = forEachStatIndex(i => `${getCanonicalStatNameByIndex(i)}: ${s[i]}`);\n    return `{${segments.join(\", \")}}`;\n}\n\nexport class StatAccumulator\n{\n    public hp: number;\n    public str: number;\n    public mag: number;\n    public dex: number;\n    public spd: number;\n    public lck: number;\n    public def: number;\n    public res: number;\n    public cha: number;\n\n    private statMod: StatArray;\n    private statModTotal : number;\n\n    public constructor(start : StatArray | undefined = undefined)\n    {\n        if (start === undefined)\n        {\n            this.hp = 0;\n            this.str = 0;\n            this.mag = 0;\n            this.dex = 0;\n            this.spd = 0;\n            this.lck = 0;\n            this.def = 0;\n            this.res = 0;\n            this.cha = 0;\n        }\n        else\n        {\n            [this.hp, this.str, this.mag, this.dex, this.spd, this.lck, this.def, this.res, this.cha] = start;\n        }\n\n        this.statMod = zeroStats();\n        this.statModTotal = 0;\n    }\n\n    public set bonusStats(bonusStats : StatArray)\n    {\n        this.statMod = bonusStats;\n        this.statModTotal = statTotal(this.statMod);\n    }\n\n    public get statArray() : StatArray\n    {\n        return addStats(this.statMod, [this.hp, this.str, this.mag, this.dex, this.spd, this.lck, this.def, this.res, this.cha]);\n    }\n\n    public get total() : number\n    {\n        return this.hp + this.str + this.mag + this.dex + this.spd + this.lck + this.def + this.res + this.cha + this.statModTotal;\n    }\n\n    public add(stats : StatArray)\n    {\n        this.hp += stats[iHP];\n        this.str += stats[iSTR];\n        this.mag += stats[iMAG];\n        this.dex += stats[iDEX];\n        this.spd += stats[iSPD];\n        this.lck += stats[iLCK];\n        this.def += stats[iDEF];\n        this.res += stats[iRES];\n        this.cha += stats[iCHA];\n    }\n\n    public rebase(stats : StatArray)\n    {\n        this.hp = Math.max(this.hp, stats[iHP]);\n        this.str = Math.max(this.str, stats[iSTR]);\n        this.mag = Math.max(this.mag, stats[iMAG]);\n        this.dex = Math.max(this.dex, stats[iDEX]);\n        this.spd = Math.max(this.spd, stats[iSPD]);\n        this.lck = Math.max(this.lck, stats[iLCK]);\n        this.def = Math.max(this.def, stats[iDEF]);\n        this.res = Math.max(this.res, stats[iRES]);\n        this.cha = Math.max(this.cha, stats[iCHA]);\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport enum CharacterClass\n{\n    // Unique/start of game classes\n    Commoner = 0,\n    Noble,\n    Dancer,\n\n    // Tactician only\n    EnlightenedOne,\n\n    // House leaders only in pt. 2\n    ArmoredLord,\n    HighLord,\n    WyvernMaster,\n    Emperor,\n    GreatLord,\n    Barbarossa,\n\n    // Beginner classes\n    Myrmidon,\n    Soldier,\n    Fighter,\n    Monk,\n\n    // Intermediate\n    Lord,\n    Mercenary,\n    Thief,\n    ArmoredKnight,\n    Cavalier,\n    Brigand,\n    Archer,\n    Brawler,\n    Mage,\n    DarkMage,\n    Priest,\n    PegasusKnight,\n\n    // Advanced\n    Hero,\n    Swordmaster,\n    Assassin,\n    FortressKnight,\n    Paladin,\n    WyvernRider,\n    Warrior,\n    Sniper,\n    Grappler,\n    Warlock,\n    DarkBishop,\n    Bishop,\n\n    // Master\n    FalconKnight,\n    WyvernLord,\n    MortalSavant,\n    GreatKnight,\n    BowKnight,\n    DarkKnight,\n    HolyKnight,\n    WarMaster,\n    Gremory,\n\n    // Cindered Shadows\n    Trickster,\n    WarMonk,\n    WarCleric,\n    DarkFlier,\n    Valkyrie,\n    DeathKnight,\n\n    // Trailing number for indexing\n    End\n}\n\n// Generate lookups for names and shit.\nconst ClassNameToEnum : Map<string, CharacterClass> = new Map<string, CharacterClass>();\nconst ClassEnumToName : Map<CharacterClass, string> = new Map<CharacterClass, string>();\n(function() {\n    const iterEnd = CharacterClass.End.valueOf();\n    for (let i = 0; i < iterEnd; i++)\n    {\n        let friendlyName = CharacterClass[i].replace(/\\B[A-Z]/g, \" $&\");\n        ClassNameToEnum.set(friendlyName, i);\n        ClassEnumToName.set(i, friendlyName);\n    }\n})();\n\nexport function getClassDisplayName(c : CharacterClass) : string\n{\n    const result = ClassEnumToName.get(c);\n    if (result === undefined)\n    {\n        throw new RangeError(\"Not a valid CharacterClass enum value.\");\n    }\n    else\n    {\n        return result;\n    }\n}\n\nexport function getClassFromDisplayName(c : string) : CharacterClass\n{\n    const result = ClassNameToEnum.get(c);\n    if (result === undefined)\n    {\n        throw new RangeError(\"Not a valid class name, no matching enum found.\");\n    }\n    else\n    {\n        return result;\n    }\n}\n\nexport function getStartingClasses() : Set<CharacterClass>\n{\n    return new Set([CharacterClass.Commoner, CharacterClass.Noble]);\n}\n\nexport enum CharacterClassGroup\n{\n    Unique = 0,\n    Beginner,\n    Intermediate,\n    Advanced,\n    Special,\n    Master,\n    Player,\n    HouseLeader,\n    Other,\n    End\n}\n\nexport function getCharacterClassGroupDisplayName(c : CharacterClassGroup) : string\n{\n    if (c === CharacterClassGroup.HouseLeader)\n    {\n        return \"House Leader\";\n    }\n    else if (c >= 0 || c < CharacterClassGroup.End)\n    {\n        return CharacterClassGroup[c];\n    }\n    else\n    {\n        throw new RangeError(\"Not recognized character class group\");\n    }\n}\n\nconst _byCategory = new Map<CharacterClassGroup,Array<CharacterClass>>();\n_byCategory.set(CharacterClassGroup.Unique, [\n    CharacterClass.Commoner,\n    CharacterClass.Noble,\n    CharacterClass.Dancer,\n]);\n_byCategory.set(CharacterClassGroup.Beginner, [\n    CharacterClass.Myrmidon,\n    CharacterClass.Soldier,\n    CharacterClass.Fighter,\n    CharacterClass.Monk,\n]);\n_byCategory.set(CharacterClassGroup.Intermediate, [\n    CharacterClass.Lord,\n    CharacterClass.Mercenary,\n    CharacterClass.Thief,\n    CharacterClass.ArmoredKnight,\n    CharacterClass.Cavalier,\n    CharacterClass.Brigand,\n    CharacterClass.Archer,\n    CharacterClass.Brawler,\n    CharacterClass.Mage,\n    CharacterClass.DarkMage,\n    CharacterClass.Priest,\n    CharacterClass.PegasusKnight,\n]);\n_byCategory.set(CharacterClassGroup.Advanced, [\n    CharacterClass.Hero,\n    CharacterClass.Swordmaster,\n    CharacterClass.Assassin,\n    CharacterClass.FortressKnight,\n    CharacterClass.Paladin,\n    CharacterClass.WyvernRider,\n    CharacterClass.Warrior,\n    CharacterClass.Sniper,\n    CharacterClass.Grappler,\n    CharacterClass.Warlock,\n    CharacterClass.DarkBishop,\n    CharacterClass.Bishop,\n]);\n_byCategory.set(CharacterClassGroup.Special, [\n    CharacterClass.Trickster,\n    CharacterClass.WarMonk,\n    CharacterClass.WarCleric,\n    CharacterClass.DarkFlier,\n    CharacterClass.Valkyrie,\n]);\n_byCategory.set(CharacterClassGroup.Master, [\n    CharacterClass.FalconKnight,\n    CharacterClass.WyvernLord,\n    CharacterClass.MortalSavant,\n    CharacterClass.GreatKnight,\n    CharacterClass.BowKnight,\n    CharacterClass.DarkKnight,\n    CharacterClass.HolyKnight,\n    CharacterClass.WarMaster,\n    CharacterClass.Gremory,\n]);\n_byCategory.set(CharacterClassGroup.Player, [\n    CharacterClass.EnlightenedOne,\n]);\n_byCategory.set(CharacterClassGroup.HouseLeader, [\n    CharacterClass.ArmoredLord,\n    CharacterClass.HighLord,\n    CharacterClass.WyvernMaster,\n    CharacterClass.Emperor,\n    CharacterClass.GreatLord,\n    CharacterClass.Barbarossa,\n]);\n_byCategory.set(CharacterClassGroup.Other, [\n    CharacterClass.DeathKnight,\n]);\n\nexport function getCharacterClassCategories() : Iterable<CharacterClassGroup>\n{\n    return _byCategory.keys();\n}\n\nexport function getCharacterClassesByCategory(category : CharacterClassGroup) : CharacterClass[]\n{\n    const classList = _byCategory.get(category);\n    if (classList === undefined)\n    {\n        throw new RangeError(`No class list found for category ${CharacterClassGroup[category]}`);\n    }\n    return classList;\n}","export default __webpack_public_path__ + \"static/media/class_bonus_stats.73a62dea.csv\";","export default __webpack_public_path__ + \"static/media/class_min_stats.f059bf17.csv\";","export default __webpack_public_path__ + \"static/media/class_growth_rates.1801c3b7.csv\";","export default __webpack_public_path__ + \"static/media/class_requirements.4f12d221.csv\";","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport interface FetchProvider\n{\n    fetch(location : string) : Promise<string>\n}\n\nexport const WebFetchProvider : FetchProvider = \n{\n    fetch : async (location : string) => {\n        const text = fetch(location).then(\n            response => response.text(),\n            failure => {throw new Error(failure);}\n        )\n\n        return text;\n    }\n}\n\nlet fetchImpl : FetchProvider = WebFetchProvider;\n\nexport function getFetchProvider() : FetchProvider\n{\n    return fetchImpl;\n}\n\nexport function useFetchProvider(f : FetchProvider) : void\n{\n    fetchImpl = f;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterClass, getClassDisplayName, getClassFromDisplayName } from \"./CharacterClass\";\nimport { CharacterName, getCharacterFromDisplayName } from \"./CharacterName\";\nimport { ClassBaseStats, ClassBonusStats, StatArray, StatUpProbabilities } from \"../sim/StatArray\";\nimport { getCharacterTraits } from \"./CharacterData\";\nimport { CharacterGenders } from \"./CharacterTraits\";\nimport Papa from \"papaparse\";\n\nimport ClassBonusStatsFile from './class_bonus_stats.csv';\nimport ClassMinStatsFile from './class_min_stats.csv';\nimport ClassGrowthRatesFile from './class_growth_rates.csv';\nimport ClassRequirementsFile from './class_requirements.csv';\nimport { getFetchProvider } from \"./FetchProvider\";\n\nexport interface ClassRequirements\n{\n    level : number;\n    // Some classes are only available to specific genders, e.g. dark mage, pegasus knight\n    gender : CharacterGenders | null;\n    // Some classes are only available to specific characters.\n    characters : Set<CharacterName> | null;\n}\n\nexport interface ClassData\n{\n    requirements : ClassRequirements[];\n    baseStats : ClassBaseStats;\n    // Not caring about dismounted stats.\n    bonusStats : ClassBonusStats;\n}\n\nconst NobleBackgrounds = new Set<CharacterName>([\n    CharacterName.Edelgard,\n    CharacterName.Hubert,\n    CharacterName.Ferdinand,\n    CharacterName.Bernadetta,\n    CharacterName.Caspar,\n    CharacterName.Linhardt,\n\n    CharacterName.Dimitri,\n    CharacterName.Felix,\n    CharacterName.Annette,\n    CharacterName.Sylvain,\n    CharacterName.Ingrid,\n\n    CharacterName.Claude,\n    CharacterName.Lorenz,\n    CharacterName.Hilda,\n    CharacterName.Lysithea,\n    CharacterName.Marianne,\n\n    CharacterName.Seteth,\n    CharacterName.Flayn,\n    CharacterName.Hanneman,\n    CharacterName.Catherine,\n    CharacterName.Gilbert,\n    CharacterName.Alois,\n\n    CharacterName.Balthus,\n    CharacterName.Constance,\n\n    CharacterName.Jeritza\n]);\n\nconst CommonerBackgrounds = new Set<CharacterName>([\n    CharacterName.BylethMale,\n    CharacterName.BylethFemale,\n\n    CharacterName.Dorothea,\n    CharacterName.Petra,\n\n    CharacterName.Dedue,\n    CharacterName.Mercedes,\n    CharacterName.Ashe,\n\n    CharacterName.Raphael,\n    CharacterName.Ignatz,\n    CharacterName.Leonie,\n\n    CharacterName.Manuela,\n    CharacterName.Shamir,\n    CharacterName.Cyril,\n\n    CharacterName.Yuri,\n    CharacterName.Hapi,\n\n    CharacterName.Anna\n]);\n\nconst LordBackgrounds = new Set<CharacterName>([\n    CharacterName.Claude,\n    CharacterName.Dimitri,\n    CharacterName.Edelgard\n]);\n\nconst ProtagonistBackgrounds = new Set<CharacterName>([\n    CharacterName.BylethMale,\n    CharacterName.BylethFemale\n]);\n\n// Special groups of characters as shorthands in the class data files.\nconst CharacterGroups = new Map<string, Set<CharacterName>>();\nCharacterGroups.set(\"ProtagonistBackgrounds\", ProtagonistBackgrounds);\nCharacterGroups.set(\"LordBackgrounds\", LordBackgrounds);\nCharacterGroups.set(\"CommonerBackgrounds\", CommonerBackgrounds);\nCharacterGroups.set(\"NobleBackgrounds\", NobleBackgrounds);\n\n// Initialized with the loadClassData() method.\nconst ClassRequirementsMap = new Map<CharacterClass, ClassData>();\n\nexport function getClassGeneralData(characterClass : CharacterClass) : ClassData\n{\n    const data = ClassRequirementsMap.get(characterClass);\n    if (data === undefined)\n    {\n        throw new RangeError(`No class data found for class ${CharacterClass[characterClass]}`);\n    }\n    return data;\n}\n\nexport function hasClassGeneralData(characterClass : CharacterClass) : boolean\n{\n    return ClassRequirementsMap.has(characterClass);\n}\n\nfunction prob(growths : StatUpProbabilities)\n{\n    return growths.map((x) => x * 0.01) as StatUpProbabilities;\n}\n\n// Initialized with the loadClassData() method.\nconst ClassGrowths = new Map<CharacterClass, StatUpProbabilities>();\n\nexport function getClassGrowthRateMod(characterClass : CharacterClass) : StatUpProbabilities\n{\n    const growths = ClassGrowths.get(characterClass);\n    if (growths === undefined)\n    {\n        throw new RangeError(`No growth rates found for class ${CharacterClass[characterClass]}`);\n    }\n    return growths;\n}\n\nexport function getRequirementForCharacterAndClass(character : CharacterName, characterClass : CharacterClass) : ClassRequirements | undefined\n{\n    const requirements = getClassGeneralData(characterClass).requirements;\n\n    // Try to get the lowest level requirement compatible with the character.\n    const specificCharacterRequirements = requirements.filter(req => {\n        const matchOnGender = req.gender === null || req.gender === getCharacterTraits(character).gender;\n        const matchOnSpecificCharacter = req.characters === null || req.characters.has(character);\n        return matchOnGender && matchOnSpecificCharacter;\n    });\n\n    if (specificCharacterRequirements.length > 0)\n    {\n        return specificCharacterRequirements.reduce((x,y) => (x.level <= y.level ? x : y));\n    }\n    else\n    {\n        // None available\n        return undefined;\n    }\n}\n\n// ================= CHARACTER AND CLASS ELIGIBILITY =================\n\nexport function isCharacterEligibleForClass(characterClass : CharacterClass, character : CharacterName, level? : number) : boolean\n{\n    const requirements = getRequirementForCharacterAndClass(character, characterClass) as ClassRequirements;\n\n    if (requirements === undefined)\n    {\n        // If no requirements specified, assume data is incomplete and not usable.\n        return false;\n    }\n\n    if (requirements.characters === null || requirements.characters.has(character))\n    {\n        if (requirements.gender === null || requirements.gender === getCharacterTraits(character).gender)\n        {\n            if (level === undefined || requirements.level <= level)\n            {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n\nexport function getEligibleClasses(character : CharacterName, level? : number) : Set<CharacterClass>\n{\n    const eligibleClasses = new Set<CharacterClass>();\n\n    for (let i = 0; i < CharacterClass.End; i++)\n    {\n        const characterClass = i as CharacterClass;\n        const requirements = getRequirementForCharacterAndClass(character, characterClass);\n\n        if (requirements === undefined)\n        {\n            // If no candidate requirements, then we can't use this class.\n            // If no requirements period, then assume class is not eligible.\n            // Either way, this class isn't eligible.\n            continue;\n        }\n\n        if (requirements.characters === null || requirements.characters.has(character))\n        {\n            if (requirements.gender === null || requirements.gender === getCharacterTraits(character).gender)\n            {\n                if (level === undefined || requirements.level <= level)\n                {\n                    eligibleClasses.add(characterClass);\n                }\n            }\n        }\n    }\n\n    return eligibleClasses;\n}\n\n// ================= LOADING DATA FROM CSV FILES =================\n\nfunction zeroOrNumber(numberAsString : string) : number\n{\n    if (numberAsString.length === 0)\n    {\n        return 0;\n    }\n    else\n    {\n        return Number.parseInt(numberAsString);\n    }\n}\n\nconst StandardParseConfig = {\n    delimiter: ',',\n    newline: '\\n',\n    quoteChar: '\"',\n    escapeChar: '\"',\n    header: false,\n    dynamicTyping: false,\n    worker: false,\n    comments: true,\n    skipEmptyLines: true\n};\n\nasync function loadClassBonusStats(dataFile : string) : Promise<Map<CharacterClass,StatArray>>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const bonusStats = new Map<CharacterClass,StatArray>();\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, StandardParseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let className : CharacterClass = CharacterClass.End;\n        try\n        {\n            className = getClassFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            if (row[0].length > 0)\n            {\n                console.log(`Bonus stats: failed to look up display name. ${row[0]}`);\n            }\n            \n            continue;\n        }\n\n        const statBonuses : StatArray = [\n            zeroOrNumber(row[1]),\n            zeroOrNumber(row[2]),\n            zeroOrNumber(row[3]),\n            zeroOrNumber(row[4]),\n            zeroOrNumber(row[5]),\n            zeroOrNumber(row[6]),\n            zeroOrNumber(row[7]),\n            zeroOrNumber(row[8]),\n            zeroOrNumber(row[9])\n        ];\n\n        bonusStats.set(className, statBonuses);\n    }\n\n    return bonusStats;\n}\n\nasync function loadClassMinStats(dataFile : string) : Promise<Map<CharacterClass,StatArray>>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const minStats = new Map<CharacterClass,StatArray>();\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, StandardParseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let className : CharacterClass = CharacterClass.End;\n        try\n        {\n            className = getClassFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            if (row[0].length > 0)\n            {\n                console.log(`Base stats: failed to look up display name. ${row[0]}`);\n            }\n\n            continue;\n        }\n\n        const statLine : StatArray = [\n            zeroOrNumber(row[1]),\n            zeroOrNumber(row[2]),\n            zeroOrNumber(row[3]),\n            zeroOrNumber(row[4]),\n            zeroOrNumber(row[5]),\n            zeroOrNumber(row[6]),\n            zeroOrNumber(row[7]),\n            zeroOrNumber(row[8]),\n            zeroOrNumber(row[9])\n        ];\n\n        minStats.set(className, statLine);\n    }\n\n    return minStats;\n}\n\nexport async function loadClassGrowthRates(dataFile : string) : Promise<Map<CharacterClass,StatUpProbabilities>>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const growths = new Map<CharacterClass,StatUpProbabilities>();\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, StandardParseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let className : CharacterClass = CharacterClass.End;\n        try\n        {\n            className = getClassFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            if (row[0].length > 0)\n            {\n                console.log(`Growth rates: failed to look up display name. ${row[0]}`);\n            }\n\n            continue;\n        }\n\n        const growthRates : StatUpProbabilities = prob([\n            zeroOrNumber(row[1]),\n            zeroOrNumber(row[2]),\n            zeroOrNumber(row[3]),\n            zeroOrNumber(row[4]),\n            zeroOrNumber(row[5]),\n            zeroOrNumber(row[6]),\n            zeroOrNumber(row[7]),\n            zeroOrNumber(row[8]),\n            zeroOrNumber(row[9])\n        ]);\n\n        growths.set(className, growthRates);\n    }\n\n    return growths;\n}\n\nfunction parseGenderRequirement(genderInTable : string) : CharacterGenders | null\n{\n    if (genderInTable.startsWith(\"m\"))\n    {\n        return \"male\";\n    }\n    else if (genderInTable.startsWith(\"f\"))\n    {\n        return \"female\";\n    }\n    else\n    {\n        return null;\n    }\n}\n\nfunction parseCharacterRequirement(charactersString : string) : Set<CharacterName> | null\n{\n    if (charactersString.length === 0)\n    {\n        return null;\n    }\n\n    const characterGroupLookup = CharacterGroups.get(charactersString);\n\n    if (characterGroupLookup !== undefined)\n    {\n        return characterGroupLookup;\n    }\n\n    try\n    {\n        const specificCharacterLookup = getCharacterFromDisplayName(charactersString);\n        return new Set<CharacterName>([specificCharacterLookup]);\n    }\n    catch\n    {\n        // Failed to find specific character\n        console.log(`Failed to match required character string \"${charactersString}\" to character set.`);\n    }\n    \n    return null;\n}\n\nexport async function loadClassRequirements(dataFile : string) : Promise<Map<CharacterClass,ClassRequirements[]>>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const requirementsMap = new Map<CharacterClass,ClassRequirements[]>();\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, StandardParseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let className : CharacterClass = CharacterClass.End;\n        try\n        {\n            className = getClassFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            if (row[0].length > 0)\n            {\n                console.log(`Class requirements: failed to look up display name. ${row[0]}`);\n            }\n            continue;\n        }\n\n        const requirements : ClassRequirements = {\n            level : Number.parseInt(row[1]),\n            gender : parseGenderRequirement(row[2]),\n            characters : parseCharacterRequirement(row[3])\n        };\n        \n        if (!requirementsMap.has(className))\n        {\n            requirementsMap.set(className, []);\n        }\n\n        // Elide the \"undefined\" because the line above ensures the entry exists.\n        const bucket = requirementsMap.get(className) as ClassRequirements[];\n        bucket.push(requirements);\n    }\n\n    return requirementsMap;\n}\n\nexport async function loadClassData() : Promise<void>\n{\n    const bonusStatMap = await loadClassBonusStats(ClassBonusStatsFile);\n    //console.log(bonusStatMap);\n\n    const minStatMap = await loadClassMinStats(ClassMinStatsFile);\n    //console.log(minStatMap);\n\n    const growthRateMap = await loadClassGrowthRates(ClassGrowthRatesFile);\n    //console.log(growthRateMap);\n\n    const requirementsMap = await loadClassRequirements(ClassRequirementsFile);\n    //console.log(requirementsMap);\n\n    // Now assemble the tables\n    for (let i = 0; i < CharacterClass.End; i++)\n    {\n        const characterClass = i as CharacterClass;\n\n        const bonusStats = bonusStatMap.get(characterClass);\n        const minStats = minStatMap.get(characterClass);\n        const requirements = requirementsMap.get(characterClass);\n        const growthRates = growthRateMap.get(characterClass);\n\n        if (bonusStats === undefined || minStats === undefined || requirements === undefined || growthRates === undefined)\n        {\n            // Single class short on some data\n            console.log(`Class ${getClassDisplayName(characterClass)} missing some data. `\n                + `Bonus Stats: ${bonusStats !== undefined}, Min Stats: ${minStats === undefined}, `\n                + `Requirements: ${requirements === undefined}, Growth Rates: ${growthRates === undefined}`);\n        }\n\n        if (bonusStats !== undefined && minStats !== undefined && requirements !== undefined)\n        {\n            ClassRequirementsMap.set(characterClass, {\n                baseStats: minStats,\n                bonusStats: bonusStats,\n                requirements: requirements\n            });\n        }\n\n        if (growthRates !== undefined)\n        {\n            ClassGrowths.set(characterClass, growthRates);\n        }\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterName, getCharacterFromDisplayName } from \"./CharacterName\";\nimport Papa from \"papaparse\";\nimport { getFetchProvider } from \"./FetchProvider\";\n\n// There are no non-binary recruitable characters. Byleth can be either\n// gender, represented as two different characters in the names list.\nexport type CharacterGenders = \"male\" | \"female\";\n\nexport interface Traits \n{\n    gender : CharacterGenders;\n    isStudent : boolean;\n};\n\nexport const CharacterTraits = new Map<CharacterName, Traits>();\n\nexport async function loadCharacterTraitsFromDataFile(dataFile : string) : Promise<void>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => {\n        return text.replaceAll(\"\\r\\n\",\"\\n\");\n    });\n\n    const parseConfig = {\n        delimiter: ',',\n        newline: '\\n',\n        quoteChar: '\"',\n        escapeChar: '\"',\n        header: false,\n        dynamicTyping: false,\n        worker: false,\n        comments: true,\n        skipEmptyLines: true\n    };\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, parseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let characterName : CharacterName = CharacterName.End;\n        try\n        {\n            characterName = getCharacterFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            continue;\n        }\n\n        const gender : CharacterGenders = row[1].startsWith(\"m\") ? \"male\" : \"female\";\n        const isStudent : boolean = row[2].startsWith(\"t\");\n        CharacterTraits.set(characterName, {gender: gender, isStudent: isStudent});\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { StatUpProbabilities } from \"../sim/StatArray\";\nimport { CharacterName, getCharacterFromDisplayName } from \"./CharacterName\";\nimport Papa from \"papaparse\";\nimport { getFetchProvider } from \"./FetchProvider\";\n\nfunction prob(growths : StatUpProbabilities) : StatUpProbabilities\n{\n    return growths.map((x) => x * 0.01) as StatUpProbabilities;\n}\n\nexport const GrowthRates = new Map<CharacterName, StatUpProbabilities>();\n\nexport async function loadCharacterGrowthsFromDataFile(dataFile : string) : Promise<void>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const parseConfig = {\n        delimiter: ',',\n        newline: '', // autodetect\n        quoteChar: '\"',\n        escapeChar: '\"',\n        header: false,\n        dynamicTyping: false,\n        worker: false,\n        comments: true,\n        skipEmptyLines: true\n    };\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, parseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let characterName : CharacterName = CharacterName.End;\n        try\n        {\n            characterName = getCharacterFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            continue;\n        }\n\n        const growths = prob([\n            Number.parseInt(row[1]),\n            Number.parseInt(row[2]),\n            Number.parseInt(row[3]),\n            Number.parseInt(row[4]),\n            Number.parseInt(row[5]),\n            Number.parseInt(row[6]),\n            Number.parseInt(row[7]),\n            Number.parseInt(row[8]),\n            Number.parseInt(row[9])\n        ]);\n        \n        GrowthRates.set(characterName, growths);\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { StatArray } from \"../sim/StatArray\";\nimport { CharacterName, getCharacterFromDisplayName } from \"./CharacterName\";\nimport Papa from \"papaparse\";\nimport { getFetchProvider } from \"./FetchProvider\";\n\nexport const CharacterMaxStats = new Map<CharacterName, StatArray>();\n\nexport async function loadCharacterMaxStatsFromDataFile(dataFile : string) : Promise<void>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const parseConfig = {\n        delimiter: ',',\n        newline: '', // autodetect\n        quoteChar: '\"',\n        escapeChar: '\"',\n        header: false,\n        dynamicTyping: false,\n        worker: false,\n        comments: true,\n        skipEmptyLines: true\n    };\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, parseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let characterName : CharacterName = CharacterName.End;\n        try\n        {\n            characterName = getCharacterFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            continue;\n        }\n\n        const statMaxes : StatArray = [\n            Number.parseInt(row[1]),\n            Number.parseInt(row[2]),\n            Number.parseInt(row[3]),\n            Number.parseInt(row[4]),\n            Number.parseInt(row[5]),\n            Number.parseInt(row[6]),\n            Number.parseInt(row[7]),\n            Number.parseInt(row[8]),\n            Number.parseInt(row[9])\n        ];\n        \n        CharacterMaxStats.set(characterName, statMaxes);\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Papa from \"papaparse\";\nimport { StartingStats, StatArray } from \"../sim/StatArray\";\nimport { CharacterClass, getClassFromDisplayName } from \"./CharacterClass\";\nimport { CharacterName, getCharacterFromDisplayName } from \"./CharacterName\";\nimport { getFetchProvider } from \"./FetchProvider\";\n\nexport interface CharacterInitialData\n{\n    level : number;\n    class : CharacterClass;\n    // These are expected to be the composite stats, not the base stats.\n    // In other words, these stats are class-dependent.\n    stats : StartingStats;\n    title? : string;\n}\n\n// Shortcuts for players to load common stat blocks, typically known values for recruitment\nexport const CharacterPresets = new Map<CharacterName, Array<CharacterInitialData>>();\n\nexport async function loadCharacterPresetsFromDataFile(dataFile : string) : Promise<void>\n{\n    const fetchFunc = getFetchProvider().fetch;\n    const data = await fetchFunc(dataFile).then(text => text.replaceAll(\"\\r\\n\",\"\\n\"));\n\n    const parseConfig = {\n        delimiter: ',',\n        newline: '', // autodetect\n        quoteChar: '\"',\n        escapeChar: '\"',\n        header: false,\n        dynamicTyping: false,\n        worker: false,\n        comments: true,\n        skipEmptyLines: true\n    };\n\n    // No schema validation because this data is not meant to be editable, not casually anyway, \n    // so the data file is considered code. Use unit tests to enforce schema compliance.\n    // But basic tolerances to deal with Excel's foibles in case they enter the picture.\n    const parseResult = Papa.parse(data, parseConfig);\n    for (const row of (parseResult.data as Array<string[]>))\n    {\n        let characterName : CharacterName = CharacterName.End;\n        try\n        {\n            characterName = getCharacterFromDisplayName(row[0]);\n        }\n        catch (e)\n        {\n            // Rows of empty cells and invalid characters names will get ignored here.\n            continue;\n        }\n\n        const level : number = Number.parseInt(row[1]);\n        const characterClass : CharacterClass = getClassFromDisplayName(row[2]);\n        const statLine : StatArray = [\n            Number.parseInt(row[3]),\n            Number.parseInt(row[4]),\n            Number.parseInt(row[5]),\n            Number.parseInt(row[6]),\n            Number.parseInt(row[7]),\n            Number.parseInt(row[8]),\n            Number.parseInt(row[9]),\n            Number.parseInt(row[10]),\n            Number.parseInt(row[11])\n        ];\n        const title : string = row[12];\n        \n        if (!CharacterPresets.has(characterName))\n        {\n            CharacterPresets.set(characterName, []);\n        }\n\n        // can ignore null case because of the previous condition\n        const presetList = CharacterPresets.get(characterName) as CharacterInitialData[];\n        presetList.push({\n            level: level,\n            class: characterClass,\n            stats: statLine,\n            title: title\n        });\n    }\n}\n","export default __webpack_public_path__ + \"static/media/character_traits.918f2cd0.csv\";","export default __webpack_public_path__ + \"static/media/character_growth_rates.adf11c0c.csv\";","export default __webpack_public_path__ + \"static/media/character_max_stats.ebd6b9f7.csv\";","export default __webpack_public_path__ + \"static/media/character_presets.c0c191f8.csv\";","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterName } from \"./CharacterName\";\nimport { iCHA, iDEF, iDEX, iLCK, iMAG, iRES, iSPD, iSTR, StatArray, StatUpProbabilities, subtractStats } from \"../sim/StatArray\";\nimport { CharacterClass } from \"./CharacterClass\";\nimport { getClassGeneralData } from \"./ClassData\";\nimport { CharacterTraits, loadCharacterTraitsFromDataFile, Traits } from \"./CharacterTraits\";\nimport { GrowthRates, loadCharacterGrowthsFromDataFile } from \"./CharacterGrowths\";\nimport { CharacterMaxStats, loadCharacterMaxStatsFromDataFile } from \"./CharacterMaxStats\";\nimport { CharacterInitialData, CharacterPresets, loadCharacterPresetsFromDataFile } from \"./CharacterPresets\";\n\nimport CharacterTraitsFile from \"./character_traits.csv\";\nimport CharacterGrowthsFile from \"./character_growth_rates.csv\";\nimport CharacterMaxStatsFile from \"./character_max_stats.csv\";\nimport CharacterPresetsFile from \"./character_presets.csv\";\n\nexport const CHARACTER_MAX_LEVEL = 99;\n\nexport function getCharacterTraits(name : CharacterName) : Traits\n{\n    const traits = CharacterTraits.get(name);\n    if (traits === undefined)\n    {\n        throw new RangeError(`No character traits entry for ${CharacterName[name]}`);\n    }\n    return traits;\n}\n\nexport function getCharacterBaseGrowths(name : CharacterName) : StatUpProbabilities\n{\n    const growths = GrowthRates.get(name);\n    if (growths === undefined)\n    {\n        throw new RangeError(`Base growth rates not found for ${CharacterName[name]}`);\n    }\n    return growths;\n}\n\nexport interface StatLimitMods\n{\n    StrAndSpdUp : boolean; // Statue of Cichol\n    LckAndChaUp : boolean; // Statue of Cethleann\n    MagAndDexUp : boolean; // Statue of Macuil\n    DefAndResUp : boolean; // Statue of Indech\n}\n\nexport function getDefaultStatModSetting()\n{\n    // Default to all true because stat caps are generally uninteresting for playthroughs, \n    // and also most people using this at this point are probably veteran players.\n    return {\n        StrAndSpdUp: true,\n        LckAndChaUp: true,\n        MagAndDexUp: true,\n        DefAndResUp: true\n    };\n}\n\nexport function getCharacterMaxBaseStats(character : CharacterName, mods? : StatLimitMods)\n{\n    const maybeMaxStats = CharacterMaxStats.get(character);\n    if (maybeMaxStats === undefined)\n    {\n        throw new RangeError(\"Character max stats not found.\");\n    }\n\n    const maxStats = [...maybeMaxStats] as StatArray;\n    if (mods?.StrAndSpdUp === true)\n    {\n        maxStats[iSTR] += 5;\n        maxStats[iSPD] += 5;\n    }\n\n    if (mods?.LckAndChaUp === true)\n    {\n        maxStats[iLCK] += 5;\n        maxStats[iCHA] += 5;\n    }\n\n    if (mods?.MagAndDexUp === true)\n    {\n        maxStats[iMAG] += 5;\n        maxStats[iDEX] += 5;\n    }\n\n    if (mods?.DefAndResUp === true)\n    {\n        maxStats[iDEF] += 5;\n        maxStats[iRES] += 5;\n    }\n\n    return maxStats;\n}\n\n\n// Handles case where no mod is equivalent to all false\nexport function areEquivalentStatLimitMods(left? : StatLimitMods, right? : StatLimitMods) : boolean\n{\n    return !!(left?.StrAndSpdUp) === !!(right?.StrAndSpdUp)\n        && !!(left?.LckAndChaUp) === !!(right?.LckAndChaUp)\n        && !!(left?.MagAndDexUp) === !!(right?.MagAndDexUp)\n        && !!(left?.DefAndResUp) === !!(right?.DefAndResUp);\n}\n\nexport function getCharacterInitialPresets(name : CharacterName) : CharacterInitialData[]\n{\n    return CharacterPresets.get(name) ?? [];\n}\n\nexport function getBaseStatsFromClassStats(stats : StatArray, characterClass : CharacterClass)\n{\n    const classData = getClassGeneralData(characterClass);\n    const boost = classData.bonusStats;\n    return subtractStats(stats, boost);\n}\n\nexport function getCharactersWithDefinedData() : Set<CharacterName>\n{\n    const charactersWithData : CharacterName[] = [];\n\n    for (let i = 0; i < CharacterName.End; i++)\n    {\n        const c = i as CharacterName;\n        if (CharacterTraits.has(c) && CharacterMaxStats.has(c) && GrowthRates.has(c))\n        {\n            charactersWithData.push(c);\n        }\n    }\n\n    return new Set(charactersWithData);\n}\n\nexport async function loadCharacterData() : Promise<void>\n{\n    await loadCharacterTraitsFromDataFile(CharacterTraitsFile);\n    await loadCharacterGrowthsFromDataFile(CharacterGrowthsFile);\n    await loadCharacterMaxStatsFromDataFile(CharacterMaxStatsFile);\n    await loadCharacterPresetsFromDataFile(CharacterPresetsFile);\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport interface IStorageProvider\n{\n    setItem(key: string, item: string) : void;\n    getItem(key: string) : string | null;\n    clear() : void;\n}\n\n// Redirects storage calls into a sub-oject in the storage provider.\nexport class NestedStorageProvider implements IStorageProvider\n{\n    private subKey : string;\n    private rootProvider : IStorageProvider;\n    private obj : {[key: string] : string};\n\n    constructor(key : string, rootStorageProvider : IStorageProvider)\n    {\n        this.subKey = key;\n        this.rootProvider = rootStorageProvider;\n        \n        // Load the object from store.\n        const fromStore = rootStorageProvider.getItem(this.subKey);\n        if (fromStore === null)\n        {\n            this.obj = {};\n        }\n        else\n        {\n            this.obj = JSON.parse(fromStore);\n        }\n    }\n\n    public setItem(key: string, item: string) : void\n    {\n        this.obj[key] = item;\n        this.rootProvider.setItem(this.subKey, JSON.stringify(this.obj));\n    }\n\n    public getItem(key: string) : string | null\n    {\n        if (key in this.obj)\n        {\n            return this.obj[key];\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    public clear() : void\n    {\n        this.obj = {};\n        this.rootProvider.setItem(this.subKey, JSON.stringify(this.obj));\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport interface ColorScheme\n{\n    baseColor: string;\n    baseHighlightColor: string;\n\n    medianValueColor: string;\n    medianValueHighlightColor: string;\n\n    // If the user chooses to set a reference point for \"how is my character doing?\"\n    referenceValueColor: string;\n    referenceValueHighlightColor: string;\n}\n\n// Used for styling various data series.\nexport const SERIES_COLOR_SCHEMES: Array<ColorScheme> = [\n    {\n        baseColor: \"#d34747\",\n        baseHighlightColor: \"#f28282\",\n        medianValueColor: \"#c11e1e\",\n        medianValueHighlightColor: \"#f28282\",\n        referenceValueColor: \"#a70303\",\n        referenceValueHighlightColor: \"#c11e1e\",\n    },\n    {\n        baseColor: \"#404094\",\n        baseHighlightColor: \"#6666a8\",\n        medianValueColor: \"#262687\",\n        medianValueHighlightColor: \"#6666a8\",\n        referenceValueColor: \"#131375\",\n        referenceValueHighlightColor: \"#262687\",\n    },\n    {\n        baseColor: \"#248924\",\n        baseHighlightColor: \"#469b46\",\n        medianValueColor: \"#0c780c\",\n        medianValueHighlightColor: \"#469b46\",\n        referenceValueColor: \"#006500\",\n        referenceValueHighlightColor: \"#0c780c\",\n    }\n];","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterClass, getStartingClasses } from \"../data/CharacterClass\";\nimport { getCharacterInitialPresets, getDefaultStatModSetting } from \"../data/CharacterData\";\nimport { CharacterName } from \"../data/CharacterName\";\nimport { CharacterInitialData } from \"../data/CharacterPresets\";\nimport { ClassData, ClassRequirements, getClassGeneralData, getEligibleClasses, getRequirementForCharacterAndClass } from \"../data/ClassData\";\nimport { CharacterProfile } from \"./CharacterProfile\";\n\nfunction getDefaultCharacterName() : CharacterName\n{\n    // We're just going to hardcode the default, but let's explicitly not default to a specific gender.\n    if (Math.random() < 0.5)\n    {\n        return CharacterName.BylethMale;\n    }\n    else\n    {\n        return CharacterName.BylethFemale;\n    }\n}\n\nexport class NoValidDefaultClassError extends Error\n{\n    //constructor(message : string)\n    //{\n    //    super(message);\n    //}\n}\n\nfunction getCharacterDefaultGenericClass(character : CharacterName, level : number) : CharacterClass\n{\n    const eligibleClasses = getEligibleClasses(character, level);\n    \n    if (eligibleClasses.size === 0)\n    {\n        throw new NoValidDefaultClassError(`Character has no eligible classes at level ${level}`);\n    }\n\n    const starterClasses = getStartingClasses();\n    const baseClasses = Array.from(eligibleClasses).filter(c => starterClasses.has(c));\n    if (baseClasses.length > 0)\n    {\n        // If there's a commoner or noble class then use that.\n        return baseClasses[0];\n    }\n    else\n    {\n        // Otherwise use one of the classes with the lowest level requirement, which more or less means \"Dancer\".\n        const classList = Array.from(eligibleClasses).map(c => [c, getClassGeneralData(c)] as [CharacterClass, ClassData]);\n        classList.sort((a, b) => {\n            // Can elide the \"undefined\" return value because we know the character is eligible, which\n            // only happens if matching requirements exist.\n            const aReq = getRequirementForCharacterAndClass(character, a[0]) as ClassRequirements;\n            const bReq = getRequirementForCharacterAndClass(character, b[0]) as ClassRequirements;\n            return aReq.level - bReq.level;\n        });\n        return classList[0][0];\n    }\n}\n\nfunction getDefaultCharacterInitialData(character : CharacterName) : CharacterInitialData\n{\n    const presets = getCharacterInitialPresets(character);\n\n    if (presets.length > 0)\n    {\n        // If there's existing initial data then use the lowest level one, and if there are multiple\n        // then use whatever of the lowest level.\n        const presetsCopy = [...presets];\n        presetsCopy.sort((a, b) => a.level - b.level);\n        return presetsCopy[0];\n    }\n    else\n    {\n        // If there isn't, then we make some shit up.\n        return {\n            level: 1,\n            class: getCharacterDefaultGenericClass(character, 1),\n            stats: [25, 5, 5, 5, 5, 5, 5, 5, 5]\n        };\n    }\n\n}\n\n// This is non-trivial because we are selecting \"firsts\" for every value but we must select valid values,\n// and they must be internally consistent.\nexport function createDefaultEmptyCharacterProfile() : CharacterProfile\n{\n    const characterName = getDefaultCharacterName();\n    const initialData = getDefaultCharacterInitialData(characterName);\n    const endLevel = Math.max(30, initialData.level);\n    const maxStatMods = getDefaultStatModSetting();\n\n    return {\n        character : characterName,\n        startLevel : initialData.level,\n        startClass : initialData.class,\n        startStats : initialData.stats,\n        changes : [],\n        endLevel : endLevel,\n        maxStatMods : maxStatMods\n    };\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { StatDistributionsByLevel } from \"../sim/GrowthResultAccumulator\";\nimport { StatArray, zeroStats } from \"../sim/StatArray\";\nimport { IStorageProvider, NestedStorageProvider } from \"../storage/NestedStorageProvider\";\nimport { SERIES_COLOR_SCHEMES } from \"../ui/ChartColorScheme\";\nimport { CharacterProfile } from \"./CharacterProfile\";\nimport { createDefaultEmptyCharacterProfile } from \"./Defaults\";\n\nexport const INVALID_PAGE_LISTENER_HANDLE : number = -1;\nconst FIRST_PAGE_LISTENER_HANDLE : number = 0;\n\nexport interface AnalysisComponent\n{\n    profile : CharacterProfile;\n    result : StatDistributionsByLevel;\n}\n\nexport interface AnalysisReport\n{\n    // Cache profiles used for analysis so that report can be kept separately.\n    components : AnalysisComponent[];\n    cacheToken : number;\n}\n\nexport interface PageData\n{\n    // Might need to swap this for a UI type that allows invalid UI selections\n    profiles : CharacterProfile[];\n\n    referenceStats : StatArray;\n\n    report : AnalysisReport | null;\n}\n\nexport class MaxCharacterProfileCountError extends Error\n{\n    public constructor(message : string)\n    {\n        super(message);\n    }\n}\n\nexport type PageCallback = (page : number, data : PageData) => void;\n\nexport interface IPageManager\n{\n    getPages() : Set<number>;\n    hasPage(page : number) : boolean;\n    createNewPage(page : number) : void;\n    deletePage(page : number) : void;\n\n    newProfile(page : number) : void;\n    deleteProfile(page : number, index : number) : void;\n    updateProfile(page : number, index : number, profile : CharacterProfile) : void;\n    updateAnalysis(page : number, report : AnalysisReport | null) : void;\n    // updateReferenceStats(page : number, stats : StatArray) : void;\n\n    getPageData(page : number) : PageData;\n\n    addPageListener(page : number, callback : PageCallback) : number;\n    removePageListener(page : number, handle : number) : void;\n}\n\nfunction createNewPageData() : PageData\n{\n    return {\n        profiles : [createDefaultEmptyCharacterProfile()],\n        referenceStats : zeroStats(),\n        report : null\n    };\n}\n\nfunction getMaxProfileCount() : number\n{\n    return SERIES_COLOR_SCHEMES.length;\n}\n\nclass PageManager implements IPageManager\n{\n    private storageProvider : IStorageProvider;\n    private pages : Map<number, PageData>;\n    private listeners : Map<number, Map<number, PageCallback>>;\n    private listenerCounter : number;\n    private pageListChangeCallback : () => void;\n\n    public constructor(rootStorageProvider : IStorageProvider, pageListChangeCallback : () => void)\n    {\n        this.storageProvider = new NestedStorageProvider(\"pages\", rootStorageProvider);\n        this.pages = new Map<number, PageData>();\n        this.listeners = new Map<number, Map<number, PageCallback>>();\n        this.listenerCounter = FIRST_PAGE_LISTENER_HANDLE;\n        this.pageListChangeCallback = pageListChangeCallback;\n    }\n\n    //\n    // Page Management\n    //\n\n    public getPages() : Set<number>\n    {\n        return new Set(this.pages.keys());\n    }\n\n    public hasPage(page : number) : boolean\n    {\n        return this.pages.has(page);\n    }\n\n    public createNewPage(page : number)\n    {\n        if (this.pages.has(page))\n        {\n            throw new RangeError(\"Cannot create new page against an existing page number.\")\n        }\n\n        this.pages.set(page, createNewPageData());\n        this.pageListChangeCallback();\n    }\n\n    public deletePage(page : number)\n    {\n        if (this.pages.has(page))\n        {\n            this.pages.delete(page);\n        }\n        this.pageListChangeCallback();\n    }\n\n    public newProfile(page : number) : void\n    {\n        if (!this.pages.has(page))\n        {\n            throw new RangeError(`Cannot find page data for page number ${page}`);\n        }\n\n        // Can hide the undefined value because of the check above.\n        const pageData = this.pages.get(page) as PageData;\n\n        if (pageData.profiles.length >= getMaxProfileCount())\n        {\n            throw new MaxCharacterProfileCountError(\"Cannot add more profiles because profile limit has been reached.\");\n        }\n\n        const newPageData : PageData = {\n            profiles : [...pageData.profiles, createDefaultEmptyCharacterProfile()],\n            referenceStats : zeroStats(),\n            report : pageData.report\n        };\n        this.pages.set(page, newPageData);\n        \n        this.onPageUpdate(page);\n    }\n\n    public deleteProfile(page : number, index : number)\n    {\n        if (!this.pages.has(page))\n        {\n            throw new RangeError(`Cannot find page data for page number ${page}`);\n        }\n\n        // Can hide the undefined value because of the check above.\n        const pageData = this.pages.get(page) as PageData;\n\n        if (index >= pageData.profiles.length || index < 0)\n        {\n            throw new RangeError(`Profile index ${index} is outside range of profiles array.`);\n        }\n\n        const newProfileList = [...pageData.profiles];\n        newProfileList.splice(index, 1);\n        const newPageData : PageData = {\n            profiles : newProfileList,\n            referenceStats : pageData.referenceStats,\n            report : pageData.report\n        };\n        this.pages.set(page, newPageData);\n        \n        this.onPageUpdate(page);\n    }\n\n    public updateProfile(page : number, index : number, profile : CharacterProfile) : void\n    {\n        if (!this.pages.has(page))\n        {\n            throw new RangeError(`Cannot find page data for page number ${page}`);\n        }\n\n        // Can hide the undefined value because of the check above.\n        const pageData = this.pages.get(page) as PageData;\n\n        if (index >= pageData.profiles.length || index < 0)\n        {\n            throw new RangeError(`Profile index ${index} is outside range of profiles array.`);\n        }\n\n        const newProfileList = [...pageData.profiles];\n        newProfileList[index] = profile;\n        const newPageData : PageData = {\n            profiles : newProfileList,\n            referenceStats : pageData.referenceStats,\n            report : pageData.report\n        };\n        this.pages.set(page, newPageData);\n        \n        this.onPageUpdate(page);\n    }\n\n    public updateAnalysis(page : number, report : AnalysisReport | null) : void\n    {\n        if (!this.pages.has(page))\n        {\n            throw new RangeError(`Cannot find page data for page number ${page}`);\n        }\n\n        // Can hide the undefined value because of the check above.\n        const pageData = this.pages.get(page) as PageData;\n        const newPageData : PageData = {\n            profiles : pageData.profiles,\n            referenceStats : pageData.referenceStats,\n            report : report\n        };\n        this.pages.set(page, newPageData);\n        \n        this.onPageUpdate(page);\n    }\n\n    // public updateReferenceStats(page : number, stats : StatArray) : void\n    // {\n    //     if (!this.pages.has(page))\n    //     {\n    //         throw new RangeError(`Cannot find page data for page number ${page}`);\n    //     }\n\n    //     const pageData = this.pages.get(page) as PageData;\n    //     const newPageData : PageData = {\n    //         profiles : pageData.profiles,\n    //         referenceStats : stats,\n    //         report : pageData.report\n    //     };\n\n    //     this.pages.set(page, newPageData);\n        \n    //     this.onPageUpdate(page);\n    // }\n\n    public getPageData(page : number) : PageData\n    {\n        if (!this.pages.has(page))\n        {\n            throw new RangeError(`Cannot find page data for page number ${page}`);\n        }\n        \n        // Can hide the undefined value because of the check above.\n        return this.pages.get(page) as PageData;\n    }\n\n    public addPageListener(page : number, callback : PageCallback) : number\n    {\n        if (!this.listeners.has(page))\n        {\n            this.listeners.set(page, new Map<number, PageCallback>());\n        }\n\n        // Safe to hide null because statement above guarantees the value.\n        const pageListeners = this.listeners.get(page) as Map<number, PageCallback>;\n\n        const newHandle = this.getNewPageListenerHandle();\n        pageListeners.set(newHandle, callback);\n        return newHandle;\n    }\n\n    public removePageListener(page : number, handle : number) : void\n    {\n        this.listeners.get(page)?.delete(handle);\n    }\n\n    private getNewPageListenerHandle() : number\n    {\n        const handleValue = this.listenerCounter;\n        this.listenerCounter++;\n        return handleValue;\n    }\n\n    private onPageUpdate(page : number) : void\n    {\n        if (this.listeners.has(page))\n        {\n            const listeners = this.listeners.get(page) as Map<number, PageCallback>;\n            if (this.pages.has(page))\n            {\n                const pageData = this.pages.get(page) as PageData;\n                for (const listener of listeners.values())\n                {\n                    listener(page, pageData);\n                }\n            }\n        }\n    }\n}\n\nexport function createPageManager(rootStorageProvider : IStorageProvider,\n    pageListChangeCallback : () => void) : IPageManager\n{\n    return new PageManager(rootStorageProvider, pageListChangeCallback);\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n// Essentially acts as the overall app state with accessor/mutator functions.\n\nimport React from \"react\";\nimport { IStorageProvider } from \"../storage/NestedStorageProvider\";\nimport { createAnalysisResultCache, IAnalysisResultCache } from \"./AnalysisResultCache\";\nimport { createPageManager, IPageManager } from \"./PageManager\";\n\nexport interface IAppContextValue\n{\n    // This should change with every change.\n    modCounter : number;\n\n    // These are persistent refs to singleton complex objects.\n    pageManager : IPageManager;\n    analysisCache : IAnalysisResultCache;\n}\n\nexport interface IAppContext\n{\n    // Notifies of value changes.\n    setValueChangedCallback(callback : (v : IAppContextValue) => void) : void;\n    readonly currentValue : IAppContextValue;\n    readonly Context : React.Context<IAppContextValue>;\n}\n\n// Page order is responsibility of owner to sort out and render. This is just data.\nclass AppContext implements IAppContext\n{\n    private modCount : number;\n    private pageManager : IPageManager;\n    private analysisResultCache : IAnalysisResultCache;\n    private contextInstance : React.Context<IAppContextValue>;\n    private _currentValue : IAppContextValue;\n\n    private valueCallback : (v : IAppContextValue) => void;\n\n    constructor(rootStorageProvider : IStorageProvider)\n    {\n        this.modCount = 0;\n        this.pageManager = createPageManager(rootStorageProvider, () => this.pageListUpdated);\n        this.analysisResultCache = createAnalysisResultCache(rootStorageProvider);\n        this.contextInstance = React.createContext<IAppContextValue>(this.getDefaultContextValue());\n\n        this._currentValue = {\n            modCounter : this.modCount,\n            pageManager : this.pageManager,\n            analysisCache : this.analysisResultCache\n        };\n\n        this.valueCallback = v => {};\n    }\n\n    public setValueChangedCallback(callback : (v : IAppContextValue) => void) : void\n    {\n        this.valueCallback = callback;\n    }\n\n    public get Context() : React.Context<IAppContextValue>\n    {\n        return this.contextInstance;\n    }\n\n    public get currentValue() : IAppContextValue\n    {\n        return this._currentValue;\n    }\n\n    private updateValueAndNotify() : void\n    {\n        this.modCount++;\n\n        this._currentValue = {\n            ...this._currentValue,\n            modCounter : this.modCount\n        };\n\n        this.valueCallback(this._currentValue);\n    }\n\n    private pageListUpdated() : void\n    {\n        this.updateValueAndNotify();\n    }\n\n    private getDefaultContextValue() : IAppContextValue\n    {\n        return {\n            modCounter : this.modCount,\n            pageManager : this.pageManager,\n            analysisCache : this.analysisResultCache\n        };\n    }\n}\n\nlet appContextInstance : IAppContext | null = null;\nexport function getAppContext()\n{\n    if (appContextInstance === null)\n    {\n        appContextInstance = new AppContext(window.sessionStorage);\n    }\n    return appContextInstance;\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { IStorageProvider } from \"../storage/NestedStorageProvider\";\n\nexport interface IAnalysisResultCache\n{\n\n}\n\n// Mocked for now.\nexport function createAnalysisResultCache(rootStorageProvider : IStorageProvider) : IAnalysisResultCache\n{\n    return {};\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nexport function utf16ToString(data : ArrayBuffer) : string\n{\n    const elems = new Uint16Array(data);\n    return String.fromCharCode(...elems);\n}\n\nexport function stringToUTF16(s : string) : ArrayBuffer\n{\n    let buf = new ArrayBuffer(s.length * 2); // 2 bytes for each char\n    let bufView = new Uint16Array(buf);\n    const len = s.length;\n    for (let i = 0; i < len; i++) \n    {\n        bufView[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nexport function toBase64(data : ArrayBuffer) : string\n{\n    const asByteArray = new Uint8Array(data);\n    let str = String.fromCharCode(...asByteArray)\n    return btoa(str)\n}\n\nexport function fromBase64(b64 : string) : ArrayBuffer\n{\n    let str = \"\";\n    try\n    {\n        str = atob(b64);\n    }\n    catch (e)\n    {\n        throw new TypeError(\"Not a valid base64 string.\");\n    }\n\n    let buf = new ArrayBuffer(str.length);\n    let bufView = new Uint8Array(buf);\n    const len = str.length;\n    for (let i = 0; i < len; i++)\n    {\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buf;\n}\n\nexport function fromBase64Url(b64url : string) : ArrayBuffer\n{\n    let b64 = b64url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    return fromBase64(b64);\n}\n\nexport function concatenateBuffers(a : Uint8Array, b : Uint8Array) : Uint8Array\n{\n    let buf = new Uint8Array(a.length + b.length);\n    buf.set(a, 0);\n    buf.set(b, a.length);\n    return buf;\n}\n\nexport function concatenateArrayBuffers(a : ArrayBuffer, b : ArrayBuffer) : ArrayBuffer\n{\n    const buffer_a = new Uint8Array(a);\n    const buffer_b = new Uint8Array(b);\n\n    return concatenateBuffers(buffer_a, buffer_b).buffer;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterClass } from \"../data/CharacterClass\";\nimport { StatLimitMods } from \"../data/CharacterData\";\nimport { CharacterName } from \"../data/CharacterName\";\nimport { isCharacterEligibleForClass } from \"../data/ClassData\";\nimport { stringToUTF16, toBase64 } from \"../lib/EncodingHelper\";\nimport { ClassChange, GrowthProfile } from \"../sim/GrowthProfile\";\nimport { StartingStats, StatArray, STAT_COUNT } from \"../sim/StatArray\";\n\n// Like GrowthProfile, but not like GrowthProfile, in the sense that the CharacterProfile\n// allows class changes that are below the starting level or above the end level.\n// This has to be reconciled by filtering the class changes when generating the GrowthProfile\n// from it.\nexport interface CharacterProfile\n{\n    character : CharacterName;\n    startLevel : number;\n    startClass : CharacterClass;\n    startStats : StartingStats;\n    // Assume they are in order of application from low to high level, but not necessarily all\n    // within the level constraints.\n    changes : Array<ClassChange>;\n    endLevel : number;\n    maxStatMods : StatLimitMods;\n}\n\n// What class will a character land on if the analysis ends at a given level?\nexport function getFinalClassAtLevelForProfile(profile : CharacterProfile, level : number) : CharacterClass\n{\n    const candidateClassChanges = profile.changes.filter(classChange => (classChange.level <= level));\n\n    if (candidateClassChanges.length === 0)\n    {\n        return profile.startClass;\n    }\n\n    // Could be more big-O efficient by using a map but we don't expect the class changes list to get big, so this \n    // should be fine. Possibly even faster than going through a map at sub-20 elements.\n\n    // Else find highest level that is still beneath or equal to \"level\", then find the highest index match.\n    const highestCandidateLevel = candidateClassChanges.reduce((p, c) => (p.level > c.level ? p : c)).level;\n    \n    // Get the last of the matched level\n    for (let i = candidateClassChanges.length - 1; i >= 0; i--)\n    {\n        if (candidateClassChanges[i].level === highestCandidateLevel)\n        {\n            return candidateClassChanges[i].class;\n        }\n    }\n\n    throw new Error(\"Code should not reach here. If it does, it means the algorithm for finding the expected character class is wrong.\");\n}\n\nfunction getNormalizedStatString(stats : StatArray) : string\n{\n    return `[${stats.map(s => s.toString()).join(\",\")}]`;\n}\n\nfunction getNormalizedClassChangeString(changes : ClassChange[]) : string\n{\n    const changeStrings = changes.map(c => `(${c.level},${c.class.valueOf().toString()})`);\n    return `[${changeStrings.join(\",\")}]`;\n}\n\nfunction getNormalizedGrowthProfileString(profile : GrowthProfile) : string\n{\n    const normalizedClassChangeString = getNormalizedClassChangeString(profile.changes);\n\n    return `${profile.startClass.valueOf()}/${profile.startLevel}/${getNormalizedStatString(profile.startStats)}/${profile.endLevel}/${normalizedClassChangeString}`;\n}\n\nfunction getNormalizedStatLimitsString(mods? : StatLimitMods) : string\n{\n    if (mods === undefined)\n    {\n        return \"{StrSpd:false,LckCha:false,MagDex:false,DefRes:false}\";\n    }\n    else\n    {\n        return `{StrSpd:${mods.StrAndSpdUp.toString()},LckCha:${mods.LckAndChaUp.toString()},MagDex:${mods.MagAndDexUp.toString()},DefRex:${mods.DefAndResUp.toString()}}`;\n    }\n}\n\nexport async function getCharacterProfileHash(character : CharacterName, profile : GrowthProfile, mods? : StatLimitMods) : Promise<string>\n{\n    const normalizedProfile = getNormalizedGrowthProfileString(profile);\n    const normalizedStatLimits = getNormalizedStatLimitsString(mods);\n    const dataString = `${character}|${normalizedProfile}|${normalizedStatLimits}`;\n    const data = stringToUTF16(dataString);\n\n    // We don't need secure, we just need functional.\n    const digest = await window.crypto.subtle.digest(\"SHA-1\", data);\n    return toBase64(digest);\n}\n\nexport function serializeCharacterProfileToJson(profile : CharacterProfile) : string\n{\n    return JSON.stringify(profile);\n}\n\nexport interface ParseCharacterProfileJsonResult\n{\n    result? : CharacterProfile;\n    error? : string;\n}\n\ninterface FieldDefinition\n{\n    name : string;\n    check : (a : any) => boolean;\n}\n\nfunction isBoundedInteger(x : any, minBoundInclusive : number, maxBoundExclusive? : number) : boolean\n{\n    if (!Number.isInteger(x))\n    {\n        return false;\n    }\n    \n    const asInt = x as number;\n\n    if (asInt < minBoundInclusive)\n    {\n        return false;\n    }\n    else if (maxBoundExclusive !== undefined && asInt >= maxBoundExclusive)\n    {\n        return false;\n    }\n\n    return true;\n}\n\nfunction isMaxStatModEquivalent(x : any) : boolean\n{\n    if (!(typeof(x) === 'object'))\n    {\n        return false;\n    }\n\n    const boolFields = [\"StrAndSpdUp\", \"LckAndChaUp\", \"MagAndDexUp\", \"DefAndResUp\"];\n    return boolFields.every(field => (field in x && typeof(x[field]) === 'boolean'));\n}\n\nfunction isClassChangeEquivalent(x : any) : boolean\n{\n    if (!(typeof(x) === 'object'))\n    {\n        return false;\n    }\n    else if (!(\"level\" in x) || !isBoundedInteger(x[\"level\"], 1))\n    {\n        return false;\n    }\n    else if (!(\"class\" in x) || !isBoundedInteger(x[\"class\"], 0, CharacterClass.End))\n    {\n        return false;\n    }\n    else\n    {\n        return true;\n    }\n}\n\nfunction isCharacterProfileEquivalent(obj : any) : boolean\n{\n    const fields : FieldDefinition[] = [\n        {name: \"character\", check: x => isBoundedInteger(x, 0, CharacterName.End)},\n        {name: \"startLevel\", check: x => isBoundedInteger(x, 1)},\n        {name: \"startClass\", check: x => isBoundedInteger(x, 0, CharacterClass.End)},\n        {name: \"startStats\", check: (a : any) => Array.isArray(a) && (a as any[]).every(x => isBoundedInteger(x, 0))},\n        {name: \"endLevel\", check: (x) => isBoundedInteger(x, 0)},\n        {name: \"maxStatMods\", check: (x) => isMaxStatModEquivalent(x)},\n        {name: \"changes\", check: (a : any) => Array.isArray(a) && (a as any[]).every(isClassChangeEquivalent)}\n    ];\n\n    return fields.every(fieldDefinition => (fieldDefinition.name in obj) && fieldDefinition.check(obj[fieldDefinition.name]));\n}\n\nfunction isValidCharacterName(characterName : CharacterName) : boolean\n{\n    return Number.isInteger(characterName) && characterName >= 0 && characterName < CharacterName.End;\n}\n\nfunction isValidEndLevel(endLevel : number, startLevel : number) : boolean\n{\n    return Number.isInteger(endLevel) && endLevel >= startLevel;\n}\n\nfunction isValidStartingStats(startingStats : any) : boolean\n{\n    if (!Array.isArray(startingStats))\n    {\n        return false;\n    }\n\n    const asArray : any[] = startingStats as any[];\n\n    if (asArray.length !== STAT_COUNT)\n    {\n        return false;\n    }\n\n    if (!asArray.every(x => Number.isInteger(x)))\n    {\n        return false;\n    }\n\n    const asStatArray : StatArray = asArray as StatArray;\n\n    if (!asStatArray.every(x => x >= 0))\n    {\n        return false;\n    }\n\n    return true;\n}\n\nfunction areValidClassChanges(character : CharacterName, classChanges: ClassChange[]) : boolean\n{\n    // We already know they're all valid class change objects.\n    // Just enforce that all class changes should be in increasing level order.\n    for (let i = 0; i < classChanges.length - 1; i++)\n    {\n        if (classChanges[i].level > classChanges[i+1].level)\n        {\n            return false;\n        }\n    }\n\n    return classChanges.every(c => isCharacterEligibleForClass(c.class, character, c.level));\n}\n\nexport function deserializeCharacterProfileFromJson(json : string) : ParseCharacterProfileJsonResult\n{\n    let parsed : any = null;\n    try\n    {\n        parsed = JSON.parse(json);\n    }\n    catch\n    {\n        return {error: \"Not valid JSON.\"};\n    }\n\n    // Now validate\n    if (typeof(parsed) !== 'object')\n    {\n        return {error: \"Not a valid JSON string.\"};\n    }\n\n    if (!isCharacterProfileEquivalent(parsed))\n    {\n        return {error: \"The JSON does not match the schema for a character code.\"};\n    }\n\n    const asCharacterProfileSchema : CharacterProfile = parsed as CharacterProfile;\n\n    if (!isValidCharacterName(asCharacterProfileSchema.character))\n    {\n        return {error: \"Not a valid character number.\"};\n    }\n\n    if (!isValidEndLevel(asCharacterProfileSchema.endLevel, asCharacterProfileSchema.startLevel))\n    {\n        return {error: \"The end level is lower than the start level.\"};\n    }\n\n    if (!isValidStartingStats(asCharacterProfileSchema.startStats))\n    {\n        // Might not be a reachable line of code due to validation in isCharacterProfileEquivalent. Oh well.\n        return {error: \"Invalid starting stats.\"};\n    }\n\n    if (!areValidClassChanges(asCharacterProfileSchema.character, asCharacterProfileSchema.changes))\n    {\n        return {error: \"Out-of-order class changes or invalid level(s) for class change(s).\"};\n    }\n\n    return {result: parsed};\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { forEachStat, forEachStatIndex, StatArray, StatUpProbabilities } from \"./StatArray\";\n\nconst guaranteedLowStatUpStats : StatArray = [0,1,1,0,0,0,0,0,0];\n\nexport function computeZeroOtherwiseProbabilities(rawGrowthRate : StatUpProbabilities) : StatUpProbabilities\n{\n    const oneMinus = forEachStat(rawGrowthRate, x => (1.0-x));\n\n    // Do it the slow way, do it faster if this isn't performant enough.\n    return forEachStatIndex(index => {\n        return oneMinus\n            .map((n, i) => i === index ? 1.0 : n)\n            .reduce((a,b) => a*b);\n    }) as StatUpProbabilities;\n}\n\nexport function computeZeroOrOneStatUpProbability(rawGrowthRate : StatUpProbabilities, pZeroOtherwise : StatUpProbabilities) : number\n{\n    const oneMinus = forEachStat(rawGrowthRate, x => (1.0-x));\n    const zeroStatsUp = oneMinus.reduce((a, b) => a * b);\n    const oneStatUp = rawGrowthRate.map((p, i) => p * pZeroOtherwise[i]);\n    return zeroStatsUp + oneStatUp.reduce((p, c) => p + c);\n}\n\n// Students have bad RNG protection: if their levelup would have given them 0 or 1 stat up, they will gain 2 instead.\nexport function getAdjustedGrowthRates(rawGrowthRate : StatUpProbabilities) : StatUpProbabilities\n{\n    // Probability that all other stats, other than the specified index, do not go up\n    const pZeroOtherwise : StatUpProbabilities = computeZeroOtherwiseProbabilities(rawGrowthRate);\n    const pZeroOrOneTotal : number = computeZeroOrOneStatUpProbability(rawGrowthRate, pZeroOtherwise);\n\n    const adjustedStats = forEachStatIndex(index => {\n        const pUp = rawGrowthRate[index];\n        return pUp * (1 - pZeroOtherwise[index]) + guaranteedLowStatUpStats[index] * pZeroOrOneTotal;\n    }) as StatUpProbabilities;\n\n    return adjustedStats;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n// Represents an array of probabilities resembling a binomial distribution of outcomes.\n// Used for empirical calculation of simulation steps.\n// Note: large difference in magnitude of probability between smallest and largest probabilities\n// probably means normalization differences, but those are probably not significant in the\n// context of Fire Emblem.\n\n// If drift resulted in total normalization error to exceed certain guardrails, then fail instead of\n// continuing to try to normalize.\nconst NormalizationErrorLimit = 0.01;\nconst ProbabilityZeroLimit = 0.0001;\n\nfunction isAlmostZero(n : number) : boolean\n{\n    return Math.abs(n) <= ProbabilityZeroLimit;\n}\n\nexport class ProbabilityArray\n{\n    private offset : number;\n    private p : Array<number>;\n\n    public constructor(minValue : number, maxValue : number)\n    {\n        if (maxValue < minValue)\n        {\n            throw new RangeError(\"Expected maxValue to be at least minValue.\");\n        }\n\n        this.offset = minValue;\n        this.p = new Array<number>(maxValue - minValue + 1);\n        for (let i = 0, width = this.p.length; i < width; i++)\n        {\n            this.p[i] = 0;\n        }\n    }\n\n    public get minValue() : number\n    {\n        return this.offset;\n    }\n\n    public get maxValue() : number\n    {\n        return this.offset + this.p.length - 1;\n    }\n\n    public get width() : number\n    {\n        return this.p.length;\n    }\n\n    // value should be an integer.\n    public getProbability(value : number) : number\n    {\n        const index = value - this.offset;\n        if (index < 0 || index > this.p.length)\n        {\n            throw new RangeError(\"Value \" + value.toString() + \" is out of bounds of this probability array.\");\n        }\n\n        return this.p[index];\n    }\n\n    public setProbability(value : number, probability : number) : void\n    {\n        const index = value - this.offset;\n        if (index < 0 || index > this.p.length)\n        {\n            throw new RangeError(\"Value \" + value.toString() + \" is out of bounds of this probability array.\");\n        }\n\n        this.p[index] = probability;\n    }\n\n    public addProbability(value : number, probability : number) : void\n    {\n        const index = value - this.offset;\n        if (index < 0 || index > this.p.length)\n        {\n            throw new RangeError(\"Value \" + value.toString() + \" is out of bounds of this probability array.\");\n        }\n\n        this.p[index] += probability;\n    }\n\n    public clone() : ProbabilityArray\n    {\n        let p = new ProbabilityArray(this.minValue, this.maxValue);\n        for (let i = 0, width = this.p.length; i < width; i++)\n        {\n            p.setProbability(this.offset + i, this.p[i]);\n        }\n\n        return p;\n    }\n\n    // shift is a final export adjustment, mostly to handle class bonus stats\n    public export(shift : number = 0) : Map<number, number>\n    {\n        let e = new Map<number, number>();\n        for (let i = 0, width = this.p.length; i < width; i++)\n        {\n            e.set(this.offset + i + shift, this.p[i]);\n        }\n        return e;\n    }\n\n    // Deal with accumulated error by normalizing so that sum of probabilities stays around 1.\n    public normalize() : void\n    {\n        let sum = 0.0;\n        this.p.forEach((v) => {sum += v;});\n\n        if (Math.abs(1.0 - sum) < NormalizationErrorLimit)\n        {\n            let scale = 1.0/sum;\n            for (let i = 0, width = this.p.length; i < width; i++)\n            {\n                this.p[i] *= scale;\n            }\n        }\n        else\n        {\n            throw new Error(\"Attempted normalization on a probability array where sum of probabilities was too unusual. Total P is \" + sum.toString());\n        }\n    }\n\n    public clampProbability(lowerBound : number) : ProbabilityArray\n    {\n        const clampIndex = lowerBound - this.offset;\n\n        if (clampIndex <= 0)\n        {\n            // Clamping has no effect if lower bound doesn't change anything.\n            return this.clone();\n        }\n        else if (clampIndex >= this.width - 1)\n        {\n            // Clamping just brings probability up to 1 if lower bound is at/above highest value.\n            let p = new ProbabilityArray(lowerBound, lowerBound);\n            p.setProbability(lowerBound, 1.0);\n            return p;\n        }\n        else\n        {\n            // Any intermediate values requires summing up to clamp index.\n            let clampedProbability = 0.0;\n            for (let i = 0; i <= clampIndex; i++)\n            {\n                clampedProbability += this.p[i];\n            }\n\n            let p = new ProbabilityArray(lowerBound, this.maxValue);\n            // Lowest value goes to accumulated total of results up to lower bound.\n            p.setProbability(lowerBound, clampedProbability);\n            // Rest are cloned.\n            for (let i = 1, remainder = this.width - 1 - clampIndex; i <= remainder; i++)\n            {\n                p.setProbability(lowerBound + i, this.p[clampIndex + i])\n            }\n\n            return p;\n        }\n    }\n\n    // Generates next row of binomial expansion based on a given probability\n    // of the stat rising in this step.\n    // To be more explicit, for P(x+1, n) where n is the n-th iteration (levelup), and\n    // x + 1 is the value (meaning stat == x + 1 after the levelup), then this should be\n    // true: P(x+1, n) = P(x+1, n-1) * (1 - pStatUp) + P(x, n-1) * pStatUp\n    public stepProbability(pStatUp : number, cap : number) : ProbabilityArray\n    {\n        if (pStatUp < 0.0 || pStatUp > 1.0)\n        {\n            throw new RangeError(\"Invalid value for pStatUp: not a real probability. Value: \" + pStatUp.toString());\n        }\n\n        if (isAlmostZero(pStatUp))\n        {\n            return this.clone();\n        }\n        else if (isAlmostZero(1.0 - pStatUp))\n        {\n            // In 1.0 case, the stat always goes up.\n            let p = new ProbabilityArray(this.minValue + 1, this.maxValue + 1)\n            for (let i = 0, width = this.p.length; i < width; i++)\n            {\n                const index = Math.min(this.offset + i + 1, cap);\n                p.addProbability(index, this.p[i]);\n            }\n            return p;\n        }\n        else\n        {\n            // Valid probability, have to calculate because it's nontrivial.\n            let p = new ProbabilityArray(this.minValue, this.maxValue + 1)\n            let pNotChanged = 1.0 - pStatUp;\n            for (let i = 0, width = this.p.length; i < width; i++)\n            {\n                const thisProb = this.p[i];\n                \n                // Support for max base stats\n                const indexLower = Math.min(this.offset + i, cap);\n                const indexUpper = Math.min(this.offset + i + 1, cap);\n\n                p.addProbability(indexLower, thisProb * pNotChanged);\n                p.addProbability(indexUpper, thisProb * pStatUp);\n            }\n            \n            return p;\n        }\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n// Takes the array of levelup probabilities and calculates expected total stat growths\n\nimport { ProbabilityArray } from \"./ProbabilityArray\";\nimport { StatUpProbabilities } from \"./StatArray\";\n\n\nfunction recursivePermutation(index : number, priorProbability : number, currentSum : number, \n    statUpProbabilities : StatUpProbabilities, cumulative : ProbabilityArray) : void\n{\n    if (index === statUpProbabilities.length)\n    {\n        // Exit case\n        cumulative.addProbability(currentSum, priorProbability);\n    }\n    else\n    {\n        const thisLevelupProbability = statUpProbabilities[index];\n        recursivePermutation(index + 1, priorProbability * (1.0 - thisLevelupProbability), currentSum, \n            statUpProbabilities, cumulative);\n        recursivePermutation(index + 1, priorProbability * thisLevelupProbability, currentSum + 1,\n            statUpProbabilities, cumulative);\n    }\n}\n\nexport function computeStatGrowthTotalProbabilities(levelups : StatUpProbabilities, isStudent : boolean) : ProbabilityArray\n{\n    // Layer 1 is no stats involved.\n    let probabilities = new ProbabilityArray(0, levelups.length);\n    \n    // Go through all 2^n possibilities by recursive permutation.\n    // Iterative would be faster, but it's 2^9, if perf is an issue then we're doing something horribly wrong.\n    recursivePermutation(0, 1.0, 0, levelups, probabilities);\n    probabilities.normalize();\n\n    // If it's a student, it has \"RNG protection\" which guarantees at least two stats go up.\n    if (isStudent)\n    {\n        probabilities = probabilities.clampProbability(2);\n    }\n\n    return probabilities;\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n// Remembers progressive growth probability values.\n// This is a big pile of data generated for a character based on overall growth profile.\n\nimport { CharacterClass, getClassDisplayName } from \"../data/CharacterClass\";\nimport { getCharacterBaseGrowths, getBaseStatsFromClassStats, getCharacterMaxBaseStats, StatLimitMods, getCharacterTraits } from \"../data/CharacterData\";\nimport { CharacterName, getCharacterDisplayName } from \"../data/CharacterName\";\nimport { getClassGeneralData, getClassGrowthRateMod } from \"../data/ClassData\";\nimport { getAdjustedGrowthRates } from \"./AdjustedGrowthRate\";\nimport { GrowthProfile } from \"./GrowthProfile\";\nimport { ProbabilityArray } from \"./ProbabilityArray\";\nimport { iCHA, iDEF, iDEX, iHP, iLCK, iMAG, iRES, iSPD, iSTR, iTOTAL, addProbabilities, StatArray, StatUpProbabilities, statToString } from \"./StatArray\";\nimport { computeStatGrowthTotalProbabilities } from \"./StatGrowthTotalCalculator\";\n\nexport interface DistributionsByStat\n{\n    hp : Map<number, number>;\n    str : Map<number, number>;\n    mag : Map<number, number>;\n    dex : Map<number, number>;\n    spd : Map<number, number>;\n    lck : Map<number, number>;\n    def : Map<number, number>;\n    res : Map<number, number>;\n    cha : Map<number, number>;\n    levelupTotal : Map<number, number>;\n}\n\ninterface StatMedianDetails\n{\n    pLower : number;\n    pHigher : number;\n    pMedian : number;\n    median : number;\n}\n\nexport interface NormalAndAdjustedGrowthRate\n{\n    normal : StatUpProbabilities;\n    adjusted : StatUpProbabilities;\n}\n\nexport function computeDistributionMedianForSingleStat(distribution : DistributionsByStat, index : number) : StatMedianDetails | undefined\n{\n    const singleStatDistribution = getDistributionByStatIndex(distribution, index);\n\n    let pTotal = Array.from(singleStatDistribution.values()).reduce((a, b) => a + b, 0);\n    let pTarget = pTotal * 0.5;\n\n    let cumulativeProbability = 0.0;\n    let buckets = Array.from(singleStatDistribution.keys()).sort((a, b) => a - b);\n    \n    for (let i = 0; i < buckets.length; i++)\n    {\n        const key = buckets[i];\n        const probability = singleStatDistribution.get(key) as number;\n\n        let before = cumulativeProbability;\n        let after = cumulativeProbability + probability;\n\n        if (before <= pTarget && after > pTarget)\n        {\n            return {\n                median: key,\n                pLower: before,\n                pHigher: after,\n                pMedian: probability\n            };\n        }\n\n        cumulativeProbability += probability;\n    }\n\n    // No median found\n    return undefined;\n}\n\nexport function getDistributionByStatIndex(distribution : DistributionsByStat, index : number) : Map<number,number>\n{\n    switch(index)\n    {\n        case iHP:\n            return distribution.hp;\n        case iSTR:\n            return distribution.str;\n        case iMAG:\n            return distribution.mag;\n        case iDEX:\n            return distribution.dex;\n        case iSPD:\n            return distribution.spd;\n        case iLCK:\n            return distribution.lck;\n        case iDEF:\n            return distribution.def;\n        case iRES:\n            return distribution.res;\n        case iCHA:\n            return distribution.cha;\n        case iTOTAL:\n            return distribution.levelupTotal;\n        default:\n            throw new RangeError(`Unrecognized index ${index} for retrieving distribution for specific stat.`);\n    }\n}\n\nexport type StatDistributionsByLevel = Map<number, DistributionsByStat>;\n\nexport function precomputeClassChanges(profile : GrowthProfile) : Array<Array<CharacterClass>>\n{\n    let levelupMap = new Map<number, Array<CharacterClass>>();\n\n    for (let i = profile.startLevel; i <= profile.endLevel; i++)\n    {\n        levelupMap.set(i, new Array<CharacterClass>());\n    }\n\n    profile.changes.forEach(classChange => {\n        const classChanges = levelupMap.get(classChange.level);\n        if (classChanges === undefined)\n        {\n            throw new Error(\"Error precomputing levelups: variable classChanges is undefined.\");\n        }\n        classChanges.push(classChange.class);\n    });\n\n    let computedChanges = new Array<Array<CharacterClass>>();\n    for (let i = profile.startLevel; i <= profile.endLevel; i++)\n    {\n        const level = levelupMap.get(i);\n        if (level === undefined)\n        {\n            throw new Error(\"Error precomputing levelups: variable level is undefined.\");\n        }\n        computedChanges.push(level);\n    }\n\n    return computedChanges;\n}\n\nfunction logGrowthRates(character: CharacterName, isStudent: boolean, characterClass: CharacterClass, \n    rawGrowths: StatUpProbabilities, adjustedGrowths: StatUpProbabilities) : void\n{\n    console.info(`Growth rate adjustments for ${getCharacterDisplayName(character)} as ${getClassDisplayName(characterClass)}:`\n        + `\\n     raw: ${statToString(rawGrowths)}`\n        + `\\nadjusted: ${statToString(adjustedGrowths)}`);\n}\n\nexport function precomputeClassGrowthRates(character : CharacterName, profile : GrowthProfile) : Map<CharacterClass, NormalAndAdjustedGrowthRate>\n{\n    const isStudent = getCharacterTraits(character).isStudent;\n    const baseLevelups = getCharacterBaseGrowths(character);\n\n    const cache = new Map<CharacterClass, NormalAndAdjustedGrowthRate>();\n\n    // Start class, we know we need it precomputed.\n    const startClassGrowthMod = getClassGrowthRateMod(profile.startClass);\n    const startClassRawGrowth = addProbabilities(baseLevelups, startClassGrowthMod)\n    const startClassAdjustedGrowths = isStudent ? getAdjustedGrowthRates(startClassRawGrowth) : startClassRawGrowth;\n\n    logGrowthRates(character, isStudent, profile.startClass, startClassRawGrowth, startClassAdjustedGrowths);\n\n    cache.set(profile.startClass, {\n        normal: startClassRawGrowth,\n        adjusted: startClassAdjustedGrowths\n    });\n\n    profile.changes.forEach(change => {\n        if (cache.get(change.class) === undefined)\n        {\n            const growthMod = getClassGrowthRateMod(change.class);\n            const rawGrowths = addProbabilities(baseLevelups, growthMod);\n            const adjustedGrowths = isStudent ? getAdjustedGrowthRates(rawGrowths) : rawGrowths;\n\n            logGrowthRates(character, isStudent, change.class, rawGrowths, adjustedGrowths);\n\n            cache.set(change.class, {\n                normal: rawGrowths,\n                adjusted: adjustedGrowths\n            });\n        }\n    });\n\n    return cache;\n}\n\nexport function calculateLevelupDistributions(cachedGrowths: Map<CharacterClass, NormalAndAdjustedGrowthRate>, isStudent : boolean) \n    : Map<CharacterClass, ProbabilityArray>\n{\n    let distributions = new Map<CharacterClass, ProbabilityArray>();\n\n    cachedGrowths.forEach((growthRate, className) => {\n        if (distributions.get(className) === undefined)\n        {\n            // Haven't computed this one yet, so compute it.\n            distributions.set(className, computeStatGrowthTotalProbabilities(growthRate.normal, isStudent));\n        }\n    });\n\n    return distributions;\n}\n\nexport function applyClassChanges(distributions : Array<ProbabilityArray>, classChanges : Array<CharacterClass>) : Array<ProbabilityArray>\n{\n    if (distributions.length === 0)\n    {\n        return distributions;\n    }\n    else\n    {\n        let newDistributions = [...distributions];\n\n        classChanges.forEach(className => {\n            const classBaseStats = getClassGeneralData(className).baseStats;\n            for (let i = 0; i < classBaseStats.length; i++)\n            {\n                newDistributions[i] = newDistributions[i].clampProbability(classBaseStats[i]);\n            }\n        });\n\n        return newDistributions;\n    }\n}\n\nexport function applyLevelup(distributions : Array<ProbabilityArray>, growthRate : StatUpProbabilities, caps : StatArray) : Array<ProbabilityArray>\n{\n    const newDistributions = new Array<ProbabilityArray>(distributions.length);\n\n    for (let i = 0; i < growthRate.length; i++)\n    {\n        newDistributions[i] = distributions[i].stepProbability(growthRate[i], caps[i]);\n    }\n\n    return newDistributions;\n}\n\nexport function exportStatDistributions(stats : Array<ProbabilityArray>, bonusStats : StatArray, growthDistribution : ProbabilityArray) : DistributionsByStat\n{\n    let normalized = new Array<ProbabilityArray>(9);\n    for (let i = 0; i < 9; i++)\n    {\n        normalized[i] = stats[i].clone();\n        normalized[i].normalize();\n    }\n\n    return {\n        hp:  normalized[0].export(bonusStats[0]),\n        str: normalized[1].export(bonusStats[1]),\n        mag: normalized[2].export(bonusStats[2]),\n        dex: normalized[3].export(bonusStats[3]),\n        spd: normalized[4].export(bonusStats[4]),\n        lck: normalized[5].export(bonusStats[5]),\n        def: normalized[6].export(bonusStats[6]),\n        res: normalized[7].export(bonusStats[7]),\n        cha: normalized[8].export(bonusStats[8]),\n        levelupTotal: growthDistribution.export()\n    };\n}\n\nexport class GrowthResultAccumulator\n{\n    private perLevel : StatDistributionsByLevel;\n    private profile : GrowthProfile;\n    private character : CharacterName;\n\n    private cachedLevels : Array<Array<CharacterClass>>;\n    private cachedGrowthRates : Map<CharacterClass, NormalAndAdjustedGrowthRate>;\n\n    private isStudent : boolean;\n\n    private statMaximums : StatArray;\n\n    public constructor(character : CharacterName, profile : GrowthProfile, mods? : StatLimitMods)\n    {\n        this.profile = profile;\n        this.character = character;\n        this.perLevel = new Map<number, DistributionsByStat>();\n\n        this.cachedLevels = precomputeClassChanges(this.profile);\n        this.cachedGrowthRates = precomputeClassGrowthRates(this.character, this.profile);\n\n        this.isStudent = getCharacterTraits(character).isStudent;\n\n        this.statMaximums = getCharacterMaxBaseStats(character, mods);\n    }\n\n    // This is a heavy computation!\n    public compute() : void\n    {\n        // Initialize distributions. These are expressed in base stats. Class bonus stats are merged into the results\n        // at recording time.\n        let distributions = new Array<ProbabilityArray>();\n        let baseStartStats = getBaseStatsFromClassStats(this.profile.startStats, this.profile.startClass);\n\n        for (let i = 0; i < baseStartStats.length; i++)\n        {\n            let startStat = baseStartStats[i];\n            let startDistribution = new ProbabilityArray(startStat, startStat);\n            startDistribution.setProbability(startStat, 1.0);\n            distributions.push(startDistribution);\n        }\n\n        const classBasedLevelupDistributions = calculateLevelupDistributions(this.cachedGrowthRates, this.isStudent);\n\n        // Now go level by level.\n\n        // first level, no levelup computation from previous level, but class changes are possible.\n        const firstLevelClassChanges = this.cachedLevels[0];\n        distributions = applyClassChanges(distributions, firstLevelClassChanges);\n        \n        let levelFinalClass = firstLevelClassChanges.length > 0 ? firstLevelClassChanges[firstLevelClassChanges.length - 1] : this.profile.startClass;\n\n        const firstLevelupDistribution = classBasedLevelupDistributions.get(levelFinalClass);\n        if (firstLevelupDistribution === undefined)\n        {\n            throw new RangeError(\"Cached table of levelup total stat distribution is missing entry for character class \" + getClassDisplayName(levelFinalClass));\n        }\n\n        // Record first level expected stats after all class changes.\n        this.recordLevelResults(this.profile.startLevel, distributions, levelFinalClass, firstLevelupDistribution);\n\n        // And now for the rest of the levels.\n        const levelSpread = this.profile.endLevel - this.profile.startLevel;\n        for (let levelIndex = 1; levelIndex <= levelSpread; levelIndex++)\n        {\n            // Levelup happens using the final class of the previous level.\n            const growthRate = this.cachedGrowthRates.get(levelFinalClass);\n\n            if (growthRate === undefined)\n            {\n                throw new RangeError(\"Cached growth rates missing entry for class \" + getClassDisplayName(levelFinalClass));\n            }\n\n            const actualLevel = this.profile.startLevel + levelIndex;\n            const classChanges = this.cachedLevels[levelIndex];\n\n            // Level up based on the final calss of the previous level, then apply class changes for this level, and then present\n            // stats based on the final class at this level.\n            distributions = applyClassChanges(applyLevelup(distributions, growthRate.adjusted, this.statMaximums), classChanges);\n            \n            levelFinalClass = classChanges.length > 0 ? classChanges[classChanges.length - 1] : levelFinalClass;\n            const levelupDistribution = classBasedLevelupDistributions.get(levelFinalClass);\n            if (levelupDistribution === undefined)\n            {\n                throw new RangeError(\"Cached table of levelup total stat distribution is missing entry for character class \" + getClassDisplayName(levelFinalClass));\n            }\n\n            // Store the result at each level.\n            this.recordLevelResults(actualLevel, distributions, levelFinalClass, levelupDistribution);\n        }\n    }\n\n    public getDistributions() : StatDistributionsByLevel\n    {\n        return this.perLevel;\n    }\n\n    private recordLevelResults(actualLevel: number, statDistribution: Array<ProbabilityArray>, \n        levelFinalClass: CharacterClass, levelupDistribution: ProbabilityArray) \n    {\n        const bonusStats = getClassGeneralData(levelFinalClass).bonusStats;\n        this.perLevel.set(actualLevel, exportStatDistributions(statDistribution, bonusStats, levelupDistribution));\n    }\n}\n\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport { CharacterClass, getCharacterClassesByCategory, CharacterClassGroup, getCharacterClassGroupDisplayName, getClassDisplayName } from \"../data/CharacterClass\";\nimport { CharacterName } from \"../data/CharacterName\";\nimport { getEligibleClasses } from \"../data/ClassData\";\n\nexport interface ClassSelectorProps\n{\n    value : CharacterClass;\n\n    character : CharacterName;\n    level? : number;\n\n    onSelected : (character : CharacterClass) => void;\n    props? : {[key : string] : any};\n}\n\nconst CharacterNameList = new Map<CharacterClass, string>();\n(() => \n{\n    for (let i = 0; i < CharacterClass.End.valueOf(); i++)\n    {\n        const character = i as CharacterClass;\n        CharacterNameList.set(character, getClassDisplayName(character));\n    }\n})();\n\ntype SelectChangedEvent = React.ChangeEvent<{name?: string, value: unknown}>;\n\nexport function ClassSelector(props : ClassSelectorProps) : JSX.Element\n{\n    const characterEntries = new Array<JSX.Element>();\n    const eligibleClasses = getEligibleClasses(props.character, props.level);\n\n    if (!eligibleClasses.has(props.value))\n    {\n        characterEntries.push(<option disabled value={props.value.valueOf()} key={props.value.valueOf()}>{getClassDisplayName(props.value)}</option>);\n    }\n\n    for (let f = 0; f < CharacterClassGroup.End; f++)\n    {\n        const group = f as CharacterClassGroup;\n        const entriesInGroup : Array<JSX.Element> = [];\n        getCharacterClassesByCategory(group).forEach((c) => {\n            if (eligibleClasses.has(c))\n            {\n                entriesInGroup.push(<option value={c.valueOf()} key={c.valueOf()}>{getClassDisplayName(c)}</option>);\n            }\n        })\n        if (entriesInGroup.length > 0)\n        {\n            characterEntries.push(<optgroup label={getCharacterClassGroupDisplayName(group)} key={group}>{entriesInGroup}</optgroup>);\n        }\n    }\n\n    const handler = async (event : SelectChangedEvent, child?: React.ReactNode) => {\n        const selected = parseInt((event.target.value as any).toString());\n        props?.onSelected(selected);\n    };\n\n    return (\n    <>\n        <FormControl>\n            <InputLabel htmlFor=\"class-selector-field\">Class</InputLabel>\n            <Select {...props.props} native value={props.value} onChange={handler} id=\"class-selector-field\" style={{minWidth: 160}}>\n                {characterEntries}\n            </Select>\n        </FormControl>\n    </>);\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\n\nexport interface LevelSelectorProps\n{\n    minLevel? : number;\n    maxLevel? : number;\n    value : number;\n    customText? : string;\n    labelStyle? : \"inline\" | \"overhead\";\n    onSelected : (level : number) => void;\n    props? : {[key : string] : any};\n}\n\ntype SelectChangedEvent = React.ChangeEvent<{name?: string, value: any}>;\n\nexport function LevelSelector(props : LevelSelectorProps) : JSX.Element\n{\n    const minLevel = props.minLevel ?? 1;\n    const maxLevel = props.maxLevel ?? 99;\n\n    function handler(event : SelectChangedEvent) {\n        let selected = parseInt(event.target.value.toString());\n        props?.onSelected(selected);\n    };\n\n    const entries : Array<JSX.Element> = [];\n    for (let i = minLevel; i <= maxLevel; i++)\n    {\n        entries.push(\n            <option value={i} key={i}>{i.toString()}</option>\n        );\n    }\n\n    if (props.customText !== undefined)\n    {\n        if ((props.labelStyle ?? \"overhead\") === \"overhead\")\n        {\n            return (\n                <FormControl>\n                    <InputLabel htmlFor=\"level-selector-field\">{props.customText}</InputLabel>\n                    <Select {...props.props} native value={props.value} onChange={handler} id=\"level-selector-field\">\n                        {entries}\n                    </Select>\n                </FormControl>\n            );\n        }\n        else\n        {\n            return (\n                <FormControl>\n                    <FormControlLabel \n                        control={\n                            <Select {...props.props} native value={props.value} onChange={handler} id=\"level-selector-field\" style={{marginLeft: 8}}>\n                                {entries}\n                            </Select>\n                        }\n                        label={props.customText}\n                        labelPlacement=\"start\"\n                    />\n                </FormControl>\n            );\n        }\n    }\n    else\n    {\n        return (\n            <FormControl>\n                <Select {...props.props} native value={props.value} onChange={handler} id=\"level-selector-field\">\n                    {entries}\n                </Select>\n            </FormControl>\n        );\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport { CharacterClass } from \"../data/CharacterClass\";\nimport { CHARACTER_MAX_LEVEL } from \"../data/CharacterData\";\nimport { CharacterName } from \"../data/CharacterName\";\nimport { getRequirementForCharacterAndClass, hasClassGeneralData } from \"../data/ClassData\";\nimport { ClassSelector } from \"./ClassSelector\";\nimport { LevelSelector } from \"./LevelSelector\";\n\nexport interface ClassAndLevelSelectorProps\n{\n    selectedClass : CharacterClass;\n    selectedLevel : number;\n\n    onChanged : (characterClass : CharacterClass, level : number) => void;\n\n    character : CharacterName;\n    minLevel? : number;\n    maxLevel? : number;\n\n    containerProps? : {[key : string] : any};\n    containerStyle? : React.CSSProperties;\n\n    classSelectorProps? : {[key : string] : any};\n    levelSelectorProps? : {[key : string] : any};\n}\n\nexport function ClassAndLevelSelector(props : ClassAndLevelSelectorProps) : JSX.Element\n{\n    const classRequirement = getRequirementForCharacterAndClass(props.character, props.selectedClass);\n\n    const effectiveMinLevel = Math.max(props.minLevel ?? 1, classRequirement?.level ?? 1);    \n    const effectiveMaxLevel = props.maxLevel ?? CHARACTER_MAX_LEVEL;\n\n    const classChangeHandler = (c : CharacterClass) => {\n        if (hasClassGeneralData(c))\n        {\n            const newClassRequirement = getRequirementForCharacterAndClass(props.character, c)\n            const effectiveNewMinLevel = newClassRequirement?.level ?? 1;\n            if (effectiveNewMinLevel > props.selectedLevel)\n            {\n                // Maintain correctness constraint\n                props.onChanged(c, effectiveNewMinLevel);    \n            }\n            else\n            {\n                props.onChanged(c, props.selectedLevel);    \n            }\n        }\n        else\n        {\n            props.onChanged(c, props.selectedLevel);\n        }\n    };\n\n    const levelChangeHandler = (l : number) => {\n        if (l < effectiveMinLevel)\n        {\n            props.onChanged(props.selectedClass, effectiveMinLevel);\n        }\n        else if (l > effectiveMaxLevel)\n        {\n            props.onChanged(props.selectedClass, effectiveMaxLevel);\n        }\n        else\n        {\n            props.onChanged(props.selectedClass, l);\n        }\n    };\n\n    let containerStyle : React.CSSProperties = {\n        ...props.containerStyle\n    };\n\n    return (\n        <div {...props.containerProps} style={containerStyle}>\n            <ClassSelector \n                value={props.selectedClass} \n                character={props.character}\n                onSelected={classChangeHandler}\n                props={props.classSelectorProps}\n            />\n            <LevelSelector\n                minLevel={effectiveMinLevel}\n                maxLevel={props.maxLevel}\n                value={props.selectedLevel}\n                onSelected={levelChangeHandler}\n                props={props.levelSelectorProps}\n                customText=\"Level\"\n                labelStyle=\"overhead\"\n            />\n        </div>);\n    \n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport Chip from \"@material-ui/core/Chip\";\nimport DragIndicatorIcon from '@material-ui/icons/DragIndicator';\n\nimport { DragDropContext, Droppable, Draggable, DroppableStateSnapshot, DroppableProvided, DraggableProvided, DraggableStateSnapshot, NotDraggingStyle, DraggingStyle, DropResult, ResponderProvided } from 'react-beautiful-dnd';\n\nimport { CharacterClass, getClassDisplayName } from \"../data/CharacterClass\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\n\nexport interface ClassChangeSingleLevelProps\n{\n    classes : Array<CharacterClass>;\n    disabled : boolean;\n    onReordered : (newClasses : Array<CharacterClass>) => void;\n    onDeleted : (newClasses : Array<CharacterClass>) => void;\n}\n\ninterface ClassChipProps\n{\n    value : CharacterClass;\n    provided? : DraggableProvided;\n    snapshot? : DraggableStateSnapshot;\n    disabled? : boolean;\n    onDelete : () => void;\n}\n\nfunction getClassChipStyle(isDragging : boolean, draggableStyle : DraggingStyle | NotDraggingStyle | undefined) : React.CSSProperties\n{\n    return {\n        marginLeft : 4,\n        marginRight: 4,\n        userSelect : 'none',\n        ...draggableStyle\n    };\n}\n\nfunction ClassChip(props : ClassChipProps)\n{\n    if (props.provided !== undefined && props.snapshot !== undefined)\n    {\n        // If draggable\n        return (\n            <div\n                ref={props.provided.innerRef}\n                {...props.provided.draggableProps}\n                {...props.provided.dragHandleProps}\n                style={getClassChipStyle(props.snapshot.isDragging, props.provided.draggableProps.style)}>\n                <Chip \n                    icon={<DragIndicatorIcon />}\n                    label={getClassDisplayName(props.value)}\n                    onDelete={() => {props.onDelete();}}\n                    color={props.disabled ? \"default\" : \"primary\"}\n                    clickable={false}\n                    style={{cursor: 'move'}}\n                />\n            </div>\n        );\n    }\n    else\n    {\n        return (\n            <div\n                style={getClassChipStyle(false, {})}>\n                <Chip \n                    label={getClassDisplayName(props.value)}\n                    onDelete={() => {props.onDelete();}}\n                    color={props.disabled ? \"default\" : \"primary\"}\n                    clickable={false}\n                />\n            </div>\n        );\n    }\n}\n\nfunction getClassChip (isDisabled : boolean, value : CharacterClass, index : number, onDelete : () => void, \n    provided? : DraggableProvided, snapshot? : DraggableStateSnapshot) : JSX.Element\n{\n    if (isDisabled)\n    {\n        return (\n            <ClassChip\n                key={index}\n                value={value}\n                onDelete={onDelete}\n                provided={provided}\n                snapshot={snapshot}\n                disabled\n            />);\n    }\n    else\n    {\n        return (\n            <ClassChip\n                key={index}\n                value={value}\n                onDelete={onDelete}\n                provided={provided}\n                snapshot={snapshot}\n            />);\n    }\n};\n\nconst DropContainerStyle : React.CSSProperties = {\n    backgroundColor: 'transparent',\n    display: 'flex',\n    flexDirection: 'row',\n    flexShrink: 1,\n    flexGrow: 0,\n    flexWrap: \"nowrap\",\n    paddingTop: 8,\n    paddingBottom: 8,\n    paddingLeft : 4,\n    paddingRight : 4,\n    minHeight : 32,\n};\n\nconst DragOverStyle : React.CSSProperties = {\n    paddingTop: 7,\n    paddingBottom: 7,\n    borderTop: \"1px solid #aaaaaa\",\n    borderBottom: \"1px solid #aaaaaa\",\n};\n\nfunction dropContainerStyle(isDraggingOver : boolean) : React.CSSProperties\n{\n    if (isDraggingOver)\n    {\n        console.log(\"over\");\n        return {...DropContainerStyle, ...DragOverStyle};\n    }\n    else\n    {\n        return DropContainerStyle;\n    }\n}\n\nexport function ClassChangeSingleLevel(props : ClassChangeSingleLevelProps) : JSX.Element\n{\n    const onDeleteHandler = (index : number, characterClass : CharacterClass) => {\n        const newClassList = [...props.classes];\n        newClassList.splice(index, 1);\n        props.onDeleted(newClassList);\n    };\n\n    let draggableItems : Array<JSX.Element> = [];\n\n    if (props.classes.length <= 1)\n    {\n        // Not draggable if nothing useful to be accomplished by dragging.\n        draggableItems = props.classes.map((value, ind) => {\n            const index = ind;\n            return getClassChip(props.disabled, value, ind, () => {onDeleteHandler(index, value)});\n        });\n    }\n    else\n    {\n        draggableItems = props.classes.map((value, ind) => {\n            const index = ind;\n            return (\n                <Draggable key={index} draggableId={index.toString()} index={index}>\n                    {(provided : DraggableProvided, snapshot : DraggableStateSnapshot) => \n                        getClassChip(props.disabled, value, ind, () => onDeleteHandler(index, value), provided, snapshot)\n                    }\n                </Draggable>\n            );\n        });\n    }\n\n    const dragEndHandler = (result : DropResult, provided : ResponderProvided) => {\n        if (!result.destination) {\n            return;\n        }\n\n        const newList = [...props.classes];\n        const srcIndex = result.source.index;\n        const destIndex = result.destination.index;\n\n        const elem = newList[srcIndex];\n        newList.splice(srcIndex, 1);\n        newList.splice(destIndex, 0, elem);\n        props.onReordered(newList);\n    };\n\n    if (props.classes.length <= 1)\n    {\n        return (\n            <div style={dropContainerStyle(false)}>\n                {draggableItems}\n            </div>);\n    }\n    else\n    {\n        return (\n            <DragDropContext onDragEnd={dragEndHandler}>\n                <Droppable droppableId=\"classChangeRow\" direction=\"horizontal\">\n                    {(provided : DroppableProvided, snapshot : DroppableStateSnapshot) => (\n                        <Tooltip title=\"Drag to re-order class changes.\">\n                            <div\n                                ref={provided.innerRef}\n                                style={dropContainerStyle(snapshot.isDraggingOver)}\n                                {...provided.droppableProps}\n                            >\n                                {draggableItems}\n                                {provided.placeholder}\n                            </div>\n                        </Tooltip>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        );   \n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport FormLabel from \"@material-ui/core/FormLabel\";\nimport { CharacterClass } from \"../data/CharacterClass\";\nimport { ClassChangeSingleLevel } from \"./ClassChangeSingleLevel\";\nimport Chip from \"@material-ui/core/Chip\";\n\nexport interface ClassChangeListProps\n{\n    list : Map<number, Array<CharacterClass>>;\n    minLevel : number;\n    onReordered : (newList : Map<number, Array<CharacterClass>>) => void;\n}\n\nconst CONTAINER_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexDirection : \"column\",\n    flexBasis : 0,\n    justifyContent: \"flex-start\",\n    alignItems : \"flex-start\",\n    flexWrap : \"wrap\",\n    paddingLeft: 8,\n    paddingRight: 8,\n};\n\nconst ROW_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexDirection : \"row\",\n    flexBasis : 0,\n    alignItems : \"center\",\n};\n\nconst ROW_ELEMENT_STYLE : React.CSSProperties = {\n    flexShrink : 0,\n    flexGrow : 0,\n    minWidth : 24,\n    padding : 4,\n    textAlign : \"right\",\n    alignContent : \"baseline\",\n};\n\nexport function ClassChangeList(props : ClassChangeListProps) : JSX.Element\n{\n    const elements : Array<JSX.Element> = [];\n\n    // Need sorting because keys are in insertion order.\n    const levelsInOrder = Array.from(props.list.keys());\n    levelsInOrder.sort((a, b) => a - b);\n    \n    const reorderedHandler = (l : number, c : Array<CharacterClass>) => {\n        const newList = new Map<number, Array<CharacterClass>>(props.list.entries());\n        newList.set(l, c);\n        props.onReordered(newList);\n    };\n\n    const deletedHandler = (l : number, c : Array<CharacterClass>) => {\n        const newList = new Map<number, Array<CharacterClass>>(props.list.entries());\n        if (c.length > 0)\n        {\n            newList.set(l, c);\n        }\n        else\n        {\n            newList.delete(l);\n        }\n\n        props.onReordered(newList);\n    };\n\n    for (const level of levelsInOrder)\n    {\n        const fixedLevel = level;\n        // Since we're iterating keys we know the Map.get will not return undefined.\n        elements.push(\n        <div style={ROW_STYLE} key={fixedLevel}>\n            <FormLabel style={ROW_ELEMENT_STYLE}>{fixedLevel.toString()}</FormLabel>\n            <ClassChangeSingleLevel\n                classes={props.list.get(level) as Array<CharacterClass>}\n                onReordered={(newClassList) => reorderedHandler(fixedLevel, newClassList)}\n                onDeleted={(newClassList) => deletedHandler(fixedLevel, newClassList)}\n                disabled={fixedLevel < props.minLevel}\n            />\n        </div>);\n    }\n\n    if (elements.length > 0)\n    {\n        return <div style={CONTAINER_STYLE}>\n            {elements}\n        </div>;\n    }\n    else\n    {\n        return <div style={CONTAINER_STYLE}><Chip style={{textAlign: \"left\", margin: 8, userSelect: \"none\"}} label=\"No class changes\" disabled /></div>;\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Button from '@material-ui/core/Button';\nimport React, { useState } from 'react';\nimport { CharacterClass, getClassDisplayName } from '../data/CharacterClass';\nimport { CharacterName, getCharacterDisplayName } from '../data/CharacterName';\nimport { hasClassGeneralData, getEligibleClasses, getRequirementForCharacterAndClass } from '../data/ClassData';\nimport { ClassAndLevelSelector } from './ClassAndLevelSelector';\nimport { ClassChangeList } from './ClassChangeList';\n\ninterface ClassAddWidgetProps\n{\n    // Need this to restrict available classes.\n    character : CharacterName;\n    selectedClass : CharacterClass;\n    selectedLevel : number;\n    minLevel : number;\n\n    onSelectionChanged : (characterClass : CharacterClass, level : number) => void;\n    onAddButtonClicked : (characterClass : CharacterClass, level : number) => void;\n}\n\nconst ClassAddWidgetContainerStyle : React.CSSProperties = {\n    marginTop: 8,\n    marginLeft: 16,\n    display: \"flex\",\n    flexDirection: \"row\",\n    flexBasis: 0,\n    flexWrap: \"nowrap\",\n};\n\nconst ClassAndLevelSelectorStyle : React.CSSProperties = {\n    marginRight: 8,\n    display : \"flex\",\n    flexGrow : 0,\n    flexShrink : 0,\n    alignSelf: \"flex-end\"\n};\n\nconst AddButtonStyle : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow : 0,\n    flexShrink : 0,\n    alignSelf: \"flex-end\"\n\n}\n\nfunction ClassAddWidget(props : ClassAddWidgetProps) : JSX.Element\n{\n    const availableClasses = getEligibleClasses(props.character);\n\n    if (!availableClasses.has(props.selectedClass))\n    {\n        throw new RangeError(`Character ${getCharacterDisplayName(props.character)} isn't eligible for selected class ${getClassDisplayName(props.selectedClass)}`);\n    }\n\n    const classRequirement = getRequirementForCharacterAndClass(props.character, props.selectedClass);\n\n    if (classRequirement === undefined)\n    {\n        throw new RangeError(\"Got undefined class requirements for a known eligible class.\");\n    }\n\n    if (classRequirement.level > props.selectedLevel)\n    {\n        throw new RangeError(`Selected level ${props.selectedLevel} is below minimum level for class, ${classRequirement.level}`);\n    }\n\n    const selectionChangedHandler = (characterClass : CharacterClass, level : number) => {\n        props.onSelectionChanged(characterClass, level);\n    };\n\n    const addClickedHandler = (event : React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n        props.onAddButtonClicked(props.selectedClass, props.selectedLevel);\n    };\n\n    return <div style={ClassAddWidgetContainerStyle}>\n        <ClassAndLevelSelector \n            selectedClass={props.selectedClass} \n            selectedLevel={props.selectedLevel}\n            character={props.character}\n            minLevel={props.minLevel}\n            containerStyle={ClassAndLevelSelectorStyle}\n            onChanged={selectionChangedHandler} />\n        <div style={AddButtonStyle}>\n            <Button id=\"class-change-add-button\" variant=\"outlined\" color=\"primary\" onClick={addClickedHandler}>\n                Add\n            </Button>\n        </div>\n    </div>;\n}\n\nexport interface ClassChangeEditorProps\n{\n    character : CharacterName;\n    classChangeList : Map<number, Array<CharacterClass>>;\n    minLevel : number;\n\n    onClassChangeListChange : (changes : Map<number, Array<CharacterClass>>) => void;\n}\n\ninterface ClassChangeEditorState\n{\n    addWidgetClass : CharacterClass;\n    addWidgetLevel : number;\n}\n\nfunction getClassChangeEditorDefaultState(character : CharacterName) : ClassChangeEditorState\n{\n    const eligibleClasses = Array.from(getEligibleClasses(character))\n        .filter((c) => hasClassGeneralData(c))\n        .sort((a,b) => a - b);\n    \n    if (eligibleClasses.length === 0)\n    {\n        throw new Error(`No viable classes for selected character ${character}`);\n    }\n\n    const defaultClassChoice = eligibleClasses[0];\n    const defaultClassRequirement = getRequirementForCharacterAndClass(character, defaultClassChoice);\n\n    if (defaultClassRequirement === undefined)\n    {\n        throw new RangeError(\"Got undefined class requirements for a known eligible class.\");\n    }\n    \n    return {\n        addWidgetClass : defaultClassChoice,\n        addWidgetLevel : defaultClassRequirement.level\n    };\n}\n\nconst ClassChangeEditorContainerStyle : React.CSSProperties = {\n};\n\nexport function ClassChangeEditor(props : ClassChangeEditorProps) : JSX.Element\n{\n    // Need state to store the class and level selector's state.\n    const [state, setState] = useState(getClassChangeEditorDefaultState(props.character));\n    \n    let immediateStateUpdateNeeded = false;\n\n    const eligibleClasses = getEligibleClasses(props.character);\n    let effectiveClass = state.addWidgetClass;\n    if (!eligibleClasses.has(effectiveClass))\n    {\n        const asArray = Array.from(eligibleClasses);\n\n        if (asArray.length === 0)\n        {\n            throw new Error(\"No eligible classes are selectable for the given character. This is usually an incomplete data error.\");\n        }\n\n        asArray.sort((a, b) => a - b);\n        effectiveClass = asArray[0];\n        immediateStateUpdateNeeded = true;\n    }\n\n    let effectiveLevel = state.addWidgetLevel;\n    const classRequirement = getRequirementForCharacterAndClass(props.character, effectiveClass);\n\n    if (classRequirement === undefined)\n    {\n        throw new RangeError(\"Got undefined class requirements for a known eligible class.\");\n    }\n\n    const requiredLevelForEffectiveClass = classRequirement.level;\n    if (effectiveLevel < requiredLevelForEffectiveClass || effectiveLevel < props.minLevel)\n    {\n        effectiveLevel = Math.max(requiredLevelForEffectiveClass, props.minLevel);\n        immediateStateUpdateNeeded = true;\n    }\n\n    if (immediateStateUpdateNeeded)\n    {\n        setState({\n            addWidgetClass : effectiveClass,\n            addWidgetLevel : effectiveLevel\n        });\n    }\n\n    const addWidgetChangeHandler = async (c : CharacterClass, l : number) => {\n        setState({\n            addWidgetClass : c,\n            addWidgetLevel : l\n        });\n    };\n    const addWidgetConfirmHandler = async (c : CharacterClass, l : number) => {\n        const appendedMap = new Map<number, Array<CharacterClass>>(props.classChangeList.entries());\n        \n        if (appendedMap.has(l))\n        {\n            appendedMap.get(l)?.push(c);\n        }\n        else\n        {\n            appendedMap.set(l, [c]);\n        }\n\n        props.onClassChangeListChange(appendedMap);\n    };\n\n    const classChangeListReorderedHandler = async (classChangeList : Map<number, Array<CharacterClass>>) => {\n        props.onClassChangeListChange(classChangeList);\n    };\n\n    return <div style={ClassChangeEditorContainerStyle}>\n        <ClassChangeList\n            list={props.classChangeList}\n            minLevel={props.minLevel}\n            onReordered={classChangeListReorderedHandler}\n        />\n        <ClassAddWidget\n            character={props.character}\n            minLevel={props.minLevel}\n            selectedClass={effectiveClass}\n            selectedLevel={effectiveLevel}\n            onSelectionChanged={addWidgetChangeHandler}\n            onAddButtonClicked={addWidgetConfirmHandler}\n        />\n    </div>;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport Select from '@material-ui/core/Select';\nimport { CharacterFaction, CharacterName, getCharactersByFaction, getFactionDisplayName, getCharacterDisplayName } from \"../data/CharacterName\";\n\nexport interface CharacterSelectorProps\n{\n    value : CharacterName;\n    onSelected : (character : CharacterName) => void;\n    availableCharacters? : Set<CharacterName>;\n    containerStyle? : React.CSSProperties;\n}\n\nconst CharacterNameList = new Map<CharacterName, string>();\n(() => \n{\n    for (let i = 0; i < CharacterName.End.valueOf(); i++)\n    {\n        const character = i as CharacterName;\n        CharacterNameList.set(character, getCharacterDisplayName(character));\n    }\n})();\n\ntype SelectChangedEvent = React.ChangeEvent<{name?: string, value: unknown}>;\n\nexport function CharacterSelector(props : CharacterSelectorProps) : JSX.Element\n{\n    const characterEntries = new Array<JSX.Element>();\n    for (let f = 0; f < CharacterFaction.End; f++)\n    {\n        const faction = f as CharacterFaction;\n        const entriesInFaction : Array<JSX.Element> = [];\n        getCharactersByFaction(faction).forEach((character) => {\n            if (props.availableCharacters === undefined || props.availableCharacters.has(character))\n            {\n                entriesInFaction.push(<option value={character.valueOf()} key={character.valueOf()}>{getCharacterDisplayName(character)}</option>);\n            }\n        })\n        if (entriesInFaction.length > 0)\n        {\n            characterEntries.push(<optgroup label={getFactionDisplayName(faction)} key={faction}>{entriesInFaction}</optgroup>);\n        }\n    }\n\n    const handler = async (event : SelectChangedEvent, child?: React.ReactNode) => {\n        const selected = parseInt((event.target.value as any).toString());\n        props?.onSelected(selected);\n    };\n\n    return (\n    <div style={props.containerStyle}>\n        <FormControl>\n            <InputLabel htmlFor=\"character-selector-field\">Character</InputLabel>\n            <Select native value={props.value} onChange={handler}>\n                {characterEntries}\n            </Select>\n        </FormControl>\n    </div>);\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { StatArray } from \"../sim/StatArray\";\nimport { CharacterClass, getClassDisplayName } from \"./CharacterClass\";\nimport { getCharacterInitialPresets } from \"./CharacterData\";\nimport { CharacterName } from \"./CharacterName\";\nimport { CharacterInitialData } from \"./CharacterPresets\";\n\n\nexport interface InitialStats\n{\n    character : CharacterName;\n    class : CharacterClass;\n    level : number;\n    // Presumes stats are with class bonuses taken into account.\n    // e.g. you should be able to copy off the character sheet in game\n    // and it should interpret correctly.\n    stats : StatArray;\n}\n\nexport interface Preset\n{\n    index : number;\n    displayName : string;\n    stats : InitialStats;\n}\n\nexport interface PresetsBundle\n{\n    getCharacterList : () => Set<CharacterName>;\n    getPresetsForCharacter : (character : CharacterName) => Array<Preset>;\n};\n\nfunction getPresetDisplayName(characterName : CharacterName, initialData : CharacterInitialData) : string\n{\n    if (initialData.title !== undefined)\n    {\n        return `${initialData.title} (lvl ${initialData.level} ${getClassDisplayName(initialData.class)})`;\n    }\n    else\n    {\n        return `lvl ${initialData.level} ${getClassDisplayName(initialData.class)}`;\n    }\n}\n\nfunction computePresets() : Map<CharacterName, Preset[]>\n{\n    const presetMap = new Map<CharacterName, Array<Preset>>();\n\n    for (let i = 0; i < CharacterName.End; i++)\n    {\n        const characterName = i as CharacterName;\n\n        const presets : Preset[] = getCharacterInitialPresets(characterName).map((initialData, index) => {\n            return {\n                index,\n                displayName: getPresetDisplayName(characterName, initialData),\n                stats: {\n                    character: characterName,\n                    class: initialData.class,\n                    level: initialData.level,\n                    stats : initialData.stats\n                }\n            };\n        });\n\n        if (presets.length > 0)\n        {\n            presetMap.set(characterName, presets);\n        }\n    }\n\n    return presetMap;\n}\n\nclass PresetsBundleImpl implements PresetsBundle\n{\n    private presetLookup : Map<CharacterName, Array<Preset>>;\n\n    constructor()\n    {\n        this.presetLookup = computePresets();\n    }\n\n    public getCharacterList() : Set<CharacterName>\n    {\n        return new Set(this.presetLookup.keys());\n    }\n\n    public getPresetsForCharacter(character : CharacterName) : Array<Preset>\n    {\n        const result = this.presetLookup.get(character);\n        \n        if (result === undefined)\n        {\n            return [];\n        }\n        else\n        {\n            return result;\n        }\n    }\n}\n\nlet bundleInstance : PresetsBundleImpl | undefined;\n\nfunction initializePresetsBundleImpl()\n{\n    bundleInstance = new PresetsBundleImpl();\n}\n\nexport function loadInitialStatsPresets() : PresetsBundle\n{\n    if (bundleInstance === undefined)\n    {\n        initializePresetsBundleImpl();\n    }\n\n    return bundleInstance as PresetsBundle;\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { CharacterName } from '../data/CharacterName';\nimport { InitialStats, loadInitialStatsPresets, Preset, PresetsBundle } from '../data/CharacterPresetLoader';\nimport { CharacterSelector } from './CharacterSelector';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport { getClassDisplayName } from '../data/CharacterClass';\nimport { forEachStatIndex, getCanonicalStatNameByIndex } from '../sim/StatArray';\nimport Typography from '@material-ui/core/Typography';\n\nexport interface InitialStatPresetDialogProps\n{\n    open : boolean;\n    defaultCharacter : CharacterName;\n    onCancelled : () => void;\n    onSelected : (loadedStats : InitialStats) => void;\n}\n\nexport interface PresetSelectorProps\n{\n    selectedIndex : number;\n    onSelected : (index : number) => void;\n    availablePresets : Preset[];\n}\n\nexport interface PresetDisplayProps\n{\n    value : InitialStats\n}\n\nfunction getStatBundle(character : CharacterName, index : number) : InitialStats | undefined\n{\n    // Pull a lazy-initialized list of presets\n    const AvailablePresets : PresetsBundle = loadInitialStatsPresets();\n\n    const presets = AvailablePresets.getPresetsForCharacter(character);\n    if (presets.length > index)\n    {\n        return AvailablePresets.getPresetsForCharacter(character)[index].stats;\n    }\n    else\n    {\n        return undefined;\n    }\n}\n\ntype SelectChangedEvent = React.ChangeEvent<{name?: string, value: unknown}>;\n\nexport function PresetSelector(props : PresetSelectorProps) : JSX.Element\n{\n    const handler = (event : SelectChangedEvent, child?: React.ReactNode) => {\n        const selected = parseInt((event.target.value as any).toString());\n        props.onSelected(selected);\n    };\n\n    const presetEntries : JSX.Element[] = props.availablePresets.map((preset : Preset) => {\n        return <option value={preset.index} key={preset.index}>{preset.displayName}</option>;\n    });\n\n    return (\n        <FormControl style={{marginTop: 16, marginBottom: 16}}>\n            <InputLabel htmlFor=\"character-selector-field\">Preset</InputLabel>\n            <Select native value={props.selectedIndex} onChange={handler}>\n                {presetEntries}\n            </Select>\n        </FormControl>);\n}\n\nconst PresetDisplayRowStyle : React.CSSProperties = {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-start',\n    marginTop: 8,\n    marginBottom: 8\n};\n\nconst PresetDisplayElementStyle : React.CSSProperties = {\n    flexBasis: 'auto',\n    flexGrow: 0,\n    flexShrink: 0,\n    marginRight: 12,\n    marginTop: 8,\n    marginBottom: 8,\n    minWidth: 32\n};\n\nconst PresetDisplayLabelStyle : React.CSSProperties = {\n};\n\nconst PresetDisplayValueStyle : React.CSSProperties = {\n    //fontWeight: 'normal'\n    fontWeight: 'bold',\n    opacity: 0.8\n};\n\nexport function PresetDisplay(props : PresetDisplayProps) : JSX.Element\n{\n    return (\n        <div>\n            <div style={PresetDisplayRowStyle}>\n                <div style={PresetDisplayElementStyle}>\n                    <Typography variant='body1' style={PresetDisplayLabelStyle}>Level</Typography>\n                    <Typography variant='body1' style={PresetDisplayValueStyle}>{props.value.level}</Typography>\n                </div>\n                <div style={PresetDisplayElementStyle}>\n                    <Typography variant='body1' style={PresetDisplayLabelStyle}>Class</Typography>\n                    <Typography variant='body1' style={PresetDisplayValueStyle}>{getClassDisplayName(props.value.class)}</Typography>\n                </div>\n            </div>\n            <div style={PresetDisplayRowStyle}>\n                {\n                    forEachStatIndex((index : number) => {\n                        const statDisplayName = getCanonicalStatNameByIndex(index);\n                        return (\n                            <div style={PresetDisplayElementStyle} key={`preset_stat_${getCanonicalStatNameByIndex(index)}`}>\n                                <Typography variant='body1' style={PresetDisplayLabelStyle}>{statDisplayName}</Typography>\n                                <Typography variant='body1' style={PresetDisplayValueStyle}>{props.value.stats[index]}</Typography>\n                            </div>\n                        );\n                    })\n                }\n            </div>\n        </div>\n    );\n}\n\nexport interface InitialStatPresetDialogState\n{\n    selectedCharacter : CharacterName;\n    selectedPresetIndex : number;\n}\n\nexport class InitialStatPresetDialog extends React.Component<InitialStatPresetDialogProps, InitialStatPresetDialogState>\n{\n    public constructor(props : InitialStatPresetDialogProps)\n    {\n        super(props);\n\n        this.state = {\n            selectedCharacter : props.defaultCharacter,\n            selectedPresetIndex: 0\n        };\n    }\n\n    public componentDidUpdate(prevProps : InitialStatPresetDialogProps, prevState : InitialStatPresetDialogState)\n    {\n        if (prevProps.defaultCharacter !== this.props.defaultCharacter)\n        {\n            this.setState({\n                selectedCharacter : this.props.defaultCharacter,\n                selectedPresetIndex : 0\n            });\n        }\n    }\n\n    public render() : JSX.Element\n    {\n        // Pull a lazy-initialized list of presets\n        const AvailablePresets : PresetsBundle = loadInitialStatsPresets();\n\n        const presetsForSelectedCharacter = AvailablePresets.getPresetsForCharacter(this.state.selectedCharacter);\n        const selectedPreset = getStatBundle(this.state.selectedCharacter, this.state.selectedPresetIndex);\n\n        const onPresetSelected = () => {\n            if (selectedPreset !== undefined)\n            {\n                this.props.onSelected(selectedPreset as InitialStats);\n            }\n        };\n    \n        const onCharacterChange = (newCharacterSelection : CharacterName) => {\n            this.setState({\n                selectedCharacter: newCharacterSelection,\n                selectedPresetIndex: 0\n            });\n        };\n    \n        const onPresetIndexSelected = (newIndexSelection : number) => {\n            this.setState({\n                selectedCharacter: this.state.selectedCharacter,\n                selectedPresetIndex: newIndexSelection\n            })\n        };\n\n        // TODO: Factor null preset into preset selector and preset display to make UI size consistent.\n        const presetSelectionDisplay : JSX.Element | null = selectedPreset === undefined\n            ?   <>\n                    <Typography variant=\"body1\" style={{marginTop: 16}}>No available presets.</Typography>\n                </>\n            :   <>\n                    <PresetSelector \n                        selectedIndex={this.state.selectedPresetIndex}\n                        onSelected={(index : number) => onPresetIndexSelected(index)}\n                        availablePresets={presetsForSelectedCharacter}/>\n                    <PresetDisplay value={selectedPreset}/>\n                </>;\n\n        const selectableCharacters = AvailablePresets.getCharacterList();\n        if (!selectableCharacters.has(this.state.selectedCharacter))\n        {\n            selectableCharacters.add(this.state.selectedCharacter);\n        }\n\n        return (\n            <Dialog open={this.props.open} onClose={() => this.props.onCancelled()}>\n                <DialogTitle>\n                    Common Starting Stats\n                </DialogTitle>\n                <DialogContent>\n                    <CharacterSelector\n                        value={this.state.selectedCharacter} \n                        onSelected={(c : CharacterName) => onCharacterChange(c)}\n                        availableCharacters={selectableCharacters}/>\n                    {presetSelectionDisplay}\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={() => this.props.onCancelled()} color=\"default\">Cancel</Button>\n                    <Button onClick={() => onPresetSelected()} color=\"primary\" disabled={selectedPreset === undefined}>Load Stats</Button>\n                </DialogActions>\n            </Dialog>\n        );\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from 'react';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\n\nimport { CharacterClass } from '../data/CharacterClass';\nimport { getCharacterMaxBaseStats, getCharactersWithDefinedData, StatLimitMods } from '../data/CharacterData';\nimport { CharacterName } from '../data/CharacterName';\nimport { getClassGeneralData, hasClassGeneralData, getEligibleClasses, getRequirementForCharacterAndClass } from '../data/ClassData';\nimport { addStats, forEachStatV, StatArray, statsMax, statsMin, zeroStats } from '../sim/StatArray';\nimport { CharacterSelector } from './CharacterSelector';\nimport { ClassAndLevelSelector } from './ClassAndLevelSelector';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Button from '@material-ui/core/Button';\nimport { InitialStatPresetDialog } from './InitialStatPresetDialog';\nimport { InitialStats } from '../data/CharacterPresetLoader';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nexport interface StatArraySelectorProps\n{\n    value : StatArray;\n    minimums : StatArray;\n    maximums : StatArray;\n    onChanged : (stat : StatArray) => void;\n    containerStyle? : React.CSSProperties;\n    elementStyle? : React.CSSProperties;\n}\n\n/*\nexport const iHP =  0;\nexport const iSTR = 1;\nexport const iMAG = 2;\nexport const iDEX = 3;\nexport const iSPD = 4;\nexport const iLCK = 5;\nexport const iDEF = 6;\nexport const iRES = 7;\nexport const iCHA = 8;\n*/\nconst STAT_NAME_LIST = [\"Hp\", \"Str\", \"Mag\", \"Dex\", \"Spd\", \"Lck\", \"Def\", \"Res\", \"Cha\"];\n\nexport function StatArraySelector(props : StatArraySelectorProps) : JSX.Element\n{\n    const elements : Array<JSX.Element> = [];\n\n    const style : React.CSSProperties = {...props.containerStyle};\n\n    function inputChanged(index : number, value : number)\n    {\n        const newStats : StatArray = [...props.value];\n        newStats[index] = value;\n        props.onChanged(newStats);\n    }\n    \n    forEachStatV(props.value, (stat : number, index : number) => {\n        const savedIndex = index;\n        const id = `${STAT_NAME_LIST[index]}-input`;\n        elements.push(\n            <div style={props.elementStyle} key={index}>\n                <FormControl>\n                    <InputLabel htmlFor={id}>{STAT_NAME_LIST[index]}</InputLabel>\n                    <Input id={id} type=\"number\" value={stat} \n                        inputProps={{ min: props.minimums[index], max: props.maximums[index]}} \n                        onChange={(event) => {inputChanged(savedIndex, parseInt(event.target.value))}}/>\n                </FormControl>\n            </div>\n        );\n    });\n\n    return <div style={style}>\n        {elements}\n    </div>;\n}\n\nexport interface InitialStatsEditorProps extends InitialStats\n{\n    maxStatMods? : StatLimitMods;\n    handler : (value : InitialStats) => void;\n}\n\nfunction reconcile(character : CharacterName, characterClass : CharacterClass, \n    level : number, stats : StatArray, statMaxMods? : StatLimitMods)\n{\n    let reconciled : InitialStats = {\n        character : character,\n        class : characterClass,\n        level : level,\n        stats : stats\n    };\n\n    // Step 1: enforce that the class chosen is valid for the character, else default to first valid class.\n    const validClasses = getEligibleClasses(reconciled.character);\n    if (!validClasses.has(reconciled.class))\n    {\n        if (validClasses.size === 0)\n        {\n            throw new Error(\"Character has no valid classes. This is a data error.\");\n        }\n\n        // Grab first one\n        for (const c of validClasses)\n        {\n            reconciled.class = c;\n            break;\n        }\n    }\n\n    // Step 2: if class level min is low, bump the level.\n    const specificRequirement = getRequirementForCharacterAndClass(character, reconciled.class);\n    // Should always be defined because of the eligible classes check earlier.\n    if (specificRequirement === undefined)\n    {\n        throw new RangeError(\"Used ineligible class in initial stats reconciliation.\");\n    }\n    const minLevel = specificRequirement.level;\n\n    if (reconciled.level < minLevel)\n    {\n        reconciled.level = minLevel;\n    }\n\n    // Step 3: If stats are below class baselines, clamp stats up. \n    // If stats are above character maximum, clamp stats down.\n    const classBaseStats = getClassGeneralData(reconciled.class).baseStats;\n    const characterMaxStats = getCharacterMaxBaseStats(character, statMaxMods);\n    reconciled.stats = statsMax(classBaseStats, reconciled.stats);\n    reconciled.stats = statsMin(characterMaxStats, reconciled.stats);\n\n    return reconciled;\n}\n\nconst OUTER_LAYOUT : React.CSSProperties = {\n    display : \"flex\",\n    flexDirection : \"row\",\n    flexBasis : 0,\n    flexWrap : \"nowrap\",\n    alignItems : \"stretch\",\n    padding: 8,\n}\n\n// const THUMBNAIL_LAYOUT : React.CSSProperties = {\n//     display : \"block\",\n//     flexGrow : 0,\n//     flexShrink : 0\n// }\n\nconst FORM_CONTAINER_LAYOUT : React.CSSProperties = {\n    display : \"flex\",\n    flexDirection : \"column\",\n    flexBasis : \"auto\",\n    flexWrap : \"nowrap\",\n    flexGrow : 1,\n    flexShrink : 1,\n    marginLeft: 8,\n};\n\nconst INNER_ROW_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow : 0,\n    flexShrink : 0,\n    flexDirection: \"column\",\n    alignItems: \"flex-start\",\n    alignContent: \"flex-start\",\n    justifyContent: 'stretch'\n};\n\nconst CHARACTER_IDENTITY_LAYOUT : React.CSSProperties = {\n    display : \"flex\",\n    flexDirection : \"row\",\n    flexBasis : 0,\n    flexGrow: 1,\n    flexShrink: 0,\n    width: '100%'\n};\n\nconst CHARACTER_SELECTOR_STYLE : React.CSSProperties = {\n    display : \"block\",\n    flexGrow : 0,\n    flexShrink : 0,\n};\n\nconst CLASS_AND_LEVEL_SELECTOR_STYLE : React.CSSProperties = {\n    display : \"block\",\n    flexGrow : 0,\n    flexShrink : 0,\n};\n\nconst PRESET_BUTTON_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow : 1,\n    flexShrink : 0,\n    flexDirection: 'row',\n    justifyContent: 'flex-end'\n};\n\nconst STAT_ARRAY_SELECTOR_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow: 0,\n    flexShrink: 0,\n    flexDirection : \"row\",\n    flexBasis : 0,\n    flexWrap : \"wrap\",\n    justifyContent: \"flex-start\",\n};\n\nconst STAT_ARRAY_ELEMENT_STYLE : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow : 0,\n    flexShrink : 0,\n};\n\nexport function InitialStatsEditor(props : InitialStatsEditorProps) : JSX.Element\n{\n    // Index 0 as default\n    const [presetDialogOpen, setPresetDialogOpen] = React.useState<boolean>(false);\n    //const [presetCharacter, setPresetCharacter] = React.useState<CharacterName>(props.character);\n\n    const showPresetDialog = () => {\n        setPresetDialogOpen(true);\n    };\n\n    let minLevel = 1;\n    let statMinumums = zeroStats();\n    let bonusStats = zeroStats();\n    if (hasClassGeneralData(props.class))\n    {\n        const classData = getClassGeneralData(props.class);\n        bonusStats = classData.bonusStats;\n        statMinumums = addStats(classData.baseStats, classData.bonusStats);\n    }\n\n    const specificRequirement = getRequirementForCharacterAndClass(props.character, props.class);\n    if (specificRequirement !== undefined)\n    {\n        minLevel = specificRequirement.level;\n    }\n\n    const characterMaxStats = addStats(getCharacterMaxBaseStats(props.character, props.maxStatMods), bonusStats);\n\n    const _character_handler = (character : CharacterName) =>\n    {\n        //setPresetCharacter(character);\n        props.handler(reconcile(character, props.class, props.level, props.stats, props.maxStatMods));\n    }\n\n    const _class_and_level_handler = (c : CharacterClass, l : number) =>\n    {\n        props.handler(reconcile(props.character, c, l, props.stats, props.maxStatMods));\n    }\n\n    const _stat_handler = (stats : StatArray) =>\n    {\n        // Undo effect of class bonus stats\n        props.handler(reconcile(props.character, props.class, props.level, stats, props.maxStatMods));\n    }\n\n    const _on_preset_dialog_cancelled = () => {\n        setPresetDialogOpen(false);\n    }\n\n    const on_preset_stats_selected = (statBundle : InitialStats) =>\n    {\n        setPresetDialogOpen(false);\n        props.handler(reconcile(statBundle.character, statBundle.class, statBundle.level, statBundle.stats, props.maxStatMods));\n    }\n\n    const dialog = <InitialStatPresetDialog \n                        open={presetDialogOpen} \n                        defaultCharacter={props.character}\n                        onCancelled={_on_preset_dialog_cancelled}\n                        onSelected={on_preset_stats_selected}/>;\n\n    //<CharacterThumbnail character={props.character} width={THUMBNAIL_WIDTH} height={THUMBNAIL_HEIGHT} style={THUMBNAIL_LAYOUT}/>\n    return (\n        <div style={OUTER_LAYOUT}>\n            <div style={FORM_CONTAINER_LAYOUT}>\n                <div style={INNER_ROW_STYLE}>\n                    <FormLabel style={{textAlign: 'left', marginBottom: 8}}>Initial Stats</FormLabel>\n                    <FormGroup style={{...CHARACTER_IDENTITY_LAYOUT, marginBottom: 8}}>\n                        <CharacterSelector \n                            value={props.character} \n                            onSelected={_character_handler} \n                            containerStyle={CHARACTER_SELECTOR_STYLE} \n                            availableCharacters={getCharactersWithDefinedData()}/>\n                        <ClassAndLevelSelector \n                            selectedClass={props.class} \n                            selectedLevel={props.level} \n                            character={props.character}\n                            minLevel={minLevel}\n                            maxLevel={99}\n                            onChanged={_class_and_level_handler} \n                            containerStyle={CLASS_AND_LEVEL_SELECTOR_STYLE}/>\n                        <div style={PRESET_BUTTON_STYLE}>\n                            <FormControl>\n                                <FormLabel>&nbsp;</FormLabel>\n                                <Tooltip title=\"Look up and use well-known stats for the character, such as their level 1 stats, or stats when you recruit them at a specific chapter.\">\n                                    <Button variant=\"outlined\" color=\"primary\" onClick={() => showPresetDialog()} \n                                        style={{marginTop: -4, flexGrow: 0, flexShrink: 0}}>\n                                        Look Up Stats\n                                    </Button>\n                                </Tooltip>\n                            </FormControl>\n                        </div>\n                    </FormGroup>\n                </div>\n                {dialog}\n                <div style={INNER_ROW_STYLE}>\n                    <StatArraySelector\n                        value={props.stats} \n                        minimums={statMinumums} \n                        maximums={characterMaxStats} \n                        onChanged={_stat_handler} \n                        containerStyle={STAT_ARRAY_SELECTOR_STYLE}\n                        elementStyle={STAT_ARRAY_ELEMENT_STYLE}/>\n                </div>\n            </div>\n        </div>\n    );\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport React from 'react';\nimport { StatLimitMods } from '../data/CharacterData';\n\nexport interface MaxStatLimitModEditorProps\n{\n    status : StatLimitMods;\n    onChanged : (status : StatLimitMods) => void;\n    containerStyle? : React.CSSProperties\n}\n\nconst CONTAINER_STYLE : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-start\",\n    alignContent: \"flex-start\",\n};\n\n// Widget for selecting max stat limits. \nexport function MaxStatLimitModEditor(props : MaxStatLimitModEditorProps) : JSX.Element\n{\n    const _stats_changed = (strAndSpd? : boolean, lckAndCha? : boolean, magAndDex? : boolean, defAndRes? : boolean) => {\n        const newStatuses : StatLimitMods = {\n            ...props.status\n        };\n\n        if (strAndSpd !== undefined)\n        {\n            newStatuses.StrAndSpdUp = strAndSpd;\n        }\n\n        if (lckAndCha !== undefined)\n        {\n            newStatuses.LckAndChaUp = lckAndCha;\n        }\n\n        if (magAndDex !== undefined)\n        {\n            newStatuses.MagAndDexUp = magAndDex;\n        }\n\n        if (defAndRes !== undefined)\n        {\n            newStatuses.DefAndResUp = defAndRes;\n        }\n\n        props.onChanged(newStatuses);\n    };\n\n    return (\n    <div style={{...CONTAINER_STYLE, ...props.containerStyle}}>\n        <FormGroup row>\n            <Tooltip title=\"Statue of Saint Cichol remodeling bonus\">\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={props.status.StrAndSpdUp}\n                            onChange={(event) => _stats_changed(event.target.checked, undefined, undefined, undefined)}\n                            name=\"Cichol\"\n                            color=\"primary\"\n                        />\n                    \n                    }\n                    label=\"+5 max Str &amp; Spd\"\n                    style={{userSelect: \"none\"}}\n                />\n            </Tooltip>\n            <Tooltip title=\"Statue of Saint Cethleann remodeling bonus\">\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={props.status.LckAndChaUp}\n                            onChange={(event) => _stats_changed(undefined, event.target.checked, undefined, undefined)}\n                            name=\"Cethleann\"\n                            color=\"primary\"\n                        />\n                    }\n                    label=\"+5 max Lck &amp; Cha\"\n                    style={{userSelect: \"none\"}}\n                />\n            </Tooltip>\n            <Tooltip title=\"Statue of Saint Macuil remodeling bonus\">\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={props.status.MagAndDexUp}\n                            onChange={(event) => _stats_changed(undefined, undefined, event.target.checked, undefined)}\n                            name=\"Macuil\"\n                            color=\"primary\"\n                        />\n                    }\n                    label=\"+5 max Mag &amp; Dex\"\n                    style={{userSelect: \"none\"}}\n                />\n            </Tooltip>\n            <Tooltip title=\"Statue of Saint Indech remodeling bonus\">\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={props.status.DefAndResUp}\n                            onChange={(event) => _stats_changed(undefined, undefined, undefined, event.target.checked)}\n                            name=\"Indech\"\n                            color=\"primary\"\n                        />\n                    }\n                    label=\"+5 max Def &amp; Res\"\n                    style={{userSelect: \"none\"}}\n                />\n            </Tooltip>\n        </FormGroup>\n    </div>);\n}","export default __webpack_public_path__ + \"static/media/bylethmale_1.dcbce08e.png\";","export default __webpack_public_path__ + \"static/media/bylethmale_2.5da0cd23.png\";","export default __webpack_public_path__ + \"static/media/bylethfemale_1.b3dc503c.png\";","export default __webpack_public_path__ + \"static/media/bylethfemale_2.65bf08cd.png\";","export default __webpack_public_path__ + \"static/media/edelgard_1.26fb14c9.png\";","export default __webpack_public_path__ + \"static/media/edelgard_2.2decafcd.png\";","export default __webpack_public_path__ + \"static/media/hubert_1.9893f7cb.png\";","export default __webpack_public_path__ + \"static/media/hubert_2.24696f37.png\";","export default __webpack_public_path__ + \"static/media/dorothea_1.352f3ff9.png\";","export default __webpack_public_path__ + \"static/media/dorothea_2.e5489f82.png\";","export default __webpack_public_path__ + \"static/media/ferdinand_1.e01d4ba9.png\";","export default __webpack_public_path__ + \"static/media/ferdinand_2.c7c3faf7.png\";","export default __webpack_public_path__ + \"static/media/bernadetta_1.ddf72e60.png\";","export default __webpack_public_path__ + \"static/media/bernadetta_2.10f143c3.png\";","export default __webpack_public_path__ + \"static/media/caspar_1.93657d32.png\";","export default __webpack_public_path__ + \"static/media/caspar_2.28e64f72.png\";","export default __webpack_public_path__ + \"static/media/petra_1.e3cbabac.png\";","export default __webpack_public_path__ + \"static/media/petra_2.c19d7269.png\";","export default __webpack_public_path__ + \"static/media/linhardt_1.69aeaf85.png\";","export default __webpack_public_path__ + \"static/media/linhardt_2.fb420237.png\";","export default __webpack_public_path__ + \"static/media/dimitri_1.907277ab.png\";","export default __webpack_public_path__ + \"static/media/dimitri_2.e2bcb3c7.png\";","export default __webpack_public_path__ + \"static/media/dedue_1.e8c7a0f8.png\";","export default __webpack_public_path__ + \"static/media/dedue_2.b7d7355d.png\";","export default __webpack_public_path__ + \"static/media/felix_1.e12a41a1.png\";","export default __webpack_public_path__ + \"static/media/felix_2.65a4d1f4.png\";","export default __webpack_public_path__ + \"static/media/mercedes_1.709dd8b7.png\";","export default __webpack_public_path__ + \"static/media/mercedes_2.bc01280d.png\";","export default __webpack_public_path__ + \"static/media/ashe_1.fca8630b.png\";","export default __webpack_public_path__ + \"static/media/ashe_2.d20edd16.png\";","export default __webpack_public_path__ + \"static/media/annette_1.d3ba9d78.png\";","export default __webpack_public_path__ + \"static/media/annette_2.da8a9b4a.png\";","export default __webpack_public_path__ + \"static/media/sylvain_1.f3b46f75.png\";","export default __webpack_public_path__ + \"static/media/sylvain_2.89ab047e.png\";","export default __webpack_public_path__ + \"static/media/ingrid_1.95bc8e73.png\";","export default __webpack_public_path__ + \"static/media/ingrid_2.7c022ae4.png\";","export default __webpack_public_path__ + \"static/media/claude_1.4b3e024c.png\";","export default __webpack_public_path__ + \"static/media/claude_2.df1f23e8.png\";","export default __webpack_public_path__ + \"static/media/lorenz_1.f484a3aa.png\";","export default __webpack_public_path__ + \"static/media/lorenz_2.222990e5.png\";","export default __webpack_public_path__ + \"static/media/hilda_1.bb26c611.png\";","export default __webpack_public_path__ + \"static/media/hilda_2.379c72e2.png\";","export default __webpack_public_path__ + \"static/media/raphael_1.8747c879.png\";","export default __webpack_public_path__ + \"static/media/raphael_2.6d6dada6.png\";","export default __webpack_public_path__ + \"static/media/lysithea_1.6b24a6ef.png\";","export default __webpack_public_path__ + \"static/media/lysithea_2.320cc103.png\";","export default __webpack_public_path__ + \"static/media/ignatz_1.2e0562da.png\";","export default __webpack_public_path__ + \"static/media/ignatz_2.b275e8de.png\";","export default __webpack_public_path__ + \"static/media/marianne_1.1ea600fd.png\";","export default __webpack_public_path__ + \"static/media/marianne_2.15831648.png\";","export default __webpack_public_path__ + \"static/media/leonie_1.9910f22f.png\";","export default __webpack_public_path__ + \"static/media/leonie_2.c962826c.png\";","export default __webpack_public_path__ + \"static/media/manuela_1.053891f6.png\";","export default __webpack_public_path__ + \"static/media/hanneman_1.02c3f41e.png\";","export default __webpack_public_path__ + \"static/media/seteth_1.7bdc9131.png\";","export default __webpack_public_path__ + \"static/media/flayn_1.bce536a4.png\";","export default __webpack_public_path__ + \"static/media/cyril_1.c43556db.png\";","export default __webpack_public_path__ + \"static/media/cyril_2.e825af61.png\";","export default __webpack_public_path__ + \"static/media/catherine_1.3fbec75f.png\";","export default __webpack_public_path__ + \"static/media/alois_1.f5e800a6.png\";","export default __webpack_public_path__ + \"static/media/gilbert_1.a4257950.png\";","export default __webpack_public_path__ + \"static/media/shamir_1.19abf07a.png\";","export default __webpack_public_path__ + \"static/media/yuri_1.45c218f6.png\";","export default __webpack_public_path__ + \"static/media/yuri_2.8e6fa80a.png\";","export default __webpack_public_path__ + \"static/media/balthus_1.ae180c53.png\";","export default __webpack_public_path__ + \"static/media/balthus_2.da597aed.png\";","export default __webpack_public_path__ + \"static/media/constance_1.a471a139.png\";","export default __webpack_public_path__ + \"static/media/constance_2.7f4e17b9.png\";","export default __webpack_public_path__ + \"static/media/hapi_1.6fcb97c1.png\";","export default __webpack_public_path__ + \"static/media/hapi_2.f0cc7395.png\";","export default __webpack_public_path__ + \"static/media/jeritza_1.001e5681.png\";","export default __webpack_public_path__ + \"static/media/anna_1.6172a297.png\";","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterName } from \"./CharacterName\";\n\n// Byleths\nimport BylethMale_Pre from '../images/bylethmale_1.png';\nimport BylethMale_Post from '../images/bylethmale_2.png';\nimport BylethFemale_Pre from '../images/bylethfemale_1.png';\nimport BylethFemale_Post from '../images/bylethfemale_2.png';\n\n// Black Eagles\nimport Edelgard_Pre from '../images/edelgard_1.png';\nimport Edelgard_Post from '../images/edelgard_2.png';\nimport Hubert_Pre from '../images/hubert_1.png';\nimport Hubert_Post from '../images/hubert_2.png';\nimport Dorothea_Pre from '../images/dorothea_1.png';\nimport Dorothea_Post from '../images/dorothea_2.png';\nimport Ferdinand_Pre from '../images/ferdinand_1.png';\nimport Ferdinand_Post from '../images/ferdinand_2.png';\nimport Bernadetta_Pre from '../images/bernadetta_1.png';\nimport Bernadetta_Post from '../images/bernadetta_2.png';\nimport Caspar_Pre from '../images/caspar_1.png';\nimport Caspar_Post from '../images/caspar_2.png';\nimport Petra_Pre from '../images/petra_1.png';\nimport Petra_Post from '../images/petra_2.png';\nimport Linhardt_Pre from '../images/linhardt_1.png';\nimport Linhardt_Post from '../images/linhardt_2.png';\n\n\n// Blue Lions\nimport Dimitri_Pre from '../images/dimitri_1.png';\nimport Dimitri_Post from '../images/dimitri_2.png';\nimport Dedue_Pre from '../images/dedue_1.png';\nimport Dedue_Post from '../images/dedue_2.png';\nimport Felix_Pre from '../images/felix_1.png';\nimport Felix_Post from '../images/felix_2.png';\nimport Mercedes_Pre from '../images/mercedes_1.png';\nimport Mercedes_Post from '../images/mercedes_2.png';\nimport Ashe_Pre from '../images/ashe_1.png';\nimport Ashe_Post from '../images/ashe_2.png';\nimport Annette_Pre from '../images/annette_1.png';\nimport Annette_Post from '../images/annette_2.png';\nimport Sylvain_Pre from '../images/sylvain_1.png';\nimport Sylvain_Post from '../images/sylvain_2.png';\nimport Ingrid_Pre from '../images/ingrid_1.png';\nimport Ingrid_Post from '../images/ingrid_2.png';\n\n// Golden Deer\nimport Claude_Pre from '../images/claude_1.png';\nimport Claude_Post from '../images/claude_2.png';\nimport Lorenz_Pre from '../images/lorenz_1.png';\nimport Lorenz_Post from '../images/lorenz_2.png';\nimport Hilda_Pre from '../images/hilda_1.png';\nimport Hilda_Post from '../images/hilda_2.png';\nimport Raphael_Pre from '../images/raphael_1.png';\nimport Raphael_Post from '../images/raphael_2.png';\nimport Lysithea_Pre from '../images/lysithea_1.png';\nimport Lysithea_Post from '../images/lysithea_2.png';\nimport Ignatz_Pre from '../images/ignatz_1.png';\nimport Ignatz_Post from '../images/ignatz_2.png';\nimport Marianne_Pre from '../images/marianne_1.png';\nimport Marianne_Post from '../images/marianne_2.png';\nimport Leonie_Pre from '../images/leonie_1.png';\nimport Leonie_Post from '../images/leonie_2.png';\n\n// Church\nimport Manuela from '../images/manuela_1.png';\t\nimport Hanneman from '../images/hanneman_1.png';\t\nimport Seteth from '../images/seteth_1.png';\t\nimport Flayn from '../images/flayn_1.png';\t\nimport Cyril_Pre from '../images/cyril_1.png';\nimport Cyril_Post from '../images/cyril_2.png';\nimport Catherine from '../images/catherine_1.png';\t\nimport Alois from '../images/alois_1.png';\t\nimport Gilbert from '../images/gilbert_1.png';\t\nimport Shamir from '../images/shamir_1.png';\t\n\n// Ashen Wolves\nimport Yuri_Pre from '../images/yuri_1.png';\nimport Yuri_Post from '../images/yuri_2.png';\nimport Balthus_Pre from '../images/balthus_1.png';\nimport Balthus_Post from '../images/balthus_2.png';\nimport Constance_Pre from '../images/constance_1.png';\nimport Constance_Post from '../images/constance_2.png';\nimport Hapi_Pre from '../images/hapi_1.png';\nimport Hapi_Post from '../images/hapi_2.png';\n\n// Other\nimport Jeritza from '../images/jeritza_1.png';\nimport Anna from '../images/anna_1.png';\n\nexport interface CharacterThumbnailProps\n{\n    character : CharacterName;\n    // before/after timeskip?\n    timeskip : boolean;\n    width : number;\n    height : number;\n    style? : React.CSSProperties;\n}\n\ntype ImgPath = string;\n\ninterface ThumbnailPaths\n{\n    preSkip : ImgPath;\n    // Leave undefined if portrait doesn't chang after timeskip\n    postSkip? : ImgPath;\n}\n\nexport const CharacterToThumbnailMap = new Map<CharacterName, ThumbnailPaths>();\n\n// Byleths\nCharacterToThumbnailMap.set(CharacterName.BylethMale,   { preSkip: BylethMale_Pre,      postSkip: BylethMale_Post });\nCharacterToThumbnailMap.set(CharacterName.BylethFemale, { preSkip: BylethFemale_Pre,    postSkip: BylethFemale_Post});\n\n// Black Eagles\nCharacterToThumbnailMap.set(CharacterName.Edelgard,     { preSkip: Edelgard_Pre,        postSkip: Edelgard_Post});\nCharacterToThumbnailMap.set(CharacterName.Hubert,       { preSkip: Hubert_Pre,          postSkip: Hubert_Post});\nCharacterToThumbnailMap.set(CharacterName.Dorothea,     { preSkip: Dorothea_Pre,        postSkip: Dorothea_Post});\nCharacterToThumbnailMap.set(CharacterName.Ferdinand,    { preSkip: Ferdinand_Pre,       postSkip: Ferdinand_Post});\nCharacterToThumbnailMap.set(CharacterName.Bernadetta,   { preSkip: Bernadetta_Pre,      postSkip: Bernadetta_Post});\nCharacterToThumbnailMap.set(CharacterName.Caspar,       { preSkip: Caspar_Pre,          postSkip: Caspar_Post});\nCharacterToThumbnailMap.set(CharacterName.Petra,        { preSkip: Petra_Pre,           postSkip: Petra_Post});\nCharacterToThumbnailMap.set(CharacterName.Linhardt,     { preSkip: Linhardt_Pre,        postSkip: Linhardt_Post});\n\n// Blue Lions\nCharacterToThumbnailMap.set(CharacterName.Dimitri,      { preSkip: Dimitri_Pre,         postSkip: Dimitri_Post});\nCharacterToThumbnailMap.set(CharacterName.Dedue,        { preSkip: Dedue_Pre,           postSkip: Dedue_Post});\nCharacterToThumbnailMap.set(CharacterName.Felix,        { preSkip: Felix_Pre,           postSkip: Felix_Post});\nCharacterToThumbnailMap.set(CharacterName.Mercedes,     { preSkip: Mercedes_Pre,        postSkip: Mercedes_Post});\nCharacterToThumbnailMap.set(CharacterName.Ashe,         { preSkip: Ashe_Pre,            postSkip: Ashe_Post});\nCharacterToThumbnailMap.set(CharacterName.Annette,      { preSkip: Annette_Pre,         postSkip: Annette_Post});\nCharacterToThumbnailMap.set(CharacterName.Sylvain,      { preSkip: Sylvain_Pre,         postSkip: Sylvain_Post});\nCharacterToThumbnailMap.set(CharacterName.Ingrid,       { preSkip: Ingrid_Pre,          postSkip: Ingrid_Post});\n\n// Golden Deer\nCharacterToThumbnailMap.set(CharacterName.Claude,       { preSkip: Claude_Pre,          postSkip: Claude_Post});\nCharacterToThumbnailMap.set(CharacterName.Lorenz,       { preSkip: Lorenz_Pre,          postSkip: Lorenz_Post});\nCharacterToThumbnailMap.set(CharacterName.Hilda,        { preSkip: Hilda_Pre,           postSkip: Hilda_Post});\nCharacterToThumbnailMap.set(CharacterName.Raphael,      { preSkip: Raphael_Pre,         postSkip: Raphael_Post});\nCharacterToThumbnailMap.set(CharacterName.Lysithea,     { preSkip: Lysithea_Pre,        postSkip: Lysithea_Post});\nCharacterToThumbnailMap.set(CharacterName.Ignatz,       { preSkip: Ignatz_Pre,          postSkip: Ignatz_Post});\nCharacterToThumbnailMap.set(CharacterName.Marianne,     { preSkip: Marianne_Pre,        postSkip: Marianne_Post});\nCharacterToThumbnailMap.set(CharacterName.Leonie,       { preSkip: Leonie_Pre,          postSkip: Leonie_Post});\n\n// Church\nCharacterToThumbnailMap.set(CharacterName.Manuela,      { preSkip: Manuela});\nCharacterToThumbnailMap.set(CharacterName.Hanneman,     { preSkip: Hanneman});\nCharacterToThumbnailMap.set(CharacterName.Seteth,       { preSkip: Seteth});\nCharacterToThumbnailMap.set(CharacterName.Flayn,        { preSkip: Flayn});\nCharacterToThumbnailMap.set(CharacterName.Cyril,        { preSkip: Cyril_Pre,           postSkip: Cyril_Post});\nCharacterToThumbnailMap.set(CharacterName.Catherine,    { preSkip: Catherine});\nCharacterToThumbnailMap.set(CharacterName.Alois,        { preSkip: Alois});\nCharacterToThumbnailMap.set(CharacterName.Gilbert,      { preSkip: Gilbert});\nCharacterToThumbnailMap.set(CharacterName.Shamir,       { preSkip: Shamir});\n\n// Ashen Wolves\nCharacterToThumbnailMap.set(CharacterName.Yuri,         { preSkip: Yuri_Pre,            postSkip: Yuri_Post});\nCharacterToThumbnailMap.set(CharacterName.Balthus,      { preSkip: Balthus_Pre,         postSkip: Balthus_Post});\nCharacterToThumbnailMap.set(CharacterName.Constance,    { preSkip: Constance_Pre,       postSkip: Constance_Post});\nCharacterToThumbnailMap.set(CharacterName.Hapi,         { preSkip: Hapi_Pre,            postSkip: Hapi_Post});\n\n// Other\nCharacterToThumbnailMap.set(CharacterName.Jeritza,      { preSkip: Jeritza});\nCharacterToThumbnailMap.set(CharacterName.Anna,         { preSkip: Anna});\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CSSProperties } from 'react';\nimport { CharacterThumbnailProps, CharacterToThumbnailMap } from '../data/CharacterThumbnails';\n\nexport function CharacterThumbnail(props : CharacterThumbnailProps)\n{\n    const path = CharacterToThumbnailMap.get(props.character);\n\n    if (path === undefined)\n    {\n        const style : CSSProperties = {\n            display : \"block\",\n            color : \"white\",\n            width : props.width,\n            height : props.height,\n            backgroundColor : \"#aaaaaa\",\n            fontSize : (props.height * 0.5).toFixed(0) + \"px\",\n            lineHeight : props.height + \"px\",\n            textAlign : \"center\",\n            verticalAlign : \"middle\",\n            ...props.style\n        };\n\n        return (\n            <div style={style}>?</div>\n        );\n    }\n    else\n    {\n        let style : CSSProperties = {\n            display : \"block\",\n            width : props.width,\n            height : props.height,\n            backgroundColor : \"transparent\",\n            objectFit : \"contain\",\n            ...props.style\n        };\n\n        if (!props.timeskip)\n        {\n            return (\n                <img src={path.preSkip} style={style} alt={props.character.toString() + \" Thumbnail\"} />\n            );\n        }\n        else\n        {\n            return (\n                <img src={path.postSkip ?? path.preSkip} style={style} alt={props.character.toString() + \" Thumbnail\"} />\n            );\n        }\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { useState } from \"react\";\nimport { CharacterProfile, serializeCharacterProfileToJson } from \"../model/CharacterProfile\";\n\n\nexport interface ExportProfileDialogProps\n{\n    open : boolean;\n    profile : CharacterProfile;\n    onClose : () => void;\n}\n\nexport function ExportProfileDialog(props : ExportProfileDialogProps) : JSX.Element\n{\n    const [showCopiedMessage, setShowCopiedMessage] = useState(false);\n\n    const profileJson = props.open ? serializeCharacterProfileToJson(props.profile) : \"\";\n\n    const copyHandler = async () => {\n        await navigator.clipboard.writeText(serializeCharacterProfileToJson(props.profile));\n        setShowCopiedMessage(true);\n    };\n\n    const closeHandler = async () => {\n        setShowCopiedMessage(false);\n        props.onClose();\n    };\n\n    return (\n        <Dialog open={props.open} onClose={closeHandler}>\n            <DialogTitle>\n                Export Character Code\n            </DialogTitle>\n            <DialogContent>\n                <TextField\n                    multiline\n                    label=\"Character Code\"\n                    variant=\"filled\"\n                    value={profileJson}\n                    rowsMax={6}\n                    style={{minWidth: 500, marginBottom: 4}}\n                    />\n                <Button variant=\"contained\" color=\"primary\" onClick={copyHandler}>Copy to Clipboard</Button>\n                {\n                    showCopiedMessage\n                        ? <Button variant=\"text\" disabled style={{color: \"#222222\"}}>Copied!</Button>\n                        : null\n                }\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={closeHandler} color=\"default\">Close</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { useState } from \"react\";\nimport { CharacterProfile, deserializeCharacterProfileFromJson } from \"../model/CharacterProfile\";\n\nexport interface ImportProfileDialogProps\n{\n    open : boolean;\n    onCancelled : () => void;\n    onProfileLoaded : (profile : CharacterProfile) => void;\n}\n\nexport function ImportProfileDialog(props : ImportProfileDialogProps) : JSX.Element\n{\n    const [importString, setImportString] = useState(\"\");\n\n    const closeHandler = async () => {\n        props.onCancelled();\n    };\n\n    const parseResult = deserializeCharacterProfileFromJson(importString);\n\n    const importHandler = async () => {\n        setImportString(\"\");\n        props.onProfileLoaded(parseResult.result as CharacterProfile);\n    };\n\n    return (\n        <Dialog open={props.open} onClose={closeHandler}>\n            <DialogTitle>\n                Import Character Code\n            </DialogTitle>\n            <DialogContent>\n                <TextField\n                    multiline\n                    label=\"Character Code\"\n                    variant=\"filled\"\n                    value={importString}\n                    rowsMax={6}\n                    style={{minWidth: 500, marginBottom: 4}}\n                    onChange={event => setImportString(event.target.value)}\n                    error={importString.trim().length > 0 && parseResult.error !== undefined}\n                    helperText={importString.trim().length > 0 ? parseResult.error as string : undefined}\n                    />\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={closeHandler} color=\"default\">Cancel</Button>\n                <Button onClick={importHandler} color=\"primary\" disabled={parseResult.error !== undefined}>Import</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from 'react';\nimport { useState } from 'react';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport Button from '@material-ui/core/Button';\nimport RemoveCircleIcon from '@material-ui/icons/RemoveCircle';\nimport { CharacterClass } from '../data/CharacterClass';\nimport { areEquivalentStatLimitMods, StatLimitMods } from '../data/CharacterData';\nimport { CharacterName } from '../data/CharacterName';\nimport { getEligibleClasses } from '../data/ClassData';\nimport { ClassChange, GrowthProfile, validateClassProfile } from '../sim/GrowthProfile';\nimport { areEqualStats } from '../sim/StatArray';\nimport { CharacterProfile } from '../model/CharacterProfile';\nimport { ClassChangeEditor } from './ClassChangeEditor';\nimport { InitialStatsEditor } from './InitialStatsEditor';\nimport { LevelSelector } from './LevelSelector';\nimport { MaxStatLimitModEditor } from './MaxStatLimitModEditor';\nimport { CharacterThumbnail } from './CharacterThumbnail';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport { InitialStats } from '../data/CharacterPresetLoader';\nimport { ExportProfileDialog } from './ExportProfileDialog';\nimport { ImportProfileDialog } from './ImportProfileDialog';\n\nfunction removeUnusedClassChanges(profile : CharacterProfile) : Array<ClassChange>\n{\n    return profile.changes.filter((classChange) => classChange.level >= profile.startLevel && classChange.level <= profile.endLevel);\n}\n\nexport function getGrowthProfileFromCharacterProfile(profile : CharacterProfile) : GrowthProfile\n{\n    const filteredClassChanges = removeUnusedClassChanges(profile);\n    const growthProfile : GrowthProfile = {\n        startLevel: profile.startLevel,\n        startClass: profile.startClass,\n        startStats: [...profile.startStats],\n        changes: filteredClassChanges,\n        endLevel: profile.endLevel,\n    };\n\n    if (!validateClassProfile(growthProfile))\n    {\n        throw new Error(\"Class changes are out of order in character profile.\");\n    }\n\n    return growthProfile;\n}\n\n// Compares normalized profiles and returns whether they are equivalent. \n// This results in disregarding extraneous class changes.\nexport function areEquivalentCharacterProfile(left : CharacterProfile, right : CharacterProfile) : boolean\n{\n    if (left.character !== right.character\n        || left.startLevel !== right.startLevel\n        || left.startClass !== right.startClass\n        || !areEqualStats(left.startStats, right.startStats)\n        || left.endLevel !== right.endLevel\n        || !areEquivalentStatLimitMods(left.maxStatMods, right.maxStatMods))\n    {\n        return false;\n    }\n\n    // Normalize to compare.\n    const leftChanges = removeUnusedClassChanges(left);\n    const rightChanges = removeUnusedClassChanges(right);\n    if (leftChanges.length !== rightChanges.length\n        || leftChanges.some((c, i) => c.level !== rightChanges[i].level || c.class !== rightChanges[i].class))\n    {\n        return false;\n    }\n    else\n    {\n        return true;\n    }\n}\n\nexport interface CharacterProfileBuilderProps\n{\n    profile : CharacterProfile;\n    // Default false\n    showDeleteButton? : boolean;\n    onProfileChange : (profile : CharacterProfile) => void;\n    onDeleteClicked : () => void;\n}\n\nconst CharacterCardStyle : React.CSSProperties = {\n    margin: 8,\n    overflow: \"visible\",\n};\n\nconst ContainerStyle : React.CSSProperties = {\n    display: 'flex',\n    flexBasis : \"auto\",\n    flexWrap : \"nowrap\",\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    alignContent: \"flex-start\",\n};\n\nconst RemoveProfileButtonStyle : React.CSSProperties = {\n    display: 'block',\n    flexBasis: 'auto',\n    flexGrow: 0,\n    flexShrink: 0\n};\n\nconst CharacterStatsContainer : React.CSSProperties = {\n    display: 'flex',\n    flexDirection: 'column',\n    flexBasis: 'auto',\n    flexShrink: 1,\n    flexGrow: 1,\n    alignItems: 'flex-start',\n    alignContent: 'baseline'\n}\n\n// Based on empirically measured values, because it's good enough (tm)\nconst THUMBNAIL_WIDTH = 128;\nconst THUMBNAIL_HEIGHT = 128;\n\nconst CharacterThumbnailLayout : React.CSSProperties = {\n    display : \"block\",\n    flexGrow : 0,\n    flexShrink : 0\n}\n\nconst OtherSettingsContainerStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-start\",\n    alignContent: \"flex-start\",\n    flexBasis: 0,\n    marginTop: 16,\n    marginRight: 16,\n    marginLeft: 16,\n};\n\nconst OtherSettingsControlRow : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexBasis: 0,\n    flexGrow: 0,\n    flexShrink: 0,\n    alignItems: \"flex-start\",\n    alignContent: \"flex-start\",\n    paddingTop: 8,\n};\n\nconst ThumbnailColumnStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexBasis: 'auto',\n    flexShrink: 0,\n    flexGrow: 0,\n    marginTop: 8\n};\n\nconst CharacterImportExportButtonsStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    flexBasis: 'auto',\n    flexShrink: 1,\n    flexGrow: 1,\n    marginTop: 4\n};\n\nfunction classChangeListToMap(list : Array<ClassChange>) : Map<number, Array<CharacterClass>>\n{\n    const map = new Map<number, Array<CharacterClass>>();\n    for (const entry of list)\n    {\n        const changesForLevel = map.get(entry.level);\n        if (changesForLevel !== undefined)\n        {\n            changesForLevel.push(entry.class);\n        }\n        else\n        {\n            map.set(entry.level, [entry.class]);\n        }\n    }\n    return map;\n}\n\nfunction flattenClassChanges(changes : Map<number, Array<CharacterClass>>) : Array<ClassChange>\n{\n    const list : Array<ClassChange> = [];\n\n    const levels = Array.from(changes.keys());\n    levels.sort((a, b) => a - b);\n    \n    for (const level of levels)\n    {\n        for (const c of (changes.get(level) as Array<CharacterClass>))\n        {\n            list.push({\n                level : level,\n                class : c\n            });\n        }\n    }\n\n    return list;\n}\n\nfunction getReconciledClassChanges(initialStats : InitialStats, classChanges : Array<ClassChange>) : Array<ClassChange>\n{\n    const eligibleClasses = getEligibleClasses(initialStats.character);\n\n    // Delete class changes for ineligible classes.\n    return classChanges.filter((classChange) => eligibleClasses.has(classChange.class));\n}\n\nfunction getReconciledEndLevel(initialStats : InitialStats, classChanges : Array<ClassChange>, endLevel : number) : number\n{\n    let candidate = Math.max(initialStats.level, endLevel);\n\n    if (classChanges.length > 0)\n    {\n        candidate = Math.max(candidate, classChanges[classChanges.length - 1].level);\n    }\n\n    return candidate;\n}\n\nfunction getInitialStatsFromProfile(character : CharacterName, profile : GrowthProfile) : InitialStats\n{\n    return {\n        character : character,\n        class : profile.startClass,\n        level : profile.startLevel,\n        stats : [...profile.startStats],\n    };\n}\n\n// Component that builds a character profile for stats analysis.\nexport function CharacterProfileBuilder(props : CharacterProfileBuilderProps) : JSX.Element\n{\n    const [exportDialogOpen, setExportDialogOpen] = useState(false);\n    const [importDialogOpen, setImportDialogOpen] = useState(false);\n\n    const _max_stat_mods_change = (newMods : StatLimitMods) => {\n        props.onProfileChange({\n            ...props.profile,\n            maxStatMods : newMods\n        });\n    };\n\n    const _initial_stats_editor_change = (newInitialStats : InitialStats) => {\n        const reconciledClassChangeList = getReconciledClassChanges(newInitialStats, props.profile.changes);\n        const reconciledEndLevel = getReconciledEndLevel(newInitialStats, reconciledClassChangeList, props.profile.endLevel);\n\n        props.onProfileChange({\n            ...props.profile,\n            character : newInitialStats.character,\n            startLevel : newInitialStats.level,\n            startClass : newInitialStats.class,\n            startStats : [...newInitialStats.stats],\n            changes : reconciledClassChangeList,\n            endLevel : reconciledEndLevel,\n        });\n    };\n\n    const _handle_class_change_list_changed = (newClassChangeList : Map<number, Array<CharacterClass>>) => {\n        const flattenedClassChanges = flattenClassChanges(newClassChangeList);\n        const reconciledEndLevel = getReconciledEndLevel(getInitialStatsFromProfile(props.profile.character, props.profile), flattenedClassChanges, props.profile.endLevel);\n\n        props.onProfileChange({\n            ...props.profile,\n            changes : flattenedClassChanges,\n            endLevel : reconciledEndLevel,\n        });\n    };\n\n    const _handle_end_level_changed = (newEndLevel : number) => {\n        props.onProfileChange({\n            ...props.profile,\n            endLevel : newEndLevel,\n        });\n    };\n\n    const maybeRemoveButton = (!!props.showDeleteButton)\n        ? <div style={RemoveProfileButtonStyle}><Button color=\"secondary\" disableElevation onClick={() => props.onDeleteClicked()}><RemoveCircleIcon /></Button></div>\n        : null;\n\n    // Nice surprise for some people. 20 because that's how Normal mode works.\n    const useTimeskipThumbnail = props.profile.startLevel >= 20;\n\n    return (\n    <Card style={CharacterCardStyle} variant=\"outlined\">\n        <CardContent>\n            <div style={ContainerStyle}>\n                <div style={ThumbnailColumnStyle}>\n                    <CharacterThumbnail \n                        character={props.profile.character} \n                        width={THUMBNAIL_WIDTH} \n                        height={THUMBNAIL_HEIGHT} \n                        style={CharacterThumbnailLayout}\n                        timeskip={useTimeskipThumbnail}/>\n                    <div style={CharacterImportExportButtonsStyle}>\n                        <Button size=\"small\" onClick={() => setImportDialogOpen(true)}>Import</Button>\n                        <Button size=\"small\" onClick={() => setExportDialogOpen(true)}>Export</Button>\n                    </div>\n                    <ExportProfileDialog\n                        open={exportDialogOpen}\n                        profile={props.profile}\n                        onClose={() => setExportDialogOpen(false)}\n                        />\n                    <ImportProfileDialog\n                        open={importDialogOpen}\n                        onCancelled={() => setImportDialogOpen(false)}\n                        onProfileLoaded={(profile) => {setImportDialogOpen(false); props.onProfileChange(profile)}}\n                        />\n                </div>\n                <div style={CharacterStatsContainer}>\n                    <InitialStatsEditor \n                        character={props.profile.character} \n                        class={props.profile.startClass}\n                        level={props.profile.startLevel}\n                        stats={props.profile.startStats}\n                        maxStatMods={props.profile.maxStatMods}\n                        handler={_initial_stats_editor_change}\n                    />\n                    <div style={OtherSettingsContainerStyle}>\n                        <FormLabel>Analysis Settings</FormLabel>\n                        <LevelSelector\n                                minLevel={props.profile.startLevel}\n                                customText=\"Target level: \"\n                                labelStyle=\"inline\"\n                                value={props.profile.endLevel}\n                                onSelected={_handle_end_level_changed}\n                            />\n                    </div>\n                    <div style={{display: \"flex\", alignItems: \"flex-start\", flexDirection: \"column\", marginTop: 8, marginLeft: 16}}>\n                        <FormLabel style={{marginBottom: 8}}>Class Changes</FormLabel>\n                        <ClassChangeEditor\n                            character={props.profile.character}\n                            classChangeList={classChangeListToMap(props.profile.changes)}\n                            minLevel={props.profile.startLevel}\n                            onClassChangeListChange={_handle_class_change_list_changed}\n                        />\n                    </div>\n                    <div style={OtherSettingsContainerStyle}>\n                        <FormLabel>Other Settings</FormLabel>\n                        <div style={OtherSettingsControlRow}>\n                            <MaxStatLimitModEditor status={props.profile.maxStatMods} onChanged={_max_stat_mods_change} containerStyle={{marginLeft: 16}}/>\n                        </div>\n                    </div>\n                </div>\n                {maybeRemoveButton}\n            </div>\n        </CardContent>\n    </Card>);\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterClass } from \"../data/CharacterClass\";\nimport { StartingStats } from \"./StatArray\";\n\nexport interface ClassChange\n{\n    level: number;\n    class: CharacterClass;\n}\n\nexport interface GrowthProfile\n{\n    startLevel : number;\n    startClass : CharacterClass;\n    // Should be character's current stats, not base stats after subtracting bonus stats\n    // from current class.\n    startStats : StartingStats;\n\n    changes : Array<ClassChange>;\n    endLevel : number;\n}\n\n// Checks for correctness of the ClassProfile. Returns false if any class changes are \n// below initial class, also returns false if order of changes ever decreases in level.\nexport function validateClassProfile(c : GrowthProfile) : boolean\n{\n    if (c.startLevel > c.endLevel)\n    {\n        return false;\n    }\n\n    for (let i = 0; i < c.changes.length; i++)\n    {\n        if (c.changes[i].level < c.startLevel || c.changes[i].level > c.endLevel)\n        {\n            return false;\n        }\n\n        if (i > 0 && c.changes[i].level < c.changes[i-1].level)\n        {\n            return false;\n        }\n    }\n\n    return true;\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from 'react';\nimport { Area, AreaChart, CartesianGrid, Legend, ReferenceLine, ResponsiveContainer, Tooltip, XAxis, YAxis } from 'recharts';\nimport { DataSeries } from './ProbabilityDisplay';\nimport { SERIES_COLOR_SCHEMES } from \"./ChartColorScheme\";\n\nexport interface RechartProbabilityDisplayProps\n{\n    // X axis\n    minBin? : number;\n    maxBin? : number;\n\n    // Y axis\n    maxValue? : number;\n    minValue : number;\n\n    statLabel : string;\n\n    dataSeries : DataSeries[];\n\n    size? : [number,number];\n\n    style? : React.CSSProperties;\n}\n\nexport interface RechartProbabilityDisplayState\n{\n\n}\n\ninterface ChartDatum extends Record<string,number>\n{\n    bin : number;\n}\n\ntype ChartData = ChartDatum[];\n\nexport class EmptyDataSeriesError extends Error\n{\n    constructor(message : string) \n    {\n        super(message);\n        this.name = \"EmptyDataSeriesError\";\n    }\n}\n\nconst minReducer = (a : number, b : number) => Math.min(a,b);\nconst maxReducer = (a : number, b : number) => Math.min(a,b);\n\nfunction reduceKeys<T>(m : Map<number,T>, reducer : (a : number, b : number) => number) : number\n{\n    return Array.from(m.keys()).reduce(reducer);\n}\n\nfunction computeChartData(props : RechartProbabilityDisplayProps) : [ChartData, string[]]\n{\n    if (props.dataSeries.some(d => d.probabilityValues.size === 0))\n    {\n        throw new EmptyDataSeriesError(\"At least one of the data series has no data points.\");\n    }\n\n    let dataPoints : ChartData = [];\n    const seriesNames : string[] = props.dataSeries.map(d => d.name);\n\n    let leftLimit : number = props.minBin ?? props.dataSeries.map(d => reduceKeys(d.probabilityValues, minReducer)).reduce(minReducer);\n    let rightLimit : number = props.maxBin ?? props.dataSeries.map(d => reduceKeys(d.probabilityValues, maxReducer)).reduce(maxReducer);\n\n    // Pad the left/right bounds to look better\n    if (leftLimit > 0)\n    {\n        leftLimit--;\n    }\n    rightLimit++;\n\n    for (let i = leftLimit; i <= rightLimit; i++)\n    {\n        let point : ChartDatum = {\n            bin : i\n        };\n\n        props.dataSeries.forEach(series => {\n            const maybeBinValue = series.probabilityValues.get(i);\n            if (maybeBinValue !== undefined)\n            {\n                point[series.name] = maybeBinValue as number;\n            }\n            else\n            {\n                point[series.name] = 0;\n            }\n        });\n\n        dataPoints.push(point);\n    }\n\n    return [dataPoints, seriesNames];\n}\n\nfunction computeAverageLines(props : RechartProbabilityDisplayProps) : Array<JSX.Element | null>\n{\n    return props.dataSeries.map((d, index) => {\n        const avgValue = d.averageValue;\n        if (avgValue !== undefined)\n        {\n            const avgXCoord = Math.round(avgValue).toString();\n            return <ReferenceLine \n                x={avgXCoord}\n                stroke={SERIES_COLOR_SCHEMES[index].medianValueColor}\n                key={`avgline-${index}`}\n                label={`Median`}/>;\n        }\n        else\n        {\n            return null;\n        }\n    });\n}\n\nfunction probabilityValueFormatter(value : number, decimalDigits : number) : string\n{\n    return `${(value * 100).toFixed(decimalDigits)}%`;\n}\n\nfunction labelFormatter(prefix: string, number: number) : string\n{\n    return `${prefix}: ${number}`;\n}\n\nexport class RechartProbabilityDisplay extends React.Component<RechartProbabilityDisplayProps, RechartProbabilityDisplayState>\n{\n    private containerRef : React.RefObject<HTMLDivElement>;\n\n    constructor(props : RechartProbabilityDisplayProps)\n    {\n        super(props);\n\n        this.containerRef = React.createRef<HTMLDivElement>();\n    }\n\n    render() : JSX.Element\n    {\n        const [chartData, seriesKeys] = computeChartData(this.props);\n        //const referenceLines = computeReferenceLines(this.props);\n        const averageLines = computeAverageLines(this.props);\n        \n        const areaGraphs = seriesKeys.map((seriesKey : string, index : number) => {\n            return <Area \n                type=\"step\" \n                dataKey={seriesKey} \n                stroke={SERIES_COLOR_SCHEMES[index].baseHighlightColor} \n                key={`area-${index}`} \n                fillOpacity={0.7}\n                fill={SERIES_COLOR_SCHEMES[index].baseColor}/>\n        });\n\n        const maxValue = this.props.maxValue ?? this.props.dataSeries.map(d => Array.from(d.probabilityValues.values()).reduce(maxReducer)).reduce(maxReducer);\n\n        const containerStyle : React.CSSProperties = {};\n\n        if (this.props.size !== undefined)\n        {\n            containerStyle.width = this.props.size[0];\n            containerStyle.height = this.props.size[1];\n        }\n        else if (this.containerRef.current !== null)\n        {\n            //containerStyle.width = \"100%\";\n            containerStyle.height = Math.round(this.containerRef.current.getBoundingClientRect().width * 0.3);\n        }\n        else \n        {\n            // Sensible defaults for a 1080p screen\n            //containerStyle.width = \"100%\"\n            containerStyle.height = 300;\n        }\n\n        return <div ref={this.containerRef} style={{...containerStyle, ...(this.props.style ?? {})}}>\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <AreaChart data={chartData} margin={{top: 10, right: 20, left: 20, bottom: 10}}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"bin\">\n                    </XAxis>\n                    <YAxis domain={[this.props.minValue, maxValue]} tickFormatter={(x : any) => probabilityValueFormatter(Number.parseFloat(x), 0)}>\n                    </YAxis>\n                    <Tooltip formatter={(x : any) => probabilityValueFormatter(Number.parseFloat(x), 2)} labelFormatter={(n) => labelFormatter(this.props.statLabel, n)}/>\n                    {averageLines}\n                    {areaGraphs}\n                    <Legend />\n                </AreaChart>\n            </ResponsiveContainer>\n        </div>;\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport HelpIcon from '@material-ui/icons/Help';\nimport { DataSeries } from './ProbabilityDisplay';\nimport { RechartProbabilityDisplay } from './RechartProbabilityDisplay';\n\ntype SingleStatAnalysisResult = Map<number, number>;\nexport interface AnalysisSingleStatDisplayProps\n{\n    title : string;\n    caption : string;\n\n    seriesNames : string[];\n    series : SingleStatAnalysisResult[];\n    averageValues : Array<number | undefined>;\n    \n    size? : [number, number];\n\n    minValue : number;\n    maxValue : number;\n    maxProbability : number;\n}\n\n// Hack to address a problem where Rechart area charts don't render areas right with single values.\nfunction padSingleValueResultMap(resultMap : SingleStatAnalysisResult) : SingleStatAnalysisResult\n{\n    return resultMap;\n}\n\nfunction computeDataSeries(seriesNames : string[], series : SingleStatAnalysisResult[], averages : Array<number | undefined>) : DataSeries[]\n{\n    return series.map((single, index) => ({\n        name : seriesNames[index],\n        probabilityValues : single.size > 1 ? single : padSingleValueResultMap(single),\n        averageValue: averages[index]\n    }));\n}\n\nconst OuterLayoutStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyItems: \"flex-start\",\n    alignItems: \"center\"\n};\n\nconst ChartTitleStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexBasis: \"auto\",\n    flexShrink: 0,\n    flexGrow: 0,\n    alignContent: \"center\",\n    justifyContent: \"center\",\n    textTransform: \"uppercase\",\n    verticalAlign: \"middle\"\n};\n\nconst ChartBodyStyle : React.CSSProperties = {\n    display: \"block\",\n    flexBasis: \"auto\",\n    flexShrink: 0,\n    flexGrow: 1\n};\n\nexport function AnalysisSingleStatDisplay(props : AnalysisSingleStatDisplayProps) : JSX.Element\n{\n    const dataSeries : DataSeries[] = computeDataSeries(props.seriesNames, props.series, props.averageValues);\n\n    return <div style={OuterLayoutStyle}>\n        <div style={{display: 'flex', flexDirection: 'row', alignItems: 'baseline', minWidth: 80}}>\n            <div style={{flexBasis: 'auto', flexGrow: 0, flexShrink: 0}}>\n                <Typography variant=\"h6\" style={ChartTitleStyle}>{props.title}</Typography>\n            </div>\n            <div style={{flexBasis: 'auto', flexGrow: 0, flexShrink: 0, position: 'relative', top: 2}}>\n                <Tooltip title={props.caption}>\n                    <HelpIcon fontSize='small'/>\n                </Tooltip>\n            </div>\n        </div>\n        <RechartProbabilityDisplay \n            style={ChartBodyStyle}\n            size={props.size} \n            minBin={props.minValue} \n            maxBin={props.maxValue} \n            minValue={0.0} \n            maxValue={props.maxProbability} \n            dataSeries={dataSeries}\n            statLabel={props.title.toLocaleUpperCase()}\n        />\n    </div>;\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from \"react\";\nimport { getCharacterDisplayName } from \"../data/CharacterName\";\nimport { AnalysisComponent, AnalysisReport } from \"../model/PageManager\";\nimport { clamp } from \"../model/Util\";\nimport { computeDistributionMedianForSingleStat, DistributionsByStat } from \"../sim/GrowthResultAccumulator\";\nimport { getCanonicalStatNameByIndex, iCHA, iDEF, iDEX, iHP, iLCK, iMAG, iRES, iSPD, iSTR, iTOTAL } from \"../sim/StatArray\";\nimport { AnalysisSingleStatDisplay } from \"./AnalysisSingleStatDisplay\";\n\ninterface AnalysisReportDisplayProps\n{\n    report : AnalysisReport | null;\n    selectedLevel : number;\n}\n\nexport function getReportMinLevel(report : AnalysisReport | null) : number\n{\n    if (report === null)\n    {\n        return -1;\n    }\n    else\n    {\n        // Default level choice is the highest level number in the computation\n        return report.components.map(v => v.profile.startLevel).reduce((p, c) => Math.min(p, c));\n    }\n}\n\nexport function getReportMaxLevel(report : AnalysisReport | null) : number\n{\n    if (report === null)\n    {\n        return -1;\n    }\n    else\n    {\n        // Default level choice is the highest level number in the computation\n        return report.components.map(v => v.profile.endLevel).reduce((p, c) => Math.max(p, c));\n    }\n}\n\nconst StatDescriptionsByIndex : Map<number, string> = new Map<number, string>();\nStatDescriptionsByIndex.set(iHP, \"The probability (y-axis) that the character's HP will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iSTR, \"The probability (y-axis) that the character's STR will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iMAG, \"The probability (y-axis) that the character's MAG will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iDEX, \"The probability (y-axis) that the character's DEX will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iSPD, \"The probability (y-axis) that the character's SPD will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iLCK, \"The probability (y-axis) that the character's LCK will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iDEF, \"The probability (y-axis) that the character's DEF will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iRES, \"The probability (y-axis) that the character's RES will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iCHA, \"The probability (y-axis) that the character's CHA will end up at that value (x-axis) at the chosen level.\");\nStatDescriptionsByIndex.set(iTOTAL, \"The probability (y-axis) that the character will gain that many stat points (x-axis) when advancing to the chosen level.\");\n\nfunction getStatDescriptionByIndex(statIndex : number) : string\n{\n    const r = StatDescriptionsByIndex.get(statIndex);\n    if (r === undefined)\n    {\n        throw new RangeError(`Unknown StatArray index ${statIndex}`);\n    }\n    else\n    {\n        return r;\n    }\n}\n\nfunction getKeyBounds(statDistribution : Map<number, number>) : [number, number]\n{\n    return Array.from(statDistribution.keys())\n        .map(v => [v, v] as [number, number])\n        .reduce((p, n) => [Math.min(p[0], n[0]), Math.max(p[1], n[1])]);\n}\n\nfunction floorWithPrecision(n : number, digits : number) : number\n{\n    const scale = Math.pow(10.0, digits);\n    return Math.floor(n * scale) / scale;\n}\n\nfunction ceilWithPrecision(n : number, digits : number) : number\n{\n    const scale = Math.pow(10.0, digits);\n    return Math.ceil(n * scale) / scale;\n}\n\nfunction getStatBounds(report : AnalysisReport, selectedLevel : number) : [number, number, number, number, number, number, number]\n{\n    return report.components.map(entry => {\n        const levelToUse = clamp(selectedLevel, entry.profile.startLevel, entry.profile.endLevel);\n        const statDistributions = entry.result.get(levelToUse);\n\n        if (statDistributions === undefined)\n        {\n            throw new RangeError(\"This error should not happen: stat probability distribution was not computed for the 'level to use'.\");\n        }\n\n        const [hpLowerBound, hpUpperBound] = getKeyBounds(statDistributions.hp);\n        const [totalLowerBound, totalUpperBound] = getKeyBounds(statDistributions.levelupTotal);\n        const [restLowerBound, restUpperBound] = [\n            statDistributions.str,\n            statDistributions.mag,\n            statDistributions.dex,\n            statDistributions.spd,\n            statDistributions.lck,\n            statDistributions.def,\n            statDistributions.res,\n            statDistributions.cha]\n        .map(v => getKeyBounds(v))\n        .reduce((p, n) => [Math.min(p[0], n[0]), Math.max(p[1], n[1])]);\n\n        const highestBinProbabilitiesByStat = [\n            statDistributions.str,\n            statDistributions.mag,\n            statDistributions.dex,\n            statDistributions.spd,\n            statDistributions.lck,\n            statDistributions.def,\n            statDistributions.res,\n            statDistributions.cha]\n        .map(v => Math.max(...v.values()));\n        const highestBinProbability = Math.max(...highestBinProbabilitiesByStat);\n\n        return [hpLowerBound, hpUpperBound, restLowerBound, restUpperBound, totalLowerBound, totalUpperBound, highestBinProbability] as [number, number, number, number, number, number, number]\n    }).reduce((p, n) => [\n        floorWithPrecision(Math.min(p[0], n[0]), 2),\n        ceilWithPrecision(Math.max(p[1], n[1]), 2),\n        floorWithPrecision(Math.min(p[2], n[2]), 2),\n        ceilWithPrecision(Math.max(p[3], n[3]), 2),\n        floorWithPrecision(Math.min(p[4], n[4]), 2),\n        ceilWithPrecision(Math.max(p[5], n[5]), 2),\n        ceilWithPrecision(Math.max(p[6], n[6]), 2)\n    ]);\n}\n\nexport function computeDistributionMedian(analysisComponent : AnalysisComponent, levelToUse : number, index: number) : number | undefined\n{\n    const distribution : DistributionsByStat | undefined = analysisComponent.result.get(levelToUse);\n    if (distribution === undefined)\n    {\n        throw new RangeError(`Cannot compute distribution average because data for level ${levelToUse} is not available in distribution.`);\n    }\n\n    const medianDetails = computeDistributionMedianForSingleStat(distribution, index);\n    return medianDetails === undefined ? undefined : medianDetails.median;\n}\n\ninterface PartialStatDisplayProps\n{\n    seriesNames : string[];\n    series : Array<Map<number, number>>;\n    averageValues : Array<number | undefined>;\n}\n\nfunction getSingleStatDisplayProps(report: AnalysisReport, statIndex: number, selectedLevel : number) : PartialStatDisplayProps\n{\n    const seriesLevelToUse = report.components.map(c => clamp(selectedLevel, c.profile.startLevel, c.profile.endLevel));\n    const seriesNames = report.components.map((c, index) => `(#${index+1}) ${getCharacterDisplayName(c.profile.character)} lvl ${seriesLevelToUse[index]}`);\n\n    const series = report.components.map((c, index) => {\n        const data = c.result.get(seriesLevelToUse[index]);\n        if (data === undefined)\n        {\n            console.error(`\"Level to use\" is missing from results. Theoretical bounds are ${c.profile.startLevel} to ${c.profile.endLevel}.`);\n            // Soft failure.\n            return new Map<number, number>();\n        }\n        else\n        {\n            switch (statIndex)\n            {\n                case iHP:\n                    return data.hp;\n                case iSTR:\n                    return data.str;\n                case iMAG:\n                    return data.mag;\n                case iDEX:\n                    return data.dex;\n                case iSPD:\n                    return data.spd;\n                case iLCK:\n                    return data.lck;\n                case iDEF:\n                    return data.def;\n                case iRES:\n                    return data.res;\n                case iCHA:\n                    return data.cha;\n                case iTOTAL:\n                    return data.levelupTotal;\n                default:\n                    throw new RangeError(`Unrecognized index for a stat component: ${statIndex}`);\n            }\n        }\n    });\n\n    const averageValues = report.components.map((c, index) => computeDistributionMedian(c, seriesLevelToUse[index], statIndex));\n\n    return {\n        seriesNames,\n        series,\n        averageValues\n    };\n}\n\nexport class AnalysisReportDisplay extends React.Component<AnalysisReportDisplayProps>\n{\n    // No state object\n    public shouldComponentUpdate(nextProps : AnalysisReportDisplayProps) : boolean\n    {\n        return (this.props.selectedLevel !== nextProps.selectedLevel) \n            || (nextProps.report?.cacheToken !== this.props.report?.cacheToken);\n    }\n\n    public render() : JSX.Element\n    {\n        if (this.props.report === null)\n        {\n            return <></>;\n        }\n\n        const report = this.props.report;\n        //const [minHpValue, maxHpValue, minRestValue, maxRestValue, minTotalValue, maxTotalValue, highestProbability] = getStatBounds(report, this.props.selectedLevel);\n        const [minHpValue, maxHpValue, minRestValue, maxRestValue, , , highestProbability] = getStatBounds(report, this.props.selectedLevel);\n\n        const maxProbabilty = Math.max(highestProbability, 0.3) + 0.01;\n\n        return <div style={{marginTop: 16}}>\n            <div style={{marginTop: 16}}>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iHP, this.props.selectedLevel)} \n                    minValue={minHpValue} maxValue={maxHpValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iHP)}\n                    caption={getStatDescriptionByIndex(iHP)}/>\n\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iSTR, this.props.selectedLevel)} \n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iSTR)}\n                    caption={getStatDescriptionByIndex(iSTR)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iMAG, this.props.selectedLevel)} \n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iMAG)}\n                    caption={getStatDescriptionByIndex(iMAG)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iDEX, this.props.selectedLevel)} \n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iDEX)}\n                    caption={getStatDescriptionByIndex(iDEX)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iSPD, this.props.selectedLevel)}\n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iSPD)}\n                    caption={getStatDescriptionByIndex(iSPD)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iLCK, this.props.selectedLevel)}\n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iLCK)}\n                    caption={getStatDescriptionByIndex(iLCK)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iDEF, this.props.selectedLevel)} \n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iDEF)}\n                    caption={getStatDescriptionByIndex(iDEF)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iRES, this.props.selectedLevel)}\n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iRES)}\n                    caption={getStatDescriptionByIndex(iRES)}/>\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iCHA, this.props.selectedLevel)} \n                    minValue={minRestValue} maxValue={maxRestValue} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iCHA)}\n                    caption={getStatDescriptionByIndex(iCHA)}/>\n\n                <AnalysisSingleStatDisplay {...getSingleStatDisplayProps(report, iTOTAL, this.props.selectedLevel)} \n                    minValue={0} maxValue={9} maxProbability={maxProbabilty} \n                    title={getCanonicalStatNameByIndex(iTOTAL)}\n                    caption={getStatDescriptionByIndex(iTOTAL)}/>\n            </div>\n        </div>;\n    }\n}\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from \"react\";\nimport Card from \"@material-ui/core/Card\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { Legend, PolarAngleAxis, PolarGrid, PolarRadiusAxis, Radar, RadarChart, Tooltip } from \"recharts\";\nimport { getClassDisplayName } from \"../data/CharacterClass\";\nimport { getCharacterDisplayName } from \"../data/CharacterName\";\nimport { getFinalClassAtLevelForProfile } from \"../model/CharacterProfile\";\nimport { AnalysisComponent, AnalysisReport } from \"../model/PageManager\";\nimport { clamp } from \"../model/Util\";\nimport { computeDistributionMedianForSingleStat, DistributionsByStat, getDistributionByStatIndex } from \"../sim/GrowthResultAccumulator\";\nimport { areEqualStats, forEachStatIndex, getCanonicalStatNameByIndex, initStats, mapStatArray, StatArray, statTotal, zeroStats } from \"../sim/StatArray\";\nimport { SERIES_COLOR_SCHEMES } from \"./ChartColorScheme\";\nimport { StatArraySelector } from \"./InitialStatsEditor\";\nimport HelpIcon from '@material-ui/icons/Help';\nimport * as _MuiTooltip from '@material-ui/core/Tooltip/Tooltip';\nconst MuiTooltip = _MuiTooltip.default;\n\nexport interface LuckAnalysisReportProps\n{\n    report : AnalysisReport;\n    selectedLevel : number;\n    reportIterationCounter : number;\n}\n\ninterface LuckAnalysisReportState\n{\n    referenceStats : StatArray;\n}\n\n// map of stat name to percentile rank\ninterface StatRankingRaw\n{\n    below: number;\n    same: number;\n    above: number;\n}\n\ninterface ChartDatum\n{\n    stat : string;\n    median : number;\n    reference : number;\n}\n\nexport type StatPercentileRanks = Map<string, StatRankingRaw>;\n\nexport interface SingleProfileReportProps\n{\n    distributions : DistributionsByStat;\n    ranks : StatPercentileRanks;\n    // Used for color coding\n    profileIndex : number;\n    characterName : string;\n}\n\nconst ReferenceStatContainerStyle : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow: 0,\n    flexShrink: 0,\n    flexDirection : \"row\",\n    flexBasis : 0,\n    flexWrap : \"wrap\",\n    justifyContent: \"flex-start\",\n};\n\nconst ReferenceStatElementStyle : React.CSSProperties = {\n    display : \"flex\",\n    flexGrow : 0,\n    flexShrink : 0,\n};\n\nconst RngRatingExplanation : JSX.Element = <span>The RNG rating goes from -1 (worst possible) to 1 (best possible) representing\n    the character's <b>overall</b> RNG luck. 0 is average. Below -0.3 and above 0.3 should be considered unusually bad/good \n    luck. Numbers past -0.7/0.7 without stat booster items are extremely rare.\n    </span>;\n\nfunction computeChartData(distributions : DistributionsByStat, ranks : StatPercentileRanks) : ChartDatum[]\n{\n    const data : ChartDatum[] = forEachStatIndex((index : number) => {\n        const statName = getCanonicalStatNameByIndex(index);\n        const medianData = computeDistributionMedianForSingleStat(distributions, index);\n\n        if (medianData === undefined)\n        {\n            const serializedDistribution = JSON.stringify(Object.fromEntries(getDistributionByStatIndex(distributions, index).entries()));\n            throw new Error(`Unexpected: distribution with no calculable median. Stat ${statName}, distribution: ${serializedDistribution}`);\n        }\n\n        // Display percentile is the midpoint of the probability range in order to quantize in a representative way that\n        // the 50th percentile is skewed a bit.\n        const medianDisplayPercentile = medianData.pLower + 0.5 * medianData.pMedian;\n        const rank = ranks.get(statName);\n\n        if (rank === undefined)\n        {\n            throw new Error(`Failed to look up rank percentile because key ${statName} was missing. Should be a canonical stat name.`);\n        }\n\n        const rankDisplayPercentile = rank.below + 0.5 * rank.same;\n\n        return {\n            stat: statName,\n            median: medianDisplayPercentile,\n            reference: rankDisplayPercentile\n        };\n    });\n\n    return data;\n}\n\nfunction computeStatSplit(distribution : Map<number, number>, referenceStat : number) : [number, number, number]\n{\n    let below : number = 0.0;\n    let same : number = 0.0;\n    let above : number = 0.0;\n\n    for(const bucket of distribution.keys())\n    {\n        const p = distribution.get(bucket) as number;\n\n        if (bucket < referenceStat)\n        {\n            below += p;\n        }\n        else if (bucket > referenceStat)\n        {\n            above += p;\n        }\n        else\n        {\n            same += p;\n        }\n    }\n\n    return [below, same, above];\n}\n\n// Used in test code\nexport function computePercentileRankForDistribution(referenceStats : StatArray, distribution : DistributionsByStat) : StatPercentileRanks\n{\n    // for each stat, compute rank\n    const splits = mapStatArray(referenceStats, (referenceStat, index) => {\n        // We ignore the \"same\" values\n        return computeStatSplit(getDistributionByStatIndex(distribution, index), referenceStat);\n    });\n\n    const result = new Map<string, StatRankingRaw>();\n    splits.forEach((value, index) => {\n        const [below, same, above] = value;\n        result.set(getCanonicalStatNameByIndex(index), {below, same, above});\n    });\n\n    return result;\n}\n\nfunction computePercentileRanks(referenceStats : StatArray, singleReportComponent : AnalysisComponent, selectedLevel : number) : StatPercentileRanks\n{\n    const distribution = singleReportComponent.result.get(selectedLevel);\n\n    if (distribution === undefined)\n    {\n        throw new RangeError(`No stat distribution found for level ${selectedLevel}.`);\n    }\n\n    return computePercentileRankForDistribution(referenceStats, distribution);\n}\n\n// We want extreme good/bad luck to have an outsized effect on the ranking.\nfunction biasForExtremeValues(rank : number) : number\n{\n    const exp = 2.0;\n\n    if (rank >= 0.5)\n    {\n        return Math.pow(rank * 2.0 - 1.0, exp);\n    }\n    else\n    {\n        return -Math.pow(-(rank * 2.0 - 1.0), exp);\n    }\n}\n\nfunction activationFunction(x : number) : number\n{\n    const scalar = 2.0;\n    return Math.tanh(x * scalar);\n}\n\nexport function computeLuckMetric(ranks : StatPercentileRanks) : number\n{\n    // Bias towards strength and magic, bias away from luck and charisma.\n    const weights : StatArray = [1.0, 1.5, 1.5, 1.0, 1.0, 0.3, 1.0, 1.0, 0.5];\n\n    let weightedSum = 0.0;\n\n    forEachStatIndex( i => {\n        // Can safely coerce the undefined because this usage should not look up nonexistent keys.\n        const rank : StatRankingRaw = ranks.get(getCanonicalStatNameByIndex(i)) as StatRankingRaw;\n        const element = rank.below + 0.5 * rank.same;\n        weightedSum += weights[i] * biasForExtremeValues(element);\n    });\n\n    const normalizedSum = weightedSum / statTotal(weights);\n\n    // Coerce the range to fit into -1 to +1\n    return activationFunction(normalizedSum);\n}\n\nconst ContainerStyle : React.CSSProperties = {\n};\n\nconst SingleReportContainerStyle : React.CSSProperties = {\n    padding: 8,\n    marginTop: 16\n};\n\nconst ProfileHeadingContainerStyle : React.CSSProperties = {\n};\n\nconst ProfileNameSegmentStyle : React.CSSProperties = {\n};\n\nconst LuckQuotientHighlight : React.CSSProperties = {\n    fontSize: 24,\n    fontWeight: 'bold'\n};\n\nexport function SingleProfileReport(props: SingleProfileReportProps) : JSX.Element\n{\n    const areaFill = SERIES_COLOR_SCHEMES[props.profileIndex].baseColor;\n    // Hack.\n    const areaOutline = SERIES_COLOR_SCHEMES[props.profileIndex].medianValueColor;\n    \n    // Layered, produces the region effect we need\n    const medianFill = \"#bbbbbb\";\n    const medianOutline = \"#bbbbbb\";\n\n    // TODO: figure out visualization that captures percentile ranges for the reference stat instead of point value\n    const chartData : ChartDatum[] = computeChartData(props.distributions, props.ranks);\n    //console.log(chartData);\n\n    return <RadarChart outerRadius={90} width={400} height={300} data={chartData}>\n            <PolarGrid />\n            <PolarAngleAxis dataKey=\"stat\" />\n            <PolarRadiusAxis domain={[0.0,1.0]} />\n            <Radar name=\"Median\" dataKey=\"median\" stroke={medianOutline} fill={medianFill} fillOpacity={0.4} />\n            <Radar name={`${props.characterName}`} dataKey=\"reference\" stroke={areaOutline} fill={areaFill} fillOpacity={0.4} />\n            <Tooltip formatter={(n : number) => `${(n * 100).toFixed(2)}%`} labelFormatter={(label : string) => `${label.toUpperCase()} Percentile Ranking`}/>\n            <Legend />\n        </RadarChart>;\n}\n\nfunction computeMedianStatsFromReport(report : AnalysisReport) : StatArray\n{\n    let newReferenceStats = zeroStats();\n\n    // Default to median of first profile, if available.\n    if (report.components.length > 0)\n    {\n        const referenceDistributions = report.components[0].result;\n        const referenceSourceLevel = report.components[0].profile.endLevel;\n        const referenceDistribution = referenceDistributions.get(referenceSourceLevel);\n\n        if (referenceDistribution === undefined)\n        {\n            throw new Error(\"Generated report is missing distributions for end level, indicates report generation error.\");\n        }\n\n        newReferenceStats = forEachStatIndex((index) => {\n            const medianDetails = computeDistributionMedianForSingleStat(referenceDistribution, index);\n            if (medianDetails === undefined)\n            {\n                throw new Error(\"Failed to get median from a single-stat-distribution, indicates report generation error.\")\n            }\n            return medianDetails.median;\n        }) as StatArray;\n    }\n\n    return newReferenceStats;\n}\n\n//export class LuckAnalysisReport(props : LuckAnalysisReportProps) : JSX.Element\nexport class LuckAnalysisReport extends React.Component<LuckAnalysisReportProps, LuckAnalysisReportState>\n{\n    constructor(props : LuckAnalysisReportProps)\n    {\n        super(props);\n        this.state = {referenceStats : computeMedianStatsFromReport(props.report)};\n    }\n\n    public shouldComponentUpdate(nextProps : LuckAnalysisReportProps, nextState : LuckAnalysisReportState) : boolean\n    {\n        if (!areEqualStats(this.state.referenceStats, nextState.referenceStats))\n        {\n            return true;\n        }\n        else if (nextProps.reportIterationCounter !== this.props.reportIterationCounter)\n        {\n            return true;\n        }\n        else if (nextProps.selectedLevel !== this.props.selectedLevel)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    public render() : JSX.Element\n    {\n        const onReferenceStatsChanged = (newStats : StatArray) => {\n            this.setState({referenceStats : newStats});\n        };\n\n        const reportBlocks = this.props.report.components.map((component, index) => {\n            const useLevel = clamp(this.props.selectedLevel, component.profile.startLevel, component.profile.endLevel);\n            const distributionsByStat = component.result.get(useLevel);\n            \n            if (distributionsByStat === undefined)\n            {\n                throw new RangeError(\"Missing data for a level that was already clamped.\");\n            }\n    \n            const characterName = getCharacterDisplayName(component.profile.character);\n            const characterClass=  getClassDisplayName(getFinalClassAtLevelForProfile(component.profile, useLevel))\n            const positions = computePercentileRanks(this.state.referenceStats, component, useLevel);;\n            const luckQuotient = computeLuckMetric(positions);\n            //const luckQuotient = computeLuckQuotient(positions);\n\n            const luckQuotientText = isNaN(luckQuotient) ? \"WTF\" : luckQuotient.toFixed(3);\n\n            const characterTextColor = SERIES_COLOR_SCHEMES[index].medianValueColor;\n    \n            return (\n                <Card style={SingleReportContainerStyle} key={`rngreport-card-${index}`}>\n                    <div style={ProfileHeadingContainerStyle}>\n                        <Typography variant=\"body1\" style={ProfileNameSegmentStyle}>\n                            How good would these stats be for&nbsp;\n                            <span style={{color: characterTextColor, fontWeight: 'bold'}}>{characterName}</span>\n                            &nbsp;as a&nbsp;\n                            <span style={{color: characterTextColor, fontWeight: 'bold'}}>level {useLevel} {characterClass}</span>?\n                        </Typography>\n                    </div>\n                    <div>\n                        <SingleProfileReport ranks={positions} profileIndex={index} distributions={distributionsByStat} characterName={characterName}/>\n                    </div>\n                    <div style={{display: 'flex', flexDirection: 'row', alignItems: 'baseline', marginTop: 10}}>\n                        <div style={{flexBasis: 'auto', flexGrow: 0, flexShrink: 0}}>\n                            <Typography variant=\"body1\">Overall RNG luck:&nbsp;</Typography>\n                        </div>\n                        <div style={{flexBasis: 'auto', flexGrow: 0, flexShrink: 0}}>\n                            <Typography style={LuckQuotientHighlight}>{luckQuotientText}&nbsp;</Typography>\n                        </div>\n                        <div style={{flexBasis: 'auto', flexGrow: 0, flexShrink: 0, position: 'relative', top: 1}}>\n                            <MuiTooltip title={RngRatingExplanation}>\n                                <HelpIcon fontSize='small'/>\n                            </MuiTooltip>\n                        </div>\n                    </div>\n                </Card>\n            );\n        });\n    \n        return <div style={ContainerStyle}>\n            <Typography variant=\"body1\">\n                    Your Character's Stats\n                </Typography>\n            <StatArraySelector\n                minimums={zeroStats()}\n                maximums={initStats(150)}\n                value={this.state.referenceStats}\n                onChanged={(stats) => {onReferenceStatsChanged(stats)}}\n                containerStyle={ReferenceStatContainerStyle}\n                elementStyle={ReferenceStatElementStyle}/>\n            {reportBlocks}\n        </div>;\n    }   \n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport { CharacterClass, getClassDisplayName } from \"../data/CharacterClass\";\nimport { CharacterName, getCharacterDisplayName } from \"../data/CharacterName\";\nimport { ClassChange } from \"../sim/GrowthProfile\";\nimport { DistributionsByStat, getDistributionByStatIndex } from \"../sim/GrowthResultAccumulator\";\nimport { forEachStatIndex, getCanonicalStatNameByIndex, iTOTAL } from \"../sim/StatArray\";\nimport { CharacterProfile } from \"./CharacterProfile\";\nimport { AnalysisReport } from \"./PageManager\";\n\nconst ordinalNumberCompare = (a : number, b : number) => a - b;\n\nfunction getCsvHeader() : string\n{\n    return \"ProfileIndex,Character,Class,Level,Stat,Value,Probability\";\n}\n\nfunction toCsvRow(componentIndex: number, character: CharacterName, characterClass : string, lvl: number, statName: string, bucket: number, probability: number): string\n{\n    return `${componentIndex},${getCharacterDisplayName(character)},${characterClass},${lvl.toString()},${statName},${bucket},${probability}`;\n}\n\nfunction computeClassNamesByLevel(profile : CharacterProfile) : Map<number,CharacterClass>\n{\n    const values = new Map<number, CharacterClass>();\n    let levelCounter = profile.startLevel;\n    let currentClass = profile.startClass;\n    // sort to normalize, although sorted order might be an invariant\n    let classChanges = [...profile.changes].reverse();\n\n    console.log([...classChanges]);\n    \n    while(levelCounter <= profile.endLevel)\n    {\n        // Pop off all class changes to pick the last one.\n        while (classChanges.length > 0 && levelCounter === classChanges[classChanges.length - 1].level)\n        {\n            const c = classChanges.pop();\n            currentClass = (c as ClassChange).class;\n        }\n        \n        // Set the last class for each level.\n        values.set(levelCounter, currentClass);\n\n        levelCounter++;\n    }\n\n    return values;\n}\n\nexport function exportAnalysisReportToCsv(report : AnalysisReport) : Blob\n{\n    const header = getCsvHeader();\n\n    const lines : string[] = report.components.flatMap((component, componentIndex) => {\n        const classesByLevel : Map<number,CharacterClass> = computeClassNamesByLevel(component.profile);\n\n        const levels = Array.from(component.result.keys()).sort(ordinalNumberCompare);\n        return levels.flatMap(lvl => {\n            const characterClass = getClassDisplayName(classesByLevel.get(lvl) as CharacterClass);\n            const distributions = component.result.get(lvl) as DistributionsByStat;\n\n            const rows : string[] = [];\n            // Canonical stats\n            forEachStatIndex(iStat => {\n                const statName = getCanonicalStatNameByIndex(iStat);\n                const dist = getDistributionByStatIndex(distributions, iStat);\n\n                const statBuckets = Array.from(dist.keys()).sort(ordinalNumberCompare);\n                \n                statBuckets.map(bucket => {\n                    const probability = dist.get(bucket) as number;\n                    return toCsvRow(componentIndex, component.profile.character, characterClass, lvl, statName, bucket, probability);\n                }).forEach(line => rows.push(line));\n            })\n\n            // Total\n            const totalLevelupDistribution = getDistributionByStatIndex(distributions, iTOTAL);\n            const totalLevelupBuckets = Array.from(totalLevelupDistribution.keys()).sort(ordinalNumberCompare);\n            const totalLevelupStatName = \"levelup-total\";\n            totalLevelupBuckets.map(bucket => {\n                const probability = totalLevelupDistribution.get(bucket) as number;\n                return toCsvRow(componentIndex, component.profile.character, characterClass, lvl, totalLevelupStatName, bucket, probability);\n            }).forEach(line => rows.push(line));\n\n            return rows;\n        });\n    });\n\n    const allData = [header, ...lines].join(\"\\n\");\n    return new Blob([allData], {type: 'text/csv;charset=utf-8'});\n}\n\n","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { getClassDisplayName } from \"../data/CharacterClass\";\nimport { getCharacterDisplayName } from \"../data/CharacterName\";\nimport { AnalysisReport } from \"../model/PageManager\";\nimport { exportAnalysisReportToCsv } from \"../model/AnalysisReportExport\";\n\nexport interface ExportDataDialogProps\n{\n    open : boolean;\n    report : AnalysisReport;\n    onClose : () => void;\n}\n\ninterface ExportDataDialogState\n{\n}\n\nexport class ExportDataDialog extends React.Component<ExportDataDialogProps, ExportDataDialogState>\n{\n    private dataBlobUrl : string | null;\n    \n    constructor(props : ExportDataDialogProps)\n    {\n        super(props);\n        \n        this.state = {};\n\n        this.dataBlobUrl = null;\n    }\n\n    private async downloadDataBlob()\n    {\n        if (this.dataBlobUrl !== null)\n        {\n            this.clearDataBlob();\n        }\n\n        this.dataBlobUrl = URL.createObjectURL(exportAnalysisReportToCsv(this.props.report));\n\n        const aElem = document.createElement('a');\n        aElem.href = (this.dataBlobUrl as string);\n        aElem.target = \"_blank\";\n        aElem.download = \"analysis-report.csv\";\n        aElem.click();\n    }\n\n    private async clearDataBlob()\n    {\n        if (this.dataBlobUrl !== null)\n        {\n            URL.revokeObjectURL(this.dataBlobUrl);\n            this.dataBlobUrl = null;\n        }\n    }\n\n    public render() : JSX.Element\n    {\n        const closeHandler = async () => {\n            await this.clearDataBlob();\n            this.props.onClose();\n        };\n    \n        const profileStrings = this.props.report.components.map(c => c.profile).map((p, index) => {\n            const endClass = p.changes.length > 0 ? p.changes[p.changes.length - 1].class : undefined;\n    \n            return <Typography variant=\"body2\" key={`export-label-${index}`}>\n                {(index + 1).toString()}. {getCharacterDisplayName(p.character)} lvl. {p.startLevel.toString()} {getClassDisplayName(p.startClass)}\n                &nbsp;&#x2192;&nbsp;\n                lvl. {p.endLevel.toString()} {endClass !== undefined ? getClassDisplayName(endClass) : \"\"}\n            </Typography>;\n        });\n    \n        return (\n                <Dialog open={this.props.open} onClose={closeHandler}>\n                    <DialogTitle>\n                        Export Analysis Report\n                    </DialogTitle>\n                    <DialogContent style={{minWidth: 400, minHeight: 100}}>\n                        <Typography variant=\"subtitle1\">Exporting probability distributions for:</Typography>\n                        {profileStrings}\n                        <br style={{height: 16}}/>\n                        <Button variant=\"contained\" color=\"primary\" onClick={() => this.downloadDataBlob()}>Download</Button>\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={closeHandler} color=\"default\">Close</Button>\n                    </DialogActions>\n                </Dialog>\n        );\n    }\n}","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport * as React from \"react\";\nimport { getAppContext, IAppContextValue } from \"../model/AppContext\";\nimport { CharacterProfile, getCharacterProfileHash } from \"../model/CharacterProfile\";\nimport { AnalysisComponent, AnalysisReport, INVALID_PAGE_LISTENER_HANDLE, IPageManager, PageData } from \"../model/PageManager\";\nimport { GrowthResultAccumulator, StatDistributionsByLevel } from \"../sim/GrowthResultAccumulator\";\nimport { CharacterProfileBuilder, getGrowthProfileFromCharacterProfile } from \"./CharacterProfileBuilder\";\nimport { SERIES_COLOR_SCHEMES } from \"./ChartColorScheme\";\nimport { AnalysisReportDisplay, getReportMaxLevel, getReportMinLevel } from \"./AnalysisReportDisplay\";\nimport { LuckAnalysisReport } from \"./LuckAnalysisReport\";\nimport { LevelSelector } from \"./LevelSelector\";\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Button from \"@material-ui/core/Button\";\nimport Card from \"@material-ui/core/Card\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Accordion from \"@material-ui/core/Accordion\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport Container from \"@material-ui/core/Container\";\nimport { ExportDataDialog } from \"./ExportDataDialog\";\n\nexport interface AnalysisPageProps\n{\n    pageId : number;\n}\n\nexport interface AnalysisPageState\n{\n    resultsComputed : boolean;\n    results : StatDistributionsByLevel[] | null;\n    profileBlockExpansion : boolean[];\n    selectedReportLevel : number;\n    exportDataDialogOpen : boolean;\n}\n\nfunction getDefaultAnalysisPageState() : AnalysisPageState\n{\n    return {\n        resultsComputed : false,\n        results : null,\n        profileBlockExpansion : [],\n        selectedReportLevel : 1000,\n        exportDataDialogOpen : false,\n    }\n}\n\nfunction getMaxProfileCount() : number\n{\n    // However many colors we can show is how many profiles you can pack into the charts\n    return SERIES_COLOR_SCHEMES.length;\n}\n\n// TODO : Find more elegant way to do this.\nlet reportGenerationCounter : number = 0;\n\nfunction generateAnalysisReport(profiles: CharacterProfile[]) : AnalysisReport\n{\n    const accumulators = profiles.map(p => {\n        const growthProfile = getGrowthProfileFromCharacterProfile(p);\n        const mods = p.maxStatMods;\n        return new GrowthResultAccumulator(p.character, growthProfile, mods);\n    });\n\n    const distributions = accumulators.map(accum => {\n        accum.compute();\n        return accum.getDistributions();\n    });\n\n    const components : AnalysisComponent[] = distributions.map((distribution, index) => ({\n        profile : profiles[index],\n        result : distribution\n    }));\n\n    reportGenerationCounter++;\n\n    return {\n        components : components,\n        cacheToken : reportGenerationCounter\n    };\n}\n\nconst AddProfileButtonContainerStyle : React.CSSProperties = {\n    padding: 8,\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n};\n\nconst AddProfileButtonStyle : React.CSSProperties = {\n    display: 'block',\n    flexBasis: 'auto',\n    flexGrow: 0,\n    flexShrink: 0\n}\n\n// A page contains multiple profiles and possibly the analyses for the outcomes.\n\nexport class AnalysisPage extends React.Component<AnalysisPageProps, AnalysisPageState>\n{\n    private listenerHandle : number;\n    private reportIterationCounter : number;\n\n    constructor(props : AnalysisPageProps)\n    {\n        super(props);\n        this.state = getDefaultAnalysisPageState();\n\n        this.listenerHandle = INVALID_PAGE_LISTENER_HANDLE;\n        this.reportIterationCounter = 0;\n    }\n\n    componentDidMount() : void\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        this.attachListener(pageManager, this.props.pageId);\n    }\n\n    componentDidUpdate(prevProps : AnalysisPageProps, prevState : AnalysisPageState, snapshot : any) : void\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        if (this.props.pageId !== prevProps.pageId)\n        {\n            this.detachListener(pageManager, prevProps.pageId);\n            this.attachListener(pageManager, this.props.pageId);\n\n            this.reconcilePageState(pageManager);\n        }\n    }\n\n    componentWillUnmount() : void\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        this.detachListener(pageManager, this.props.pageId);\n    }\n\n    render() : JSX.Element\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        const pageDataRef = pageManager.getPageData(this.props.pageId);\n\n        const onSelectedLevelChanged = (newSelectedLevel : number) => {\n            this.setState({selectedReportLevel: newSelectedLevel})\n        };\n\n        const exportDataButtonClicked = () => {\n            this.setState({exportDataDialogOpen : true});\n        };\n\n        const onExportDataDialogClosed = () => {\n            this.setState({exportDataDialogOpen : false});\n        };\n\n        let maybeAddProfileButton : JSX.Element | null = null;\n        if (pageDataRef.profiles.length < getMaxProfileCount())\n        {\n            maybeAddProfileButton = <Button \n                                    variant=\"contained\" \n                                    disableElevation \n                                    onClick={() => this.onAddProfileClicked()} \n                                    color=\"primary\" \n                                    style={AddProfileButtonStyle}>\n                                        Add Profile\n                                    </Button>;\n        }\n        else\n        {\n            maybeAddProfileButton = <Button \n                                    variant=\"contained\" \n                                    disableElevation\n                                    disabled\n                                    style={AddProfileButtonStyle}>\n                                        Max Profiles Added\n                                    </Button>;\n        }\n\n        const computeReportButtonColor = this.state.resultsComputed ? \"default\" : \"primary\";\n        const computeReportButton = <Button \n                                    variant=\"contained\" \n                                    disableElevation \n                                    color={computeReportButtonColor}\n                                    onClick={() => this.onGenerateReportClicked()}>\n                                        Generate Report\n                                    </Button>;\n\n        const profileBlock = <div>\n            {pageDataRef.profiles.map((characterProfile, index) => this.renderProfile(pageDataRef, characterProfile, index))}\n            <div style={AddProfileButtonContainerStyle}>{maybeAddProfileButton}</div>\n        </div>;\n\n        const rnjesusDisplay = (pageDataRef.report === null)\n            ? null\n            : <Accordion>\n                <AccordionSummary expandIcon={<ExpandMoreIcon />} id=\"rejesus_display\">\n                    <Typography variant=\"h6\" style={{flexBasis: \"33%\", flexShrink: 0, textAlign: \"start\"}}>\n                        RNGesus Luck Analysis\n                    </Typography>\n                    <Typography variant=\"h6\" style={{opacity: 0.5}}>click to open</Typography>\n                </AccordionSummary>\n                <AccordionDetails>\n                    <Container>\n                        <LuckAnalysisReport \n                            report={pageDataRef.report}\n                            reportIterationCounter={this.reportIterationCounter}\n                            selectedLevel={this.state.selectedReportLevel}/>\n                    </Container>\n                </AccordionDetails>\n            </Accordion>;\n\n        const reportBlock = pageDataRef.report === null\n            ? null\n            : <Card style={{padding: 16, marginTop: 16}}>\n                <Button style={{float: 'right'}} variant=\"contained\" color=\"default\" onClick={exportDataButtonClicked}>Export Data</Button>\n                <Typography variant=\"h6\" style={{textAlign: \"start\"}}>\n                    Individual Stat Breakdown\n                </Typography>\n                <ExportDataDialog open={this.state.exportDataDialogOpen} onClose={onExportDataDialogClosed} report={pageDataRef.report as AnalysisReport}/>\n                <AnalysisReportDisplay \n                    report={pageDataRef.report as AnalysisReport}\n                    selectedLevel={this.state.selectedReportLevel}/>\n            </Card>;\n\n        const levelSelector = pageDataRef.report === null\n            ? null\n            : <div style={{margin: 16}}>\n                <LevelSelector\n                    minLevel={getReportMinLevel(pageDataRef.report)}\n                    maxLevel={getReportMaxLevel(pageDataRef.report)}\n                    value={this.state.selectedReportLevel}\n                    customText=\"View results for level:\"\n                    labelStyle=\"inline\"\n                    onSelected={onSelectedLevelChanged}/>\n            </div>;\n\n        return <div style={{maxWidth: 1000}}>\n            {profileBlock}\n            <Card variant=\"outlined\" style={{margin: 8}}>\n                <CardContent style={{textAlign: \"start\"}}>\n                    <div style={{display: 'flex', flexDirection: 'row'}}>\n                        <div style={{flexBasis: 'auto', flexShrink: 0, flexGrow: 0}}>\n                            <Typography variant=\"h5\" style={{textAlign: \"start\"}}>\n                                Analysis\n                            </Typography>\n                        </div>\n                        <div style={{flexBasis: 'auto', flexShrink: 0, flexGrow: 1, marginLeft: 24}}>\n                            {computeReportButton}\n                        </div>\n                    </div>\n                    {levelSelector}\n                    {rnjesusDisplay}\n                    {reportBlock}\n                </CardContent>\n            </Card>\n        </div>;\n    }\n\n    private onGenerateReportClicked() : void\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        const pageDataRef = pageManager.getPageData(this.props.pageId);\n        const report = generateAnalysisReport(pageDataRef.profiles);\n        this.reportIterationCounter++;\n        \n        pageManager.updateAnalysis(this.props.pageId, report);\n\n        this.setState({\n            resultsComputed: true,\n            selectedReportLevel: getReportMaxLevel(report)\n        });\n    }\n\n    private onAddProfileClicked() : void\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        pageManager.newProfile(this.props.pageId);\n        this.setState({resultsComputed: false});\n    }\n\n    private onRemoveProfileClicked(index : number)\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        pageManager.deleteProfile(this.props.pageId, index);\n        this.setState({resultsComputed: false});\n    }\n\n    private profileChanged(newProfile : CharacterProfile, index : number)\n    {\n        const pageManager = (this.context as IAppContextValue).pageManager;\n        pageManager.updateProfile(this.props.pageId, index, newProfile);\n        this.setState({resultsComputed: false});\n    }\n\n    private renderProfile(pageDataRef : PageData, characterProfile : CharacterProfile, index : number)\n    {\n        // If last profile, do not allow delete, only edit.\n        const showDeleteButton = pageDataRef.profiles.length > 1;\n\n        return <CharacterProfileBuilder \n            key={index}\n            profile={characterProfile}\n            showDeleteButton={showDeleteButton}\n            onProfileChange={(newProfile) => this.profileChanged(newProfile, index)}\n            onDeleteClicked={() => this.onRemoveProfileClicked(index)} />;\n    }\n\n    private attachListener(pageManager : IPageManager, page : number) : void\n    {\n        this.listenerHandle = pageManager.addPageListener(page, (pageNumber, pageData) => {this.onPageUpdated(pageNumber, pageData)});\n    }\n\n    private detachListener(pageManager : IPageManager, page : number) : void\n    {\n        pageManager.removePageListener(page, this.listenerHandle);\n        this.listenerHandle = INVALID_PAGE_LISTENER_HANDLE;\n    }\n\n    private onPageUpdated(page : number, pageData : PageData) : void\n    {\n        this.forceUpdate();\n    }\n\n    private reconcilePageState(pageManager : IPageManager) : void\n    {\n        const pageData = pageManager.getPageData(this.props.pageId);\n\n        let newBlockExpansion = Array.from(this.state.profileBlockExpansion);\n        if (pageData.profiles.length > this.state.profileBlockExpansion.length)\n        {\n            const tailLength = pageData.profiles.length - this.state.profileBlockExpansion.length;\n            newBlockExpansion = newBlockExpansion.concat(Array<boolean>(tailLength).fill(false))\n        }\n        else if (pageData.profiles.length < this.state.profileBlockExpansion.length)\n        {\n            newBlockExpansion = newBlockExpansion.slice(0, pageData.profiles.length);\n        }\n\n        if (pageData.report !== null)\n        {\n            const profilesMatched : boolean = \n                pageData.profiles.length === pageData.report.components.length\n                && pageData.report.components\n                    .map(c => c.profile)\n                    .every((oldProfile, index) => {\n                        const newProfile = pageData.profiles[index];\n                        const hashNew = getCharacterProfileHash(newProfile.character, getGrowthProfileFromCharacterProfile(newProfile), newProfile.maxStatMods);\n                        const hashOld = getCharacterProfileHash(oldProfile.character, getGrowthProfileFromCharacterProfile(oldProfile), oldProfile.maxStatMods);\n                        return hashNew === hashOld;\n                    });\n\n            this.setState({\n                resultsComputed : profilesMatched,\n                results : pageData.report.components.map(component => component.result),\n                profileBlockExpansion : newBlockExpansion\n            });\n        }\n        else\n        {\n            this.setState({\n                resultsComputed : false,\n                results : null,\n                profileBlockExpansion : newBlockExpansion\n            });\n        }\n    }\n}\nAnalysisPage.contextType = getAppContext().Context;\n","export default __webpack_public_path__ + \"static/media/about.46910db6.md\";","export default __webpack_public_path__ + \"static/media/docs.58ed06f9.md\";","export default __webpack_public_path__ + \"static/media/faq.ea806496.md\";","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport Card from \"@material-ui/core/Card\";\nimport Link from \"@material-ui/core/Link\";\nimport Typography from \"@material-ui/core/Typography\";\n\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\nimport MenuBookIcon from '@material-ui/icons/MenuBook';\nimport InfoIcon from '@material-ui/icons/Info';\n\nimport GithubIcon from \"../images/GitHub-Mark-32px.png\";\n\nimport AboutDocsAssetUrl from './docs/about.md';\nimport DocumentationAssetUrl from './docs/docs.md';\nimport FaqAssetUrl from './docs/faq.md';\n\nconst AboutDocsUrlSuffix = \"docs/about.md\";\nconst DocumentationUrlSuffix = \"docs/docs.md\";\nconst FaqUrlSuffix = \"docs/faq.md\"\n\nexport interface FaqEntryProps\n{\n    index : number;\n    question : string | JSX.Element;\n    answer : string | JSX.Element;\n}\n\nexport interface HeaderAndDocumentationProps\n{\n\n}\n\nconst LinksTrayStyle : React.CSSProperties = {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: 16\n};\n\nconst MenuIconStyle : React.CSSProperties = {\n    display: \"inline\",\n    marginBottom: -5,\n    marginLeft: 16,\n    paddingRight: 2\n};\n\nconst GithubPagesRegex = /(\\w+).github.io/i;\n\nexport function HeaderAndDocumentation(props : HeaderAndDocumentationProps) : JSX.Element\n{\n    const hostname = window.location.hostname;\n    const segmentsMatch = hostname.match(GithubPagesRegex);\n\n    let urlPrefix : string | undefined = undefined;\n    let repoUrl = \"#\";\n    if (segmentsMatch !== null)\n    {\n        const gitUser = segmentsMatch[1];\n        urlPrefix = `https://github.com/${gitUser}/fe3hanalyzer/blob/main/`;\n        repoUrl = `https://github.com/${gitUser}/fe3hanalyzer`;\n    }\n\n    const FaqUrl = urlPrefix === undefined ? FaqAssetUrl : urlPrefix + FaqUrlSuffix;\n    const DocumentationUrl = urlPrefix === undefined ? DocumentationAssetUrl : urlPrefix + DocumentationUrlSuffix;\n    const AboutDocsUrl = urlPrefix === undefined ? AboutDocsAssetUrl : urlPrefix + AboutDocsUrlSuffix;\n\n    return <div style={{display: 'flex', width: 1000, flexDirection: 'row'}}>\n        <Card style={{margin: 8, padding: 16, flexBasis: 'auto', flexGrow: 1, flexShrink: 1}}>\n            <Typography variant=\"h3\">\n                FE:3H Character Analyzer\n            </Typography>\n            <a href={repoUrl} style={{display: 'block', float: 'right', marginTop: 18}} target=\"_blank\" rel=\"noreferrer\">\n                <img src={GithubIcon} alt=\"Link to GitHub repository\" style={{height: 16, width: 16}}/>\n            </a>\n            <div style={LinksTrayStyle}>\n                <Link href={FaqUrl} underline=\"always\" target=\"_blank\" rel=\"noreferrer\"><HelpOutlineIcon fontSize=\"small\" style={{...MenuIconStyle, marginLeft: 0}}/>FAQ</Link>\n                <Link href={DocumentationUrl} underline=\"always\" target=\"_blank\" rel=\"noreferrer\"><MenuBookIcon fontSize=\"small\" style={MenuIconStyle}/>Documentation</Link>\n                <Link href={AboutDocsUrl} underline=\"always\" target=\"_blank\" rel=\"noreferrer\"><InfoIcon fontSize=\"small\" style={MenuIconStyle}/>About</Link>\n            </div>\n        </Card>\n    </div>;\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==\"","/*\nCopyright 2021 knsley\n(https://github.com/knsley)\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nimport React from 'react';\nimport './App.css';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport { CharacterName } from './data/CharacterName';\nimport { getDefaultStatModSetting, loadCharacterData } from './data/CharacterData';\nimport { getAppContext } from './model/AppContext';\nimport { CharacterProfile } from './model/CharacterProfile';\nimport { AnalysisPage } from './ui/AnalysisPage';\nimport { HeaderAndDocumentation } from './ui/HeaderAndDocumentation';\nimport { CharacterClass } from './data/CharacterClass';\nimport { loadClassData } from './data/ClassData';\n\ninterface AppProps\n{\n\n}\n\ninterface AppState\n{\n  profile : CharacterProfile;\n  loaded : boolean;\n}\n\nfunction getInitialProfile() : CharacterProfile\n{\n  return {\n    character : (0 as CharacterName),\n    maxStatMods : getDefaultStatModSetting(),\n    startLevel : 1,\n    startClass : CharacterClass.Commoner,\n    startStats : [0,0,0,0,0,0,0,0,0],\n    changes : [],\n    endLevel : 99,\n  }\n}\n\nclass App extends React.Component<AppProps, AppState> {\n\n  constructor(props : AppProps)\n  {\n    super(props);\n    this.state = {profile: getInitialProfile(), loaded : false};\n  }\n\n  componentDidMount() {\n    loadCharacterData().then(() => {\n      loadClassData().then(() => {\n        const appContext = getAppContext();\n        // test page #, more generally would expect to create a single page if no page, or load from store.\n        if (!appContext.currentValue.pageManager.hasPage(0))\n        {\n          appContext.currentValue.pageManager.createNewPage(0);\n        }\n\n        this.setState({loaded: true});\n      });\n    });\n  }\n\n  render()\n  {\n    const theme = createMuiTheme({\n      typography: {\n      },\n    });\n\n    if (this.state.loaded)\n    {\n      const AppContextObject = getAppContext();\n      const AppContext = AppContextObject.Context;\n\n      return (\n        <AppContext.Provider value={AppContextObject.currentValue}>\n          <ThemeProvider theme={theme}>\n            <div className=\"App\">\n              <HeaderAndDocumentation />\n              <AnalysisPage pageId={0}/>\n            </div>\n          </ThemeProvider>\n        </AppContext.Provider>\n      );\n    }\n    else\n    {\n      return <div>Loading...</div>;\n    }\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals(console.log);\n"],"sourceRoot":""}